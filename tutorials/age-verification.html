<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Age Verification Tutorial - par Noir</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" type="image/png" href="../branding/Par-Noir-Icon-White.png">
</head>
<body>
    <!-- Background -->
    <div class="background"></div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="../branding/Par-Noir-Logo-White.png" alt="Par Noir" class="nav-logo">
            </div>
            <div class="nav-menu">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="../developer-portal.html" class="nav-link">Developer Portal</a>
                <a href="#overview" class="nav-link active">Tutorial</a>
                <a href="https://github.com/identity-protocol" target="_blank" class="nav-link">GitHub</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-badge">Tutorial</div>
                <h1 class="hero-title">
                    Age Verification with <span class="hero-highlight">Zero-Knowledge Proofs</span>
                </h1>
                <p class="hero-subtitle">
                    Learn how to implement privacy-preserving age verification in your e-commerce application 
                    without storing or exposing user birth dates.
                </p>
                <div class="hero-actions">
                    <a href="#overview" class="btn btn-primary btn-large">
                        <span>Start Tutorial</span>
                        <svg class="btn-icon" viewBox="0 0 24 24">
                            <path d="M5 12h14m-7-7l7 7-7 7"/>
                        </svg>
                    </a>
                    <a href="https://github.com/identity-protocol/examples/tree/main/age-verification" target="_blank" class="btn btn-secondary">View Code</a>
                </div>
            </div>
            <div class="hero-visual">
                <div class="tutorial-preview">
                    <div class="tutorial-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <p>15-minute tutorial</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Overview -->
    <section id="overview" class="narrative-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Overview</h2>
                <p class="section-subtitle">What you'll build and learn in this tutorial.</p>
            </div>
            <div class="tutorial-content">
                <h3>What You'll Build</h3>
                <p>
                    In this tutorial, you'll create an e-commerce application that can verify a user's age 
                    for alcohol purchases without ever seeing or storing their actual birth date. The user 
                    proves they are over 21 using zero-knowledge proofs, and your application can verify 
                    this claim without any personal data exposure.
                </p>

                <h3>Key Concepts</h3>
                <ul class="tutorial-list">
                    <li><strong>Zero-Knowledge Proofs:</strong> Prove facts without revealing underlying data</li>
                    <li><strong>Age Verification:</strong> Verify minimum age without storing birth dates</li>
                    <li><strong>Privacy by Design:</strong> Build applications that respect user privacy</li>
                    <li><strong>Regulatory Compliance:</strong> Meet legal requirements without data collection</li>
                </ul>

                <h3>Prerequisites</h3>
                <ul class="tutorial-list">
                    <li>Basic knowledge of JavaScript/TypeScript</li>
                    <li>Node.js installed on your machine</li>
                    <li>Understanding of web development concepts</li>
                </ul>

                <div class="tutorial-info">
                    <div class="info-item">
                        <strong>Duration:</strong> 15 minutes
                    </div>
                    <div class="info-item">
                        <strong>Difficulty:</strong> Intermediate
                    </div>
                    <div class="info-item">
                        <strong>Code:</strong> <a href="https://github.com/identity-protocol/examples/tree/main/age-verification" target="_blank">View on GitHub</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Step 1: Setup -->
    <section id="setup" class="narrative-section solution-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Step 1: Project Setup</h2>
                <p class="section-subtitle">Initialize your project and install dependencies.</p>
            </div>
            <div class="tutorial-content">
                <h3>Create a New Project</h3>
                <div class="code-example">
                    <pre><code>mkdir age-verification-demo
cd age-verification-demo
npm init -y</code></pre>
                </div>

                <h3>Install Dependencies</h3>
                <div class="code-example">
                    <pre><code>npm install @identity-protocol/identity-sdk
npm install express cors dotenv
npm install --save-dev typescript @types/node @types/express</code></pre>
                </div>

                <h3>Create TypeScript Configuration</h3>
                <div class="code-example">
                    <pre><code>// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules"]
}</code></pre>
                </div>

                <h3>Project Structure</h3>
                <div class="code-example">
                    <pre><code>age-verification-demo/
├── src/
│   ├── server.ts
│   ├── client.ts
│   └── types.ts
├── public/
│   └── index.html
├── package.json
└── tsconfig.json</code></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Step 2: Identity Setup -->
    <section id="identity" class="narrative-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Step 2: Identity Setup</h2>
                <p class="section-subtitle">Configure the par Noir SDK and create user identities.</p>
            </div>
            <div class="tutorial-content">
                <h3>Initialize the SDK</h3>
                <div class="code-example">
                    <pre><code>// src/client.ts
import { createIdentitySDK } from '@identity-protocol/identity-sdk';

const sdk = createIdentitySDK({
  identityProvider: {
    name: 'Age Verification Demo',
    type: 'oauth2',
    config: {
      clientId: process.env.CLIENT_ID || 'demo-client',
      redirectUri: 'http://localhost:3000/callback'
    }
  },
  storage: 'localStorage',
  debug: true
});

export { sdk };</code></pre>
                </div>

                <h3>Create User Identity</h3>
                <div class="code-example">
                    <pre><code>// src/types.ts
export interface User {
  id: string;
  name: string;
  email: string;
  birthDate: string; // Only stored locally, never sent to server
  age: number;
}

export interface AgeVerificationRequest {
  userId: string;
  minimumAge: number;
}

export interface AgeVerificationResponse {
  verified: boolean;
  proof: string;
}</code></pre>
                </div>

                <h3>Identity Creation Function</h3>
                <div class="code-example">
                    <pre><code>// src/client.ts
export async function createUserIdentity(userData: {
  name: string;
  email: string;
  birthDate: string;
}): Promise<User> {
  // Create the identity
  const identity = await sdk.createIdentity({
    name: userData.name,
    email: userData.email
  });

  // Calculate age from birth date
  const birthDate = new Date(userData.birthDate);
  const today = new Date();
  const age = today.getFullYear() - birthDate.getFullYear();
  const monthDiff = today.getMonth() - birthDate.getMonth();
  
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
    age--;
  }

  // Store user data locally (never sent to server)
  const user: User = {
    id: identity.id,
    name: userData.name,
    email: userData.email,
    birthDate: userData.birthDate,
    age: age
  };

  // Store in localStorage (in production, use more secure storage)
  localStorage.setItem('user', JSON.stringify(user));
  
  return user;
}</code></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Step 3: Age Verification -->
    <section id="verification" class="narrative-section solution-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Step 3: Age Verification Implementation</h2>
                <p class="section-subtitle">Implement zero-knowledge age verification.</p>
            </div>
            <div class="tutorial-content">
                <h3>Generate Age Proof</h3>
                <div class="code-example">
                    <pre><code>// src/client.ts
export async function generateAgeProof(minimumAge: number): Promise<string> {
  const userData = localStorage.getItem('user');
  if (!userData) {
    throw new Error('User not found. Please create an identity first.');
  }

  const user: User = JSON.parse(userData);
  
  if (user.age < minimumAge) {
    throw new Error(`User is ${user.age} years old, but minimum age is ${minimumAge}`);
  }

  // Generate zero-knowledge proof
  const proof = await sdk.generateProof({
    statement: `age >= ${minimumAge}`,
    attributes: {
      age: user.age
    },
    reveal: false // Don't reveal the actual age
  });

  return proof;
}</code></pre>
                </div>

                <h3>Verify Age Proof (Server Side)</h3>
                <div class="code-example">
                    <pre><code>// src/server.ts
import express from 'express';
import cors from 'cors';
import { createIdentitySDK } from '@identity-protocol/identity-sdk';

const app = express();
app.use(cors());
app.use(express.json());

const sdk = createIdentitySDK({
  identityProvider: {
    name: 'Age Verification Server',
    type: 'oauth2',
    config: {
      clientId: process.env.SERVER_CLIENT_ID || 'server-client',
      redirectUri: 'http://localhost:3001/callback'
    }
  }
});

app.post('/verify-age', async (req, res) => {
  try {
    const { proof, minimumAge } = req.body;

    // Verify the zero-knowledge proof
    const isValid = await sdk.verifyProof({
      proof: proof,
      statement: `age >= ${minimumAge}`,
      publicKey: req.body.userId // User's public key
    });

    if (isValid) {
      res.json({
        verified: true,
        message: `User is verified to be at least ${minimumAge} years old`
      });
    } else {
      res.status(400).json({
        verified: false,
        message: 'Age verification failed'
      });
    }
  } catch (error) {
    res.status(500).json({
      verified: false,
      message: 'Verification error',
      error: error.message
    });
  }
});

app.listen(3001, () => {
  console.log('Age verification server running on port 3001');
});</code></pre>
                </div>

                <h3>Client-Side Verification Request</h3>
                <div class="code-example">
                    <pre><code>// src/client.ts
export async function verifyAge(minimumAge: number): Promise<boolean> {
  try {
    // Generate the proof
    const proof = await generateAgeProof(minimumAge);
    
    // Get user data
    const userData = localStorage.getItem('user');
    const user: User = JSON.parse(userData);

    // Send proof to server for verification
    const response = await fetch('http://localhost:3001/verify-age', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        proof: proof,
        minimumAge: minimumAge,
        userId: user.id
      })
    });

    const result = await response.json();
    return result.verified;
  } catch (error) {
    console.error('Age verification failed:', error);
    return false;
  }
}</code></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Step 4: Frontend Integration -->
    <section id="frontend" class="narrative-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Step 4: Frontend Integration</h2>
                <p class="section-subtitle">Create a user interface for age verification.</p>
            </div>
            <div class="tutorial-content">
                <h3>HTML Interface</h3>
                <div class="code-example">
                    <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Age Verification Demo&lt;/title&gt;
    &lt;style&gt;
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, button { padding: 10px; width: 100%; }
        .success { color: green; }
        .error { color: red; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Age Verification Demo&lt;/h1&gt;
    
    &lt;div id="identity-form"&gt;
        &lt;h2&gt;Create Your Identity&lt;/h2&gt;
        &lt;div class="form-group"&gt;
            &lt;label for="name"&gt;Name:&lt;/label&gt;
            &lt;input type="text" id="name" required&gt;
        &lt;/div&gt;
        &lt;div class="form-group"&gt;
            &lt;label for="email"&gt;Email:&lt;/label&gt;
            &lt;input type="email" id="email" required&gt;
        &lt;/div&gt;
        &lt;div class="form-group"&gt;
            &lt;label for="birthDate"&gt;Birth Date:&lt;/label&gt;
            &lt;input type="date" id="birthDate" required&gt;
        &lt;/div&gt;
        &lt;button onclick="createIdentity()"&gt;Create Identity&lt;/button&gt;
    &lt;/div&gt;

    &lt;div id="verification-form" style="display: none;"&gt;
        &lt;h2&gt;Age Verification&lt;/h2&gt;
        &lt;p&gt;Prove you're old enough to purchase alcohol (21+) without revealing your age.&lt;/p&gt;
        &lt;button onclick="verifyAge(21)"&gt;Verify I'm 21 or Older&lt;/button&gt;
        &lt;div id="result"&gt;&lt;/div&gt;
    &lt;/div&gt;

    &lt;script src="client.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                </div>

                <h3>JavaScript Integration</h3>
                <div class="code-example">
                    <pre><code>// public/client.js
async function createIdentity() {
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const birthDate = document.getElementById('birthDate').value;

  if (!name || !email || !birthDate) {
    alert('Please fill in all fields');
    return;
  }

  try {
    const user = await createUserIdentity({ name, email, birthDate });
    document.getElementById('identity-form').style.display = 'none';
    document.getElementById('verification-form').style.display = 'block';
    console.log('Identity created:', user);
  } catch (error) {
    alert('Error creating identity: ' + error.message);
  }
}

async function verifyAge(minimumAge) {
  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = 'Verifying...';

  try {
    const verified = await verifyAge(minimumAge);
    
    if (verified) {
      resultDiv.innerHTML = '&lt;div class="success"&gt;✓ Age verification successful! You can purchase alcohol.&lt;/div&gt;';
    } else {
      resultDiv.innerHTML = '&lt;div class="error"&gt;✗ Age verification failed. You must be 21 or older.&lt;/div&gt;';
    }
  } catch (error) {
    resultDiv.innerHTML = '&lt;div class="error"&gt;Error: ' + error.message + '&lt;/div&gt;';
  }
}</code></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Step 5: Testing -->
    <section id="testing" class="narrative-section solution-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Step 5: Testing Your Implementation</h2>
                <p class="section-subtitle">Test the age verification system.</p>
            </div>
            <div class="tutorial-content">
                <h3>Start the Server</h3>
                <div class="code-example">
                    <pre><code># Compile TypeScript
npx tsc

# Start the server
node dist/server.js</code></pre>
                </div>

                <h3>Test Scenarios</h3>
                <ul class="tutorial-list">
                    <li><strong>Valid Age:</strong> Create identity with birth date making user 25+ years old</li>
                    <li><strong>Invalid Age:</strong> Create identity with birth date making user under 21</li>
                    <li><strong>Edge Case:</strong> Test with exactly 21 years old</li>
                </ul>

                <h3>Expected Results</h3>
                <ul class="tutorial-list">
                    <li><strong>25+ years old:</strong> Verification should succeed</li>
                    <li><strong>Under 21:</strong> Verification should fail with clear error</li>
                    <li><strong>Exactly 21:</strong> Verification should succeed</li>
                </ul>

                <h3>Privacy Verification</h3>
                <p>
                    To verify that no personal data is being transmitted:
                </p>
                <ul class="tutorial-list">
                    <li>Check browser network tab - no birth date should be sent</li>
                    <li>Check server logs - only proof data should be received</li>
                    <li>Verify that the server cannot determine the user's actual age</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Next Steps -->
    <section id="next-steps" class="narrative-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Next Steps</h2>
                <p class="section-subtitle">Extend your implementation with advanced features.</p>
            </div>
            <div class="tutorial-content">
                <h3>Advanced Features</h3>
                <ul class="tutorial-list">
                    <li><strong>Multiple Age Thresholds:</strong> Support different age requirements (18+, 21+, 25+)</li>
                    <li><strong>Credential Storage:</strong> Store verified credentials for future use</li>
                    <li><strong>Revocation:</strong> Implement credential revocation mechanisms</li>
                    <li><strong>Audit Logging:</strong> Add compliance-friendly audit trails</li>
                </ul>

                <h3>Production Considerations</h3>
                <ul class="tutorial-list">
                    <li><strong>Secure Storage:</strong> Use hardware security modules for key storage</li>
                    <li><strong>Rate Limiting:</strong> Implement proof generation rate limits</li>
                    <li><strong>Error Handling:</strong> Add comprehensive error handling and logging</li>
                    <li><strong>Compliance:</strong> Ensure GDPR and other privacy regulation compliance</li>
                </ul>

                <h3>Related Tutorials</h3>
                <div class="tutorial-links">
                    <a href="social-auth.html" class="btn btn-primary">Social Media Authentication</a>
                    <a href="mobile-integration.html" class="btn btn-secondary">Mobile App Integration</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <img src="../branding/Par-Noir-Logo-White.png" alt="Par Noir" class="footer-logo">
                    <p>Building the future of digital identity.</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>Tutorials</h4>
                        <a href="#overview">Overview</a>
                        <a href="#setup">Setup</a>
                        <a href="#verification">Verification</a>
                    </div>
                    <div class="footer-column">
                        <h4>Resources</h4>
                        <a href="../index.html">Home</a>
                        <a href="../developer-portal.html">Developer Portal</a>
                        <a href="../whitepaper.html">White Paper</a>
                    </div>
                    <div class="footer-column">
                        <h4>Community</h4>
                        <a href="https://discord.gg/parnoir">Discord</a>
                        <a href="https://twitter.com/parnoir">Twitter</a>
                        <a href="https://github.com/identity-protocol">GitHub</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Par Noir. Continuing the legacy of freedom since 1776.</p>
            </div>
        </div>
    </footer>

    <script src="../script.js"></script>
    <script>
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
