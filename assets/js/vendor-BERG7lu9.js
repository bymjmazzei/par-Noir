var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__knownSymbol=(e,r)=>(r=Symbol[e])?r:Symbol.for("Symbol."+e),__typeError=e=>{throw TypeError(e)},__pow=Math.pow,__defNormalProp=(e,r,t)=>r in e?__defProp(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,__spreadValues=(e,r)=>{for(var t in r||(r={}))__hasOwnProp.call(r,t)&&__defNormalProp(e,t,r[t]);if(__getOwnPropSymbols)for(var t of __getOwnPropSymbols(r))__propIsEnum.call(r,t)&&__defNormalProp(e,t,r[t]);return e},__spreadProps=(e,r)=>__defProps(e,__getOwnPropDescs(r)),__objRest=(e,r)=>{var t={};for(var n in e)__hasOwnProp.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))r.indexOf(n)<0&&__propIsEnum.call(e,n)&&(t[n]=e[n]);return t},__publicField=(e,r,t)=>__defNormalProp(e,"symbol"!=typeof r?r+"":r,t),__accessCheck=(e,r,t)=>r.has(e)||__typeError("Cannot "+t),__privateGet=(e,r,t)=>(__accessCheck(e,r,"read from private field"),t?t.call(e):r.get(e)),__privateAdd=(e,r,t)=>r.has(e)?__typeError("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,t),__privateSet=(e,r,t,n)=>(__accessCheck(e,r,"write to private field"),n?n.call(e,t):r.set(e,t),t),__async=(e,r,t)=>new Promise((n,o)=>{var i=e=>{try{a(t.next(e))}catch(r){o(r)}},s=e=>{try{a(t.throw(e))}catch(r){o(r)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,s);a((t=t.apply(e,r)).next())}),__await=function(e,r){this[0]=e,this[1]=r},__asyncGenerator=(e,r,t)=>{var n=(e,r,o,i)=>{try{var s=t[e](r),a=(r=s.value)instanceof __await,c=s.done;Promise.resolve(a?r[0]:r).then(t=>a?n("return"===e?e:"next",r[1]?{done:t.done,value:t.value}:t,o,i):o({value:t,done:c})).catch(e=>n("throw",e,o,i))}catch(u){i(u)}},o=e=>i[e]=r=>new Promise((t,o)=>n(e,r,t,o)),i={};return t=t.apply(e,r),i[__knownSymbol("asyncIterator")]=()=>i,o("next"),o("throw"),o("return"),i},__yieldStar=e=>{var r,t=e[__knownSymbol("asyncIterator")],n=!1,o={};return null==t?(t=e[__knownSymbol("iterator")](),r=e=>o[e]=r=>t[e](r)):(t=t.call(e),r=e=>o[e]=r=>{if(n){if(n=!1,"throw"===e)throw r;return r}return n=!0,{done:!1,value:new __await(new Promise(n=>{var o=t[e](r);o instanceof Object||__typeError("Object expected"),n(o)}),1)}}),o[__knownSymbol("iterator")]=()=>o,r("next"),"throw"in t?r("throw"):o.throw=e=>{throw e},"return"in t&&r("return"),o},__forAwait=(e,r,t)=>(r=e[__knownSymbol("asyncIterator")])?r.call(e):(e=e[__knownSymbol("iterator")](),r={},(t=(t,n)=>(n=e[t])&&(r[t]=r=>new Promise((t,o,i)=>(r=n.call(e,r),i=r.done,Promise.resolve(r.value).then(e=>t({value:e,done:i}),o)))))("next"),t("return"),r),_a2,_b,_c,_d,_e,_components,_string,_bytes,_h;import{g as getDefaultExportFromCjs,c as commonjsGlobal}from"./qr-CUcyLVYE.js";var scheduler={exports:{}},scheduler_production_min={},hasRequiredScheduler_production_min,hasRequiredScheduler;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(e){function r(e,r){var t=e.length;e.push(r);e:for(;0<t;){var n=t-1>>>1,i=e[n];if(!(0<o(i,r)))break e;e[n]=r,e[t]=i,t=n}}function t(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var r=e[0],t=e.pop();if(t!==r){e[0]=t;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var a=2*(n+1)-1,c=e[a],u=a+1,l=e[u];if(0>o(c,t))u<i&&0>o(l,c)?(e[n]=l,e[u]=t,n=u):(e[n]=c,e[a]=t,n=a);else{if(!(u<i&&0>o(l,t)))break e;e[n]=l,e[u]=t,n=u}}}return r}function o(e,r){var t=e.sortIndex-r.sortIndex;return 0!==t?t:e.id-r.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var c=[],u=[],l=1,d=null,f=3,h=!1,p=!1,y=!1,b="function"==typeof setTimeout?setTimeout:null,m="function"==typeof clearTimeout?clearTimeout:null,g="undefined"!=typeof setImmediate?setImmediate:null;function _(e){for(var o=t(u);null!==o;){if(null===o.callback)n(u);else{if(!(o.startTime<=e))break;n(u),o.sortIndex=o.expirationTime,r(c,o)}o=t(u)}}function w(e){if(y=!1,_(e),!p)if(null!==t(c))p=!0,k($);else{var r=t(u);null!==r&&B(w,r.startTime-e)}}function $(r,o){p=!1,y&&(y=!1,m(T),T=-1),h=!0;var i=f;try{for(_(o),d=t(c);null!==d&&(!(d.expirationTime>o)||r&&!x());){var s=d.callback;if("function"==typeof s){d.callback=null,f=d.priorityLevel;var a=s(d.expirationTime<=o);o=e.unstable_now(),"function"==typeof a?d.callback=a:d===t(c)&&n(c),_(o)}else n(c);d=t(c)}if(null!==d)var l=!0;else{var b=t(u);null!==b&&B(w,b.startTime-o),l=!1}return l}finally{d=null,f=i,h=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var v,E=!1,S=null,T=-1,C=5,P=-1;function x(){return!(e.unstable_now()-P<C)}function A(){if(null!==S){var r=e.unstable_now();P=r;var t=!0;try{t=S(!0,r)}finally{t?v():(E=!1,S=null)}}else E=!1}if("function"==typeof g)v=function(){g(A)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,I=D.port2;D.port1.onmessage=A,v=function(){I.postMessage(null)}}else v=function(){b(A,0)};function k(e){S=e,E||(E=!0,v())}function B(r,t){T=b(function(){r(e.unstable_now())},t)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,k($))},e.unstable_forceFrameRate=function(e){0>e||125<e||(C=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return t(c)},e.unstable_next=function(e){switch(f){case 1:case 2:case 3:var r=3;break;default:r=f}var t=f;f=r;try{return e()}finally{f=t}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,r){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=f;f=e;try{return r()}finally{f=t}},e.unstable_scheduleCallback=function(n,o,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,n){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return n={id:l++,callback:o,priorityLevel:n,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>s?(n.sortIndex=i,r(u,n),null===t(c)&&n===t(u)&&(y?(m(T),T=-1):y=!0,B(w,i-s))):(n.sortIndex=a,r(c,n),p||h||(p=!0,k($))),n},e.unstable_shouldYield=x,e.unstable_wrapCallback=function(e){var r=f;return function(){var t=f;f=r;try{return e.apply(this,arguments)}finally{f=t}}}}(scheduler_production_min)),scheduler_production_min}function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}var dijkstra={exports:{}},hasRequiredDijkstra;function requireDijkstra(){return hasRequiredDijkstra||(hasRequiredDijkstra=1,e={single_source_shortest_paths:function(r,t,n){var o={},i={};i[t]=0;var s,a,c,u,l,d,f,h=e.PriorityQueue.make();for(h.push(t,0);!h.empty();)for(c in a=(s=h.pop()).value,u=s.cost,l=r[a]||{})l.hasOwnProperty(c)&&(d=u+l[c],f=i[c],(void 0===i[c]||f>d)&&(i[c]=d,h.push(c,d),o[c]=a));if(void 0!==n&&void 0===i[n]){var p=["Could not find a path from ",t," to ",n,"."].join("");throw new Error(p)}return o},extract_shortest_path_from_predecessor_list:function(e,r){for(var t=[],n=r;n;)t.push(n),e[n],n=e[n];return t.reverse(),t},find_path:function(r,t,n){var o=e.single_source_shortest_paths(r,t,n);return e.extract_shortest_path_from_predecessor_list(o,n)},PriorityQueue:{make:function(r){var t,n=e.PriorityQueue,o={};for(t in r=r||{},n)n.hasOwnProperty(t)&&(o[t]=n[t]);return o.queue=[],o.sorter=r.sorter||n.default_sorter,o},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var t={value:e,cost:r};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}},dijkstra.exports=e),dijkstra.exports;var e}const LOAD_BASE=e=>Promise.reject(new Error(`No base found for "${e}"`));class Multibases{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||LOAD_BASE;for(const r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}getBase(e){return __async(this,null,function*(){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const r=yield this._loadBase(e);return null==this._basesByName[r.name]&&null==this._basesByPrefix[r.prefix]&&this.addBase(r),r})}listBases(){return Object.values(this._basesByName)}}const LOAD_CODEC=e=>Promise.reject(new Error(`No codec found for "${e}"`));class Multicodecs{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||LOAD_CODEC;for(const r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}getCodec(e){return __async(this,null,function*(){const r="string"==typeof e?this._codecsByName:this._codecsByCode;if(r[e])return r[e];const t=yield this._loadCodec(e);return null==r[e]&&this.addCodec(t),t})}listCodecs(){return Object.values(this._codecsByName)}}const LOAD_HASHER=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class Multihashes{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||LOAD_HASHER;for(const r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}getHasher(e){return __async(this,null,function*(){const r="string"==typeof e?this._hashersByName:this._hashersByCode;if(r[e])return r[e];const t=yield this._loadHasher(e);return null==r[e]&&this.addHasher(t),t})}listHashers(){return Object.values(this._hashersByName)}}function equals$b(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function coerce$5(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$5(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src$6=base$5,_brrp__multiformats_scope_baseX$5=src$6;let Encoder$5=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$5=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseDecode"),__publicField(this,"prefixCodePoint"),this.name=e,this.prefix=r;const n=r.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or$5(this,e)}},ComposedDecoder$5=class{constructor(e){__publicField(this,"decoders"),this.decoders=e}or(e){return or$5(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(null!=t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$5(e,r){var t,n;return new ComposedDecoder$5(__spreadValues(__spreadValues({},null!=(t=e.decoders)?t:{[e.prefix]:e}),null!=(n=r.decoders)?n:{[r.prefix]:r}))}let Codec$5=class{constructor(e,r,t,n){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),__publicField(this,"baseDecode"),__publicField(this,"encoder"),__publicField(this,"decoder"),this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder$5(e,r,t),this.decoder=new Decoder$5(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$6({name:e,prefix:r,encode:t,decode:n}){return new Codec$5(e,r,t,n)}function baseX$5({name:e,prefix:r,alphabet:t}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$5(t,e);return from$6({prefix:r,name:e,encode:n,decode:e=>coerce$5(o(e))})}function decode$z(e,r,t,n){let o=e.length;for(;"="===e[o-1];)--o;const i=new Uint8Array(o*t/8|0);let s=0,a=0,c=0;for(let u=0;u<o;++u){const o=r[e[u]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);a=a<<t|o,s+=t,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=t||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return i}function encode$o(e,r,t){const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(0!==s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i}function createAlphabetIdx$3(e){const r={};for(let t=0;t<e.length;++t)r[e[t]]=t;return r}function rfc4648$5({name:e,prefix:r,bitsPerChar:t,alphabet:n}){const o=createAlphabetIdx$3(n);return from$6({prefix:r,name:e,encode:e=>encode$o(e,n,t),decode:r=>decode$z(r,o,t,e)})}const base32$8=rfc4648$5({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$5({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rfc4648$5({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rfc4648$5({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rfc4648$5({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rfc4648$5({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rfc4648$5({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rfc4648$5({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rfc4648$5({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$8=baseX$5({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$5({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$5=baseX$5({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$5({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$5=encode$n,MSB$5=128,MSBALL$4=-128,INT$4=Math.pow(2,31);function encode$n(e,r,t){r=r||[];for(var n=t=t||0;e>=INT$4;)r[t++]=255&e|MSB$5,e/=128;for(;e&MSBALL$4;)r[t++]=255&e|MSB$5,e>>>=7;return r[t]=0|e,encode$n.bytes=t-n+1,r}var decode$y=read$4,MSB$1$5=128,REST$1$4=127;function read$4(e,r){var t,n=0,o=0,i=r=r||0,s=e.length;do{if(i>=s)throw read$4.bytes=0,new RangeError("Could not decode varint");t=e[i++],n+=o<28?(t&REST$1$4)<<o:(t&REST$1$4)*Math.pow(2,o),o+=7}while(t>=MSB$1$5);return read$4.bytes=i-r,n}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$5=function(e){return e<N1$5?1:e<N2$5?2:e<N3$5?3:e<N4$5?4:e<N5$5?5:e<N6$5?6:e<N7$5?7:e<N8$4?8:e<N9$4?9:10},varint$6={encode:encode_1$5,decode:decode$y,encodingLength:length$5},_brrp_varint$4=varint$6;function decode$x(e,r=0){return[_brrp_varint$4.decode(e,r),_brrp_varint$4.decode.bytes]}function encodeTo$4(e,r,t=0){return _brrp_varint$4.encode(e,r,t),r}function encodingLength$5(e){return _brrp_varint$4.encodingLength(e)}function create$5(e,r){const t=r.byteLength,n=encodingLength$5(e),o=n+encodingLength$5(t),i=new Uint8Array(o+t);return encodeTo$4(e,i,0),encodeTo$4(t,i,n),i.set(r,o),new Digest$4(e,t,r,i)}function decode$w(e){const r=coerce$5(e),[t,n]=decode$x(r),[o,i]=decode$x(r.subarray(n)),s=r.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Digest$4(t,o,s,r)}function equals$a(e,r){if(e===r)return!0;{const t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&equals$b(e.bytes,t.bytes)}}let Digest$4=class{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"size"),__publicField(this,"digest"),__publicField(this,"bytes"),this.code=e,this.size=r,this.digest=t,this.bytes=n}};function format$5(e,r){const{bytes:t,version:n}=e;return 0===n?toStringV0$4(t,baseCache$4(e),null!=r?r:base58btc$5.encoder):toStringV1$4(t,baseCache$4(e),null!=r?r:base32$8.encoder)}const cache$4=new WeakMap;function baseCache$4(e){const r=cache$4.get(e);if(null==r){const r=new Map;return cache$4.set(e,r),r}return r}let CID$4=class e{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"version"),__publicField(this,"multihash"),__publicField(this,"bytes"),__publicField(this,"/"),__publicField(this,_a2,"CID"),this.code=r,this.version=e,this.multihash=t,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:t}=this;if(r!==DAG_PB_CODE$4)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$4)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:t}=this.multihash,n=create$5(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(e,r){const t=r;return null!=t&&e.code===t.code&&e.version===t.version&&equals$a(e.multihash,t.multihash)}toString(e){return format$5(this,e)}toJSON(){return{"/":format$5(this)}}link(){return this}[(_a2=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(r){if(null==r)return null;const t=r;if(t instanceof e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:n,multihash:o,bytes:i}=t;return new e(r,n,o,null!=i?i:encodeCID$5(r,n,o.bytes))}if(!0===t[cidSymbol$4]){const{version:r,multihash:n,code:o}=t,i=decode$w(n);return e.create(r,o,i)}return null}static create(r,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:if(t!==DAG_PB_CODE$4)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$4}) block encoding`);return new e(r,t,n,n.bytes);case 1:{const o=encodeCID$5(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,DAG_PB_CODE$4,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){const[t,n]=e.decodeFirst(r);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(r){const t=e.inspectBytes(r),n=t.size-t.multihashSize,o=coerce$5(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),s=new Digest$4(t.multihashCode,t.digestSize,i,o);return[0===t.version?e.createV0(s):e.createV1(t.codec,s),r.subarray(t.size)]}static inspectBytes(e){let r=0;const t=()=>{const[t,n]=decode$x(e.subarray(r));return r+=n,t};let n=t(),o=DAG_PB_CODE$4;if(18===n?(n=0,r=0):o=t(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=r,s=t(),a=t(),c=r+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(r,t){const[n,o]=parseCIDtoBytes$4(r,t),i=e.decode(o);if(0===i.version&&"Q"!==r[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache$4(i).set(n,r),i}};function parseCIDtoBytes$4(e,r){switch(e[0]){case"Q":{const t=null!=r?r:base58btc$5;return[base58btc$5.prefix,t.decode(`${base58btc$5.prefix}${e}`)]}case base58btc$5.prefix:{const t=null!=r?r:base58btc$5;return[base58btc$5.prefix,t.decode(e)]}case base32$8.prefix:{const t=null!=r?r:base32$8;return[base32$8.prefix,t.decode(e)]}case base36$8.prefix:{const t=null!=r?r:base36$8;return[base36$8.prefix,t.decode(e)]}default:if(null==r)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}function toStringV0$4(e,r,t){const{prefix:n}=t;if(n!==base58btc$5.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=r.get(n);if(null==o){const o=t.encode(e).slice(1);return r.set(n,o),o}return o}function toStringV1$4(e,r,t){const{prefix:n}=t,o=r.get(n);if(null==o){const o=t.encode(e);return r.set(n,o),o}return o}const DAG_PB_CODE$4=112,SHA_256_CODE$4=18;function encodeCID$5(e,r,t){const n=encodingLength$5(e),o=n+encodingLength$5(r),i=new Uint8Array(o+t.byteLength);return encodeTo$4(e,i,0),encodeTo$4(r,i,n),i.set(t,o),i}const cidSymbol$4=Symbol.for("@ipld/js-cid/CID"),textDecoder$2=new TextDecoder;function decodeVarint(e,r){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(r>=e.length)throw new Error("protobuf: unexpected end of data");const o=e[r++];if(t+=n<28?(127&o)<<n:(127&o)*__pow(2,n),o<128)break}return[t,r]}function decodeBytes(e,r){let t;[t,r]=decodeVarint(e,r);const n=r+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(r,n),n]}function decodeKey(e,r){let t;return[t,r]=decodeVarint(e,r),[7&t,t>>3,r]}function decodeLink(e){const r={},t=e.length;let n=0;for(;n<t;){let t,o;if([t,o,n]=decodeKey(e,n),1===o){if(r.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==t)throw new Error(`protobuf: (PBLink) wrong wireType (${t}) for Hash`);if(void 0!==r.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==r.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[r.Hash,n]=decodeBytes(e,n)}else if(2===o){if(void 0!==r.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==t)throw new Error(`protobuf: (PBLink) wrong wireType (${t}) for Name`);if(void 0!==r.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=decodeBytes(e,n),r.Name=textDecoder$2.decode(o)}else{if(3!==o)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`);if(void 0!==r.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==t)throw new Error(`protobuf: (PBLink) wrong wireType (${t}) for Tsize`);[r.Tsize,n]=decodeVarint(e,n)}}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return r}function decodeNode(e){const r=e.length;let t,n,o=0,i=!1;for(;o<r;){let r,s;if([r,s,o]=decodeKey(e,o),2!==r)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${r}`);if(1===s){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,o]=decodeBytes(e,o),t&&(i=!0)}else{if(2!==s)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${s}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let r;t||(t=[]),[r,o]=decodeBytes(e,o),t.push(decodeLink(r))}}}if(o>r)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return n&&(s.Data=n),s.Links=t||[],s}const textEncoder$3=new TextEncoder,maxInt32=__pow(2,32),maxUInt32=__pow(2,31);function encodeLink(e,r){let t=r.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");t=encodeVarint(r,t,e.Tsize)-1,r[t]=24}if("string"==typeof e.Name){const n=textEncoder$3.encode(e.Name);t-=n.length,r.set(n,t),t=encodeVarint(r,t,n.length)-1,r[t]=18}return e.Hash&&(t-=e.Hash.length,r.set(e.Hash,t),t=encodeVarint(r,t,e.Hash.length)-1,r[t]=10),r.length-t}function encodeNode(e){const r=sizeNode(e),t=new Uint8Array(r);let n=r;if(e.Data&&(n-=e.Data.length,t.set(e.Data,n),n=encodeVarint(t,n,e.Data.length)-1,t[n]=10),e.Links)for(let o=e.Links.length-1;o>=0;o--){const r=encodeLink(e.Links[o],t.subarray(0,n));n-=r,n=encodeVarint(t,n,r)-1,t[n]=18}return t}function sizeLink(e){let r=0;if(e.Hash){const t=e.Hash.length;r+=1+t+sov(t)}if("string"==typeof e.Name){const t=textEncoder$3.encode(e.Name).length;r+=1+t+sov(t)}return"number"==typeof e.Tsize&&(r+=1+sov(e.Tsize)),r}function sizeNode(e){let r=0;if(e.Data){const t=e.Data.length;r+=1+t+sov(t)}if(e.Links)for(const t of e.Links){const e=sizeLink(t);r+=1+e+sov(e)}return r}function encodeVarint(e,r,t){const n=r-=sov(t);for(;t>=maxUInt32;)e[r++]=127&t|128,t/=128;for(;t>=128;)e[r++]=127&t|128,t>>>=7;return e[r]=t,n}function sov(e){return e%2==0&&e++,Math.floor((len64(e)+6)/7)}function len64(e){let r=0;return e>=maxInt32&&(e=Math.floor(e/maxInt32),r=32),e>=65536&&(e>>>=16,r+=16),e>=256&&(e>>>=8,r+=8),r+len8tab[e]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$2=new TextEncoder;function linkComparator(e,r){if(e===r)return 0;const t=e.Name?textEncoder$2.encode(e.Name):[],n=r.Name?textEncoder$2.encode(r.Name):[];let o=t.length,i=n.length;for(let s=0,a=Math.min(o,i);s<a;++s)if(t[s]!==n[s]){o=t[s],i=n[s];break}return o<i?-1:i<o?1:0}function hasOnlyProperties(e,r){return!Object.keys(e).some(e=>!r.includes(e))}function asLink(e){if("object"==typeof e.asCID){const r=CID$4.asCID(e);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const r={};if(e.Hash){let n=CID$4.asCID(e.Hash);try{n||("string"==typeof e.Hash?n=CID$4.parse(e.Hash):e.Hash instanceof Uint8Array&&(n=CID$4.decode(e.Hash)))}catch(t){throw new TypeError(`Invalid DAG-PB form: ${t.message}`)}n&&(r.Hash=n)}if(!r.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(r.Name=e.Name),"number"==typeof e.Tsize&&(r.Tsize=e.Tsize),r}function prepare(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const r={};if(void 0!==e.Data)if("string"==typeof e.Data)r.Data=textEncoder$2.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");r.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");r.Links=e.Links.map(asLink),r.Links.sort(linkComparator)}else r.Links=[];return r}function validate$2(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(e,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let r=0;r<e.Links.length;r++){const t=e.Links[r];if(!t||"object"!=typeof t||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(t,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==t.Hash||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==t.Name&&"string"!=typeof t.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==t.Tsize){if("number"!=typeof t.Tsize||t.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(r>0&&-1===linkComparator(t,e.Links[r-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(e,r=[]){return prepare({Data:e,Links:r})}function createLink(e,r,t){return asLink({Hash:t,Name:e,Tsize:r})}function toByteView$2(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}const name$6="dag-pb",code$6=112;function encode$m(e){validate$2(e);const r={};return e.Links&&(r.Links=e.Links.map(e=>{const r={};return e.Hash&&(r.Hash=e.Hash.bytes),void 0!==e.Name&&(r.Name=e.Name),void 0!==e.Tsize&&(r.Tsize=e.Tsize),r})),e.Data&&(r.Data=e.Data),encodeNode(r)}function decode$v(e){const r=decodeNode(toByteView$2(e)),t={};return r.Data&&(t.Data=r.Data),r.Links&&(t.Links=r.Links.map(e=>{const r={};try{r.Hash=CID$4.decode(e.Hash)}catch(t){}if(!r.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(r.Name=e.Name),void 0!==e.Tsize&&(r.Tsize=e.Tsize),r})),t}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,createLink:createLink,createNode:createNode,decode:decode$v,encode:encode$m,name:name$6,prepare:prepare,validate:validate$2},Symbol.toStringTag,{value:"Module"})),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const r=typeof e;if(typeofs.includes(r))return r;if("function"===r)return"Function";if(Array.isArray(e))return"Array";if(isBuffer$1(e))return"Buffer";return getObjectType(e)||"Object"}function isBuffer$1(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function getObjectType(e){const r=Object.prototype.toString.call(e).slice(8,-1);if(objectTypeNames.includes(r))return r}class Type{constructor(e,r,t){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=t}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Type.uint=new Type(0,"uint",!0),Type.negint=new Type(1,"negint",!0),Type.bytes=new Type(2,"bytes",!0),Type.string=new Type(3,"string",!0),Type.array=new Type(4,"array",!1),Type.map=new Type(5,"map",!1),Type.tag=new Type(6,"tag",!1),Type.float=new Type(7,"float",!0),Type.false=new Type(7,"false",!0),Type.true=new Type(7,"true",!0),Type.null=new Type(7,"null",!0),Type.undefined=new Type(7,"undefined",!0),Type.break=new Type(7,"break",!0);class Token{constructor(e,r,t){this.type=e,this.value=r,this.encodedLength=t,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,textDecoder$1=new TextDecoder,textEncoder$1=new TextEncoder;function isBuffer(e){return useBuffer&&globalThis.Buffer.isBuffer(e)}function asU8A(e){return e instanceof Uint8Array?isBuffer(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const toString$6=useBuffer?(e,r,t)=>t-r>64?globalThis.Buffer.from(e.subarray(r,t)).toString("utf8"):utf8Slice(e,r,t):(e,r,t)=>t-r>64?textDecoder$1.decode(e.subarray(r,t)):utf8Slice(e,r,t),fromString$6=useBuffer?e=>e.length>64?globalThis.Buffer.from(e):utf8ToBytes(e):e=>e.length>64?textEncoder$1.encode(e):utf8ToBytes(e),fromArray=e=>Uint8Array.from(e),slice=useBuffer?(e,r,t)=>isBuffer(e)?new Uint8Array(e.subarray(r,t)):e.slice(r,t):(e,r,t)=>e.slice(r,t),concat$2=useBuffer?(e,r)=>(e=e.map(e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e)),asU8A(globalThis.Buffer.concat(e,r))):(e,r)=>{const t=new Uint8Array(r);let n=0;for(let o of e)n+o.length>t.length&&(o=o.subarray(0,t.length-n)),t.set(o,n),n+=o.length;return t},alloc=useBuffer?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function compare(e,r){if(isBuffer(e)&&isBuffer(r))return e.compare(r);for(let t=0;t<e.length;t++)if(e[t]!==r[t])return e[t]<r[t]?-1:1;return 0}function utf8ToBytes(e){const r=[];let t=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?r[t++]=o:o<2048?(r[t++]=o>>6|192,r[t++]=63&o|128):55296==(64512&o)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++n)),r[t++]=o>>18|240,r[t++]=o>>12&63|128,r[t++]=o>>6&63|128,r[t++]=63&o|128):(r[t++]=o>>12|224,r[t++]=o>>6&63|128,r[t++]=63&o|128)}return r}function utf8Slice(e,r,t){const n=[];for(;r<t;){const o=e[r];let i=null,s=o>239?4:o>223?3:o>191?2:1;if(r+s<=t){let t,n,a,c;switch(s){case 1:o<128&&(i=o);break;case 2:t=e[r+1],128==(192&t)&&(c=(31&o)<<6|63&t,c>127&&(i=c));break;case 3:t=e[r+1],n=e[r+2],128==(192&t)&&128==(192&n)&&(c=(15&o)<<12|(63&t)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:t=e[r+1],n=e[r+2],a=e[r+3],128==(192&t)&&128==(192&n)&&128==(192&a)&&(c=(15&o)<<18|(63&t)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),r+=s}return decodeCodePointsArray(n)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){const r=e.length;if(r<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);let t="",n=0;for(;n<r;)t+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return t}const defaultChunkSize=256;class Bl{constructor(e=defaultChunkSize){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const t=r.length-(this.maxCursor-this.cursor)-1;r.set(e,t)}else{if(r){const e=r.length-(this.maxCursor-this.cursor)-1;e<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=alloc(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,null===this._initReuseChunk&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(1===this.chunks.length){const t=this.chunks[0];e&&this.cursor>t.length/2?(r=this.cursor===t.length?t:t.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=slice(t,0,this.cursor)}else r=concat$2(this.chunks,this.cursor);return e&&this.reset(),r}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(e,r,t){if(e.length-r<t)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(e,r,t){assertEnoughData(e,r,1);const n=e[r];if(!0===t.strict&&n<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint16(e,r,t){assertEnoughData(e,r,2);const n=e[r]<<8|e[r+1];if(!0===t.strict&&n<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint32(e,r,t){assertEnoughData(e,r,4);const n=16777216*e[r]+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];if(!0===t.strict&&n<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint64(e,r,t){assertEnoughData(e,r,8);const n=16777216*e[r]+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3],o=16777216*e[r+4]+(e[r+5]<<16)+(e[r+6]<<8)+e[r+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===t.strict&&i<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===t.allowBigInt)return i;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(e,r,t,n){return new Token(Type.uint,readUint8(e,r+1,n),2)}function decodeUint16(e,r,t,n){return new Token(Type.uint,readUint16(e,r+1,n),3)}function decodeUint32(e,r,t,n){return new Token(Type.uint,readUint32(e,r+1,n),5)}function decodeUint64(e,r,t,n){return new Token(Type.uint,readUint64(e,r+1,n),9)}function encodeUint(e,r){return encodeUintValue(e,0,r.value)}function encodeUintValue(e,r,t){if(t<uintBoundaries[0]){const n=Number(t);e.push([r|n])}else if(t<uintBoundaries[1]){const n=Number(t);e.push([24|r,n])}else if(t<uintBoundaries[2]){const n=Number(t);e.push([25|r,n>>>8,255&n])}else if(t<uintBoundaries[3]){const n=Number(t);e.push([26|r,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(t);if(!(n<uintBoundaries[4]))throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`);{const t=[27|r,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));t[8]=255&o,o>>=8,t[7]=255&o,o>>=8,t[6]=255&o,o>>=8,t[5]=255&o,t[4]=255&i,i>>=8,t[3]=255&i,i>>=8,t[2]=255&i,i>>=8,t[1]=255&i,e.push(t)}}}function decodeNegint8(e,r,t,n){return new Token(Type.negint,-1-readUint8(e,r+1,n),2)}function decodeNegint16(e,r,t,n){return new Token(Type.negint,-1-readUint16(e,r+1,n),3)}function decodeNegint32(e,r,t,n){return new Token(Type.negint,-1-readUint32(e,r+1,n),5)}encodeUint.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeUintValue.encodedSize=function(e){return e<uintBoundaries[0]?1:e<uintBoundaries[1]?2:e<uintBoundaries[2]?3:e<uintBoundaries[3]?5:9},encodeUint.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0};const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(e,r,t,n){const o=readUint64(e,r+1,n);if("bigint"!=typeof o){const e=-1-o;if(e>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(o),9)}function encodeNegint(e,r){const t=r.value,n="bigint"==typeof t?t*neg1b-pos1b:-1*t-1;encodeUintValue(e,r.type.majorEncoded,n)}function toToken$3(e,r,t,n){assertEnoughData(e,r,t+n);const o=slice(e,r+t,r+t+n);return new Token(Type.bytes,o,t+n)}function decodeBytesCompact(e,r,t,n){return toToken$3(e,r,1,t)}function decodeBytes8(e,r,t,n){return toToken$3(e,r,2,readUint8(e,r+1,n))}function decodeBytes16(e,r,t,n){return toToken$3(e,r,3,readUint16(e,r+1,n))}function decodeBytes32(e,r,t,n){return toToken$3(e,r,5,readUint32(e,r+1,n))}function decodeBytes64(e,r,t,n){const o=readUint64(e,r+1,n);if("bigint"==typeof o)throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(e,r,9,o)}function tokenBytes(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===Type.string?fromString$6(e.value):e.value),e.encodedBytes}function encodeBytes(e,r){const t=tokenBytes(r);encodeUintValue(e,r.type.majorEncoded,t.length),e.push(t)}function compareBytes(e,r){return e.length<r.length?-1:e.length>r.length?1:compare(e,r)}function toToken$2(e,r,t,n,o){const i=t+n;assertEnoughData(e,r,i);const s=new Token(Type.string,toString$6(e,r+t,r+i),i);return!0===o.retainStringBytes&&(s.byteValue=slice(e,r+t,r+i)),s}function decodeStringCompact(e,r,t,n){return toToken$2(e,r,1,t,n)}function decodeString8(e,r,t,n){return toToken$2(e,r,2,readUint8(e,r+1,n),n)}function decodeString16(e,r,t,n){return toToken$2(e,r,3,readUint16(e,r+1,n),n)}function decodeString32(e,r,t,n){return toToken$2(e,r,5,readUint32(e,r+1,n),n)}function decodeString64(e,r,t,n){const o=readUint64(e,r+1,n);if("bigint"==typeof o)throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(e,r,9,o,n)}encodeNegint.encodedSize=function(e){const r=e.value,t="bigint"==typeof r?r*neg1b-pos1b:-1*r-1;return t<uintBoundaries[0]?1:t<uintBoundaries[1]?2:t<uintBoundaries[2]?3:t<uintBoundaries[3]?5:9},encodeNegint.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0},encodeBytes.encodedSize=function(e){const r=tokenBytes(e);return encodeUintValue.encodedSize(r.length)+r.length},encodeBytes.compareTokens=function(e,r){return compareBytes(tokenBytes(e),tokenBytes(r))};const encodeString=encodeBytes;function toToken$1(e,r,t,n){return new Token(Type.array,n,t)}function decodeArrayCompact(e,r,t,n){return toToken$1(e,r,1,t)}function decodeArray8(e,r,t,n){return toToken$1(e,r,2,readUint8(e,r+1,n))}function decodeArray16(e,r,t,n){return toToken$1(e,r,3,readUint16(e,r+1,n))}function decodeArray32(e,r,t,n){return toToken$1(e,r,5,readUint32(e,r+1,n))}function decodeArray64(e,r,t,n){const o=readUint64(e,r+1,n);if("bigint"==typeof o)throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(e,r,9,o)}function decodeArrayIndefinite(e,r,t,n){if(!1===n.allowIndefinite)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(e,r,1,1/0)}function encodeArray(e,r){encodeUintValue(e,Type.array.majorEncoded,r.value)}function toToken(e,r,t,n){return new Token(Type.map,n,t)}function decodeMapCompact(e,r,t,n){return toToken(e,r,1,t)}function decodeMap8(e,r,t,n){return toToken(e,r,2,readUint8(e,r+1,n))}function decodeMap16(e,r,t,n){return toToken(e,r,3,readUint16(e,r+1,n))}function decodeMap32(e,r,t,n){return toToken(e,r,5,readUint32(e,r+1,n))}function decodeMap64(e,r,t,n){const o=readUint64(e,r+1,n);if("bigint"==typeof o)throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(e,r,9,o)}function decodeMapIndefinite(e,r,t,n){if(!1===n.allowIndefinite)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(e,r,1,1/0)}function encodeMap(e,r){encodeUintValue(e,Type.map.majorEncoded,r.value)}function decodeTagCompact(e,r,t,n){return new Token(Type.tag,t,1)}function decodeTag8(e,r,t,n){return new Token(Type.tag,readUint8(e,r+1,n),2)}function decodeTag16(e,r,t,n){return new Token(Type.tag,readUint16(e,r+1,n),3)}function decodeTag32(e,r,t,n){return new Token(Type.tag,readUint32(e,r+1,n),5)}function decodeTag64(e,r,t,n){return new Token(Type.tag,readUint64(e,r+1,n),9)}function encodeTag(e,r){encodeUintValue(e,Type.tag.majorEncoded,r.value)}encodeArray.compareTokens=encodeUint.compareTokens,encodeArray.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeMap.compareTokens=encodeUint.compareTokens,encodeMap.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeTag.compareTokens=encodeUint.compareTokens,encodeTag.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(e,r,t,n){if(!1===n.allowUndefined)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(e,r,t,n){if(!1===n.allowIndefinite)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(e,r,t){if(t){if(!1===t.allowNaN&&Number.isNaN(e))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(!1===t.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,e,r)}function decodeFloat16(e,r,t,n){return createToken(readFloat16(e,r+1),3,n)}function decodeFloat32(e,r,t,n){return createToken(readFloat32(e,r+1),5,n)}function decodeFloat64(e,r,t,n){return createToken(readFloat64(e,r+1),9,n)}function encodeFloat(e,r,t){const n=r.value;if(!1===n)e.push([Type.float.majorEncoded|MINOR_FALSE]);else if(!0===n)e.push([Type.float.majorEncoded|MINOR_TRUE]);else if(null===n)e.push([Type.float.majorEncoded|MINOR_NULL]);else if(void 0===n)e.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let r,o=!1;t&&!0===t.float64||(encodeFloat16(n),r=readFloat16(ui8a,1),n===r||Number.isNaN(n)?(ui8a[0]=249,e.push(ui8a.slice(0,3)),o=!0):(encodeFloat32(n),r=readFloat32(ui8a,1),n===r&&(ui8a[0]=250,e.push(ui8a.slice(0,5)),o=!0))),o||(encodeFloat64(n),r=readFloat64(ui8a,1),ui8a[0]=251,e.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(e,r){const t=e.value;if(!1===t||!0===t||null==t)return 1;if(!r||!0!==r.float64){encodeFloat16(t);let e=readFloat16(ui8a,1);if(t===e||Number.isNaN(t))return 3;if(encodeFloat32(t),e=readFloat32(ui8a,1),t===e)return 5}return 9};const buffer=new ArrayBuffer(9),dataView=new DataView(buffer,1),ui8a=new Uint8Array(buffer,0);function encodeFloat16(e){if(e===1/0)dataView.setUint16(0,31744,!1);else if(e===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(e))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,e);const r=dataView.getUint32(0),t=(2139095040&r)>>23,n=8388607&r;if(255===t)dataView.setUint16(0,31744,!1);else if(0===t)dataView.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=t-127;e<-24?dataView.setUint16(0,0):e<-14?dataView.setUint16(0,(2147483648&r)>>16|1<<24+e,!1):dataView.setUint16(0,(2147483648&r)>>16|e+15<<10|n>>13,!1)}}}function readFloat16(e,r){if(e.length-r<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const t=(e[r]<<8)+e[r+1];if(31744===t)return 1/0;if(64512===t)return-1/0;if(32256===t)return NaN;const n=t>>10&31,o=1023&t;let i;return i=0===n?o*__pow(2,-24):31!==n?(o+1024)*__pow(2,n-25):0===o?1/0:NaN,32768&t?-i:i}function encodeFloat32(e){dataView.setFloat32(0,e,!1)}function readFloat32(e,r){if(e.length-r<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,4).getFloat32(0,!1)}function encodeFloat64(e){dataView.setFloat64(0,e,!1)}function readFloat64(e,r){if(e.length-r<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,8).getFloat64(0,!1)}function invalidMinor(e,r,t){throw new Error(`${decodeErrPrefix} encountered invalid minor (${t}) for major ${e[r]>>>5}`)}function errorer(e){return()=>{throw new Error(`${decodeErrPrefix} ${e}`)}}encodeFloat.compareTokens=encodeUint.compareTokens;const jump=[];for(let e=0;e<=23;e++)jump[e]=invalidMinor;jump[24]=decodeUint8,jump[25]=decodeUint16,jump[26]=decodeUint32,jump[27]=decodeUint64,jump[28]=invalidMinor,jump[29]=invalidMinor,jump[30]=invalidMinor,jump[31]=invalidMinor;for(let e=32;e<=55;e++)jump[e]=invalidMinor;jump[56]=decodeNegint8,jump[57]=decodeNegint16,jump[58]=decodeNegint32,jump[59]=decodeNegint64,jump[60]=invalidMinor,jump[61]=invalidMinor,jump[62]=invalidMinor,jump[63]=invalidMinor;for(let e=64;e<=87;e++)jump[e]=decodeBytesCompact;jump[88]=decodeBytes8,jump[89]=decodeBytes16,jump[90]=decodeBytes32,jump[91]=decodeBytes64,jump[92]=invalidMinor,jump[93]=invalidMinor,jump[94]=invalidMinor,jump[95]=errorer("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)jump[e]=decodeStringCompact;jump[120]=decodeString8,jump[121]=decodeString16,jump[122]=decodeString32,jump[123]=decodeString64,jump[124]=invalidMinor,jump[125]=invalidMinor,jump[126]=invalidMinor,jump[127]=errorer("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)jump[e]=decodeArrayCompact;jump[152]=decodeArray8,jump[153]=decodeArray16,jump[154]=decodeArray32,jump[155]=decodeArray64,jump[156]=invalidMinor,jump[157]=invalidMinor,jump[158]=invalidMinor,jump[159]=decodeArrayIndefinite;for(let e=160;e<=183;e++)jump[e]=decodeMapCompact;jump[184]=decodeMap8,jump[185]=decodeMap16,jump[186]=decodeMap32,jump[187]=decodeMap64,jump[188]=invalidMinor,jump[189]=invalidMinor,jump[190]=invalidMinor,jump[191]=decodeMapIndefinite;for(let e=192;e<=215;e++)jump[e]=decodeTagCompact;jump[216]=decodeTag8,jump[217]=decodeTag16,jump[218]=decodeTag32,jump[219]=decodeTag64,jump[220]=invalidMinor,jump[221]=invalidMinor,jump[222]=invalidMinor,jump[223]=invalidMinor;for(let e=224;e<=243;e++)jump[e]=errorer("simple values are not supported");jump[244]=invalidMinor,jump[245]=invalidMinor,jump[246]=invalidMinor,jump[247]=decodeUndefined,jump[248]=errorer("simple values are not supported"),jump[249]=decodeFloat16,jump[250]=decodeFloat32,jump[251]=decodeFloat64,jump[252]=invalidMinor,jump[253]=invalidMinor,jump[254]=invalidMinor,jump[255]=decodeBreak;const quick=[];for(let e=0;e<24;e++)quick[e]=new Token(Type.uint,e,1);for(let e=-1;e>=-24;e--)quick[31-e]=new Token(Type.negint,e,1);function quickEncodeToken(e){switch(e.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return e.value.length?void 0:fromArray([64]);case Type.string:return""===e.value?fromArray([96]):void 0;case Type.array:return 0===e.value?fromArray([128]):void 0;case Type.map:return 0===e.value?fromArray([160]):void 0;case Type.uint:return e.value<24?fromArray([Number(e.value)]):void 0;case Type.negint:if(e.value>=-24)return fromArray([31-Number(e.value)])}}quick[64]=new Token(Type.bytes,new Uint8Array(0),1),quick[96]=new Token(Type.string,"",1),quick[128]=new Token(Type.array,0,1),quick[160]=new Token(Type.map,0,1),quick[244]=new Token(Type.false,!1,1),quick[245]=new Token(Type.true,!0,1),quick[246]=new Token(Type.null,null,1);const defaultEncodeOptions$1={float64:!1,mapSorter:mapSorter$1,quickEncodeToken:quickEncodeToken};function makeCborEncoders(){const e=[];return e[Type.uint.major]=encodeUint,e[Type.negint.major]=encodeNegint,e[Type.bytes.major]=encodeBytes,e[Type.string.major]=encodeString,e[Type.array.major]=encodeArray,e[Type.map.major]=encodeMap,e[Type.tag.major]=encodeTag,e[Type.float.major]=encodeFloat,e}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do{if(r.obj===e)return!0}while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(r,e)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number:(e,r,t,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new Token(e>=0?Type.uint:Type.negint,e):new Token(Type.float,e),bigint:(e,r,t,n)=>e>=BigInt(0)?new Token(Type.uint,e):new Token(Type.negint,e),Uint8Array:(e,r,t,n)=>new Token(Type.bytes,e),string:(e,r,t,n)=>new Token(Type.string,e),boolean:(e,r,t,n)=>e?simpleTokens.true:simpleTokens.false,null:(e,r,t,n)=>simpleTokens.null,undefined:(e,r,t,n)=>simpleTokens.undefined,ArrayBuffer:(e,r,t,n)=>new Token(Type.bytes,new Uint8Array(e)),DataView:(e,r,t,n)=>new Token(Type.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,r,t,n){if(!e.length)return!0===t.addBreakTokens?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;n=Ref.createCheck(n,e);const o=[];let i=0;for(const s of e)o[i++]=objectToTokens(s,t,n);return t.addBreakTokens?[new Token(Type.array,e.length),o,new Token(Type.break)]:[new Token(Type.array,e.length),o]},Object(e,r,t,n){const o="Object"!==r,i=o?e.keys():Object.keys(e),s=o?e.size:i.length;if(!s)return!0===t.addBreakTokens?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;n=Ref.createCheck(n,e);const a=[];let c=0;for(const u of i)a[c++]=[objectToTokens(u,t,n),objectToTokens(o?e.get(u):e[u],t,n)];return sortMapEntries(a,t),t.addBreakTokens?[new Token(Type.map,s),a,new Token(Type.break)]:[new Token(Type.map,s),a]}};typeEncoders.Map=typeEncoders.Object,typeEncoders.Buffer=typeEncoders.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${e}Array`]=typeEncoders.DataView;function objectToTokens(e,r={},t){const n=is(e),o=r&&r.typeEncoders&&r.typeEncoders[n]||typeEncoders[n];if("function"==typeof o){const i=o(e,n,r,t);if(null!=i)return i}const i=typeEncoders[n];if(!i)throw new Error(`${encodeErrPrefix} unsupported type: ${n}`);return i(e,n,r,t)}function sortMapEntries(e,r){r.mapSorter&&e.sort(r.mapSorter)}function mapSorter$1(e,r){const t=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(r[0])?r[0][0]:r[0];if(t.type!==n.type)return t.type.compare(n.type);const o=t.type.major;return cborEncoders[o].compareTokens(t,n)}function tokensToEncoded(e,r,t,n){if(Array.isArray(r))for(const o of r)tokensToEncoded(e,o,t,n);else t[r.type.major](e,r,n)}function encodeCustom(e,r,t){const n=objectToTokens(e,t);if(!Array.isArray(n)&&t.quickEncodeToken){const e=t.quickEncodeToken(n);if(e)return e;const o=r[n.type.major];if(o.encodedSize){const e=o.encodedSize(n,t),r=new Bl(e);if(o(r,n,t),1!==r.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return asU8A(r.chunks[0])}}return buf.reset(),tokensToEncoded(buf,n,r,t),buf.toBytes(!0)}function encode$l(e,r){return r=Object.assign({},defaultEncodeOptions$1,r),encodeCustom(e,cborEncoders,r)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(e,r={}){this._pos=0,this.data=e,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let r=quick[e];if(void 0===r){const t=jump[e];if(!t)throw new Error(`${decodeErrPrefix} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;r=t(this.data,this._pos,n,this.options)}return this._pos+=r.encodedLength,r}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(e,r,t){const n=[];for(let o=0;o<e.value;o++){const i=tokensToObject(r,t);if(i===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(i===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}function tokenToMap(e,r,t){const n=!0===t.useMaps,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<e.value;s++){const a=tokensToObject(r,t);if(a===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(a===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof a})`);if(!0===t.rejectDuplicateMapKeys&&(n&&i.has(a)||!n&&a in o))throw new Error(`${decodeErrPrefix} found repeat map key "${a}"`);const c=tokensToObject(r,t);if(c===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?i.set(a,c):o[a]=c}return n?i:o}function tokensToObject(e,r){if(e.done())return DONE;const t=e.next();if(t.type===Type.break)return BREAK;if(t.type.terminal)return t.value;if(t.type===Type.array)return tokenToArray(t,e,r);if(t.type===Type.map)return tokenToMap(t,e,r);if(t.type===Type.tag){if(r.tags&&"function"==typeof r.tags[t.value]){const n=tokensToObject(e,r);return r.tags[t.value](n)}throw new Error(`${decodeErrPrefix} tag not supported (${t.value})`)}throw new Error("unsupported")}function decodeFirst(e,r){if(!(e instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);const t=(r=Object.assign({},defaultDecodeOptions,r)).tokenizer||new Tokeniser(e,r),n=tokensToObject(t,r);if(n===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(n===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);return[n,e.subarray(t.pos())]}function decode$u(e,r){const[t,n]=decodeFirst(e,r);if(n.length>0)throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return t}function equals$9(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function coerce$4(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$4(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src$5=base$4,_brrp__multiformats_scope_baseX$4=src$5;let Encoder$4=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$4=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseDecode"),__publicField(this,"prefixCodePoint"),this.name=e,this.prefix=r;const n=r.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or$4(this,e)}},ComposedDecoder$4=class{constructor(e){__publicField(this,"decoders"),this.decoders=e}or(e){return or$4(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(null!=t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$4(e,r){var t,n;return new ComposedDecoder$4(__spreadValues(__spreadValues({},null!=(t=e.decoders)?t:{[e.prefix]:e}),null!=(n=r.decoders)?n:{[r.prefix]:r}))}let Codec$4=class{constructor(e,r,t,n){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),__publicField(this,"baseDecode"),__publicField(this,"encoder"),__publicField(this,"decoder"),this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder$4(e,r,t),this.decoder=new Decoder$4(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$5({name:e,prefix:r,encode:t,decode:n}){return new Codec$4(e,r,t,n)}function baseX$4({name:e,prefix:r,alphabet:t}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$4(t,e);return from$5({prefix:r,name:e,encode:n,decode:e=>coerce$4(o(e))})}function decode$t(e,r,t,n){let o=e.length;for(;"="===e[o-1];)--o;const i=new Uint8Array(o*t/8|0);let s=0,a=0,c=0;for(let u=0;u<o;++u){const o=r[e[u]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);a=a<<t|o,s+=t,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=t||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return i}function encode$k(e,r,t){const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(0!==s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i}function createAlphabetIdx$2(e){const r={};for(let t=0;t<e.length;++t)r[e[t]]=t;return r}function rfc4648$4({name:e,prefix:r,bitsPerChar:t,alphabet:n}){const o=createAlphabetIdx$2(n);return from$5({prefix:r,name:e,encode:e=>encode$k(e,n,t),decode:r=>decode$t(r,o,t,e)})}const base32$7=rfc4648$4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rfc4648$4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rfc4648$4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rfc4648$4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rfc4648$4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rfc4648$4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rfc4648$4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rfc4648$4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$7=baseX$4({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$4({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$4=baseX$4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$4=encode$j,MSB$4=128,MSBALL$3=-128,INT$3=Math.pow(2,31);function encode$j(e,r,t){r=r||[];for(var n=t=t||0;e>=INT$3;)r[t++]=255&e|MSB$4,e/=128;for(;e&MSBALL$3;)r[t++]=255&e|MSB$4,e>>>=7;return r[t]=0|e,encode$j.bytes=t-n+1,r}var decode$s=read$3,MSB$1$4=128,REST$1$3=127;function read$3(e,r){var t,n=0,o=0,i=r=r||0,s=e.length;do{if(i>=s)throw read$3.bytes=0,new RangeError("Could not decode varint");t=e[i++],n+=o<28?(t&REST$1$3)<<o:(t&REST$1$3)*Math.pow(2,o),o+=7}while(t>=MSB$1$4);return read$3.bytes=i-r,n}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$4=function(e){return e<N1$4?1:e<N2$4?2:e<N3$4?3:e<N4$4?4:e<N5$4?5:e<N6$4?6:e<N7$4?7:e<N8$3?8:e<N9$3?9:10},varint$5={encode:encode_1$4,decode:decode$s,encodingLength:length$4},_brrp_varint$3=varint$5;function decode$r(e,r=0){return[_brrp_varint$3.decode(e,r),_brrp_varint$3.decode.bytes]}function encodeTo$3(e,r,t=0){return _brrp_varint$3.encode(e,r,t),r}function encodingLength$4(e){return _brrp_varint$3.encodingLength(e)}function create$4(e,r){const t=r.byteLength,n=encodingLength$4(e),o=n+encodingLength$4(t),i=new Uint8Array(o+t);return encodeTo$3(e,i,0),encodeTo$3(t,i,n),i.set(r,o),new Digest$3(e,t,r,i)}function decode$q(e){const r=coerce$4(e),[t,n]=decode$r(r),[o,i]=decode$r(r.subarray(n)),s=r.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Digest$3(t,o,s,r)}function equals$8(e,r){if(e===r)return!0;{const t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&equals$9(e.bytes,t.bytes)}}let Digest$3=class{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"size"),__publicField(this,"digest"),__publicField(this,"bytes"),this.code=e,this.size=r,this.digest=t,this.bytes=n}};function format$4(e,r){const{bytes:t,version:n}=e;return 0===n?toStringV0$3(t,baseCache$3(e),null!=r?r:base58btc$4.encoder):toStringV1$3(t,baseCache$3(e),null!=r?r:base32$7.encoder)}const cache$3=new WeakMap;function baseCache$3(e){const r=cache$3.get(e);if(null==r){const r=new Map;return cache$3.set(e,r),r}return r}let CID$3=class e{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"version"),__publicField(this,"multihash"),__publicField(this,"bytes"),__publicField(this,"/"),__publicField(this,_b,"CID"),this.code=r,this.version=e,this.multihash=t,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:t}=this;if(r!==DAG_PB_CODE$3)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$3)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:t}=this.multihash,n=create$4(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(e,r){const t=r;return null!=t&&e.code===t.code&&e.version===t.version&&equals$8(e.multihash,t.multihash)}toString(e){return format$4(this,e)}toJSON(){return{"/":format$4(this)}}link(){return this}[(_b=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(r){if(null==r)return null;const t=r;if(t instanceof e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:n,multihash:o,bytes:i}=t;return new e(r,n,o,null!=i?i:encodeCID$4(r,n,o.bytes))}if(!0===t[cidSymbol$3]){const{version:r,multihash:n,code:o}=t,i=decode$q(n);return e.create(r,o,i)}return null}static create(r,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:if(t!==DAG_PB_CODE$3)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$3}) block encoding`);return new e(r,t,n,n.bytes);case 1:{const o=encodeCID$4(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,DAG_PB_CODE$3,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){const[t,n]=e.decodeFirst(r);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(r){const t=e.inspectBytes(r),n=t.size-t.multihashSize,o=coerce$4(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),s=new Digest$3(t.multihashCode,t.digestSize,i,o);return[0===t.version?e.createV0(s):e.createV1(t.codec,s),r.subarray(t.size)]}static inspectBytes(e){let r=0;const t=()=>{const[t,n]=decode$r(e.subarray(r));return r+=n,t};let n=t(),o=DAG_PB_CODE$3;if(18===n?(n=0,r=0):o=t(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=r,s=t(),a=t(),c=r+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(r,t){const[n,o]=parseCIDtoBytes$3(r,t),i=e.decode(o);if(0===i.version&&"Q"!==r[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache$3(i).set(n,r),i}};function parseCIDtoBytes$3(e,r){switch(e[0]){case"Q":{const t=null!=r?r:base58btc$4;return[base58btc$4.prefix,t.decode(`${base58btc$4.prefix}${e}`)]}case base58btc$4.prefix:{const t=null!=r?r:base58btc$4;return[base58btc$4.prefix,t.decode(e)]}case base32$7.prefix:{const t=null!=r?r:base32$7;return[base32$7.prefix,t.decode(e)]}case base36$7.prefix:{const t=null!=r?r:base36$7;return[base36$7.prefix,t.decode(e)]}default:if(null==r)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}function toStringV0$3(e,r,t){const{prefix:n}=t;if(n!==base58btc$4.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=r.get(n);if(null==o){const o=t.encode(e).slice(1);return r.set(n,o),o}return o}function toStringV1$3(e,r,t){const{prefix:n}=t,o=r.get(n);if(null==o){const o=t.encode(e);return r.set(n,o),o}return o}const DAG_PB_CODE$3=112,SHA_256_CODE$3=18;function encodeCID$4(e,r,t){const n=encodingLength$4(e),o=n+encodingLength$4(r),i=new Uint8Array(o+t.byteLength);return encodeTo$3(e,i,0),encodeTo$3(r,i,n),i.set(t,o),i}const cidSymbol$3=Symbol.for("@ipld/js-cid/CID"),CID_CBOR_TAG=42;function toByteView$1(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder$1(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const r=CID$3.asCID(e);if(!r)return null;const t=new Uint8Array(r.bytes.byteLength+1);return t.set(r.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,t)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const _encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}},encodeOptions$1=__spreadProps(__spreadValues({},_encodeOptions),{typeEncoders:__spreadValues({},_encodeOptions.typeEncoders)});function cidDecoder(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$3.decode(e.subarray(1))}const _decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const decodeOptions$1=__spreadProps(__spreadValues({},_decodeOptions),{tags:_decodeOptions.tags.slice()}),name$5="dag-cbor",code$5=113,encode$i=e=>encode$l(e,_encodeOptions),decode$p=e=>decode$u(toByteView$1(e),_decodeOptions),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$p,decodeOptions:decodeOptions$1,encode:encode$i,encodeOptions:encodeOptions$1,name:name$5,toByteView:toByteView$1},Symbol.toStringTag,{value:"Module"}));class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===Type.array&&(r.elements++,1!==r.elements&&e.push([44])),r.type===Type.map&&(r.elements++,1!==r.elements&&(r.elements%2==1?e.push([44]):e.push([58]))))}[Type.uint.major](e,r){this.prefix(e);const t=String(r.value),n=[];for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);e.push(n)}[Type.negint.major](e,r){this[Type.uint.major](e,r)}[Type.bytes.major](e,r){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](e,r){this.prefix(e);const t=fromString$6(JSON.stringify(r.value));e.push(t.length>32?asU8A(t):t)}[Type.array.major](e,r){this.prefix(e),this.inRecursive.push({type:Type.array,elements:0}),e.push([91])}[Type.map.major](e,r){this.prefix(e),this.inRecursive.push({type:Type.map,elements:0}),e.push([123])}[Type.tag.major](e,r){}[Type.float.major](e,r){if("break"===r.type.name){const r=this.inRecursive.pop();if(r){if(r.type===Type.array)e.push([93]);else{if(r.type!==Type.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===r.value)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(e),"true"===r.type.name)return void e.push([116,114,117,101]);if("false"===r.type.name)return void e.push([102,97,108,115,101]);if("null"===r.type.name)return void e.push([110,117,108,108]);const t=String(r.value),n=[];let o=!1;for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i),o||46!==n[i]&&101!==n[i]&&69!==n[i]||(o=!0);o||(n.push(46),n.push(48)),e.push(n)}}function mapSorter(e,r){if(Array.isArray(e[0])||Array.isArray(r[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const t=e[0],n=r[0];if(t.type!==Type.string||n.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if(t<n)return-1;if(t>n)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter:mapSorter};function encode$h(e,r){return r=Object.assign({},defaultEncodeOptions,r),encodeCustom(e,new JSONEncoder,r)}class Tokenizer{constructor(e,r={}){this._pos=0,this.data=e,this.options=r,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this._pos}`);for(let r=0;r<e.length;r++)if(this.data[this._pos++]!==e[r])throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let r=!1,t=!1;const n=e=>{for(;!this.done();){const r=this.ch();if(!e.includes(r))break;this._pos++}};if(45===this.ch()&&(r=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new Token(Type.uint,0,this._pos-e);this._pos++,t=!0}if(n([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===e+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);if(!this.done()&&46===this.ch()){if(t)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);t=!0,this._pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(t=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,n([48,49,50,51,52,53,54,55,56,57]));const o=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),i=parseFloat(o);return t?new Token(Type.float,i,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(i)?new Token(i>=0?Type.uint:Type.negint,i,this._pos-e):new Token(i>=0?Type.uint:Type.negint,BigInt(o),this._pos-e)}parseString(){if(34!==this.ch())throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let o=this._pos,i=0;o<this.data.length&&i<65536;o++,i++){const e=this.data[o];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this._pos,o));return this._pos=o+1,new Token(Type.string,e,i)}}const e=this._pos,r=[],t=()=>{if(this._pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`);let e=0;for(let r=0;r<4;r++){let r=this.ch();if(r>=48&&r<=57)r-=48;else if(r>=97&&r<=102)r=r-97+10;else{if(!(r>=65&&r<=70))throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`);r=r-65+10}e=16*e+r,this._pos++}return e},n=()=>{const e=this.ch();let t,n,o,i,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`);switch(a){case 1:e<128&&(s=e);break;case 2:t=this.data[this._pos+1],128==(192&t)&&(i=(31&e)<<6|63&t,i>127&&(s=i));break;case 3:t=this.data[this._pos+1],n=this.data[this._pos+2],128==(192&t)&&128==(192&n)&&(i=(15&e)<<12|(63&t)<<6|63&n,i>2047&&(i<55296||i>57343)&&(s=i));break;case 4:t=this.data[this._pos+1],n=this.data[this._pos+2],o=this.data[this._pos+3],128==(192&t)&&128==(192&n)&&128==(192&o)&&(i=(15&e)<<18|(63&t)<<12|(63&n)<<6|63&o,i>65535&&i<1114112&&(s=i))}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),this._pos+=a};for(;!this.done();){const o=this.ch();let i;switch(o){case 92:if(this._pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this._pos}`);switch(i=this.ch(),this._pos++,i){case 34:case 39:case 92:case 47:r.push(i);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(t());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Token(Type.string,decodeCodePointsArray(r),this._pos-e);default:if(o<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this._pos}`);o<128?(r.push(o),this._pos++):n()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(44!==this.ch())throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(44!==this.ch())throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function decode$o(e,r){return decode$u(e,r=Object.assign({tokenizer:new Tokenizer(e,r)},r))}function equals$7(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function coerce$3(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$3(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src$4=base$3,_brrp__multiformats_scope_baseX$3=src$4;let Encoder$3=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseDecode"),__publicField(this,"prefixCodePoint"),this.name=e,this.prefix=r;const n=r.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or$3(this,e)}},ComposedDecoder$3=class{constructor(e){__publicField(this,"decoders"),this.decoders=e}or(e){return or$3(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(null!=t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$3(e,r){var t,n;return new ComposedDecoder$3(__spreadValues(__spreadValues({},null!=(t=e.decoders)?t:{[e.prefix]:e}),null!=(n=r.decoders)?n:{[r.prefix]:r}))}let Codec$3=class{constructor(e,r,t,n){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),__publicField(this,"baseDecode"),__publicField(this,"encoder"),__publicField(this,"decoder"),this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder$3(e,r,t),this.decoder=new Decoder$3(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$4({name:e,prefix:r,encode:t,decode:n}){return new Codec$3(e,r,t,n)}function baseX$3({name:e,prefix:r,alphabet:t}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$3(t,e);return from$4({prefix:r,name:e,encode:n,decode:e=>coerce$3(o(e))})}function decode$n(e,r,t,n){let o=e.length;for(;"="===e[o-1];)--o;const i=new Uint8Array(o*t/8|0);let s=0,a=0,c=0;for(let u=0;u<o;++u){const o=r[e[u]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);a=a<<t|o,s+=t,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=t||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return i}function encode$g(e,r,t){const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(0!==s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i}function createAlphabetIdx$1(e){const r={};for(let t=0;t<e.length;++t)r[e[t]]=t;return r}function rfc4648$3({name:e,prefix:r,bitsPerChar:t,alphabet:n}){const o=createAlphabetIdx$1(n);return from$4({prefix:r,name:e,encode:e=>encode$g(e,n,t),decode:r=>decode$n(r,o,t,e)})}const base32$6=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$6=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$3=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$3=encode$f,MSB$3=128,MSBALL$2=-128,INT$2=Math.pow(2,31);function encode$f(e,r,t){r=r||[];for(var n=t=t||0;e>=INT$2;)r[t++]=255&e|MSB$3,e/=128;for(;e&MSBALL$2;)r[t++]=255&e|MSB$3,e>>>=7;return r[t]=0|e,encode$f.bytes=t-n+1,r}var decode$m=read$2,MSB$1$3=128,REST$1$2=127;function read$2(e,r){var t,n=0,o=0,i=r=r||0,s=e.length;do{if(i>=s)throw read$2.bytes=0,new RangeError("Could not decode varint");t=e[i++],n+=o<28?(t&REST$1$2)<<o:(t&REST$1$2)*Math.pow(2,o),o+=7}while(t>=MSB$1$3);return read$2.bytes=i-r,n}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(e){return e<N1$3?1:e<N2$3?2:e<N3$3?3:e<N4$3?4:e<N5$3?5:e<N6$3?6:e<N7$3?7:e<N8$2?8:e<N9$2?9:10},varint$4={encode:encode_1$3,decode:decode$m,encodingLength:length$3},_brrp_varint$2=varint$4;function decode$l(e,r=0){return[_brrp_varint$2.decode(e,r),_brrp_varint$2.decode.bytes]}function encodeTo$2(e,r,t=0){return _brrp_varint$2.encode(e,r,t),r}function encodingLength$3(e){return _brrp_varint$2.encodingLength(e)}function create$3(e,r){const t=r.byteLength,n=encodingLength$3(e),o=n+encodingLength$3(t),i=new Uint8Array(o+t);return encodeTo$2(e,i,0),encodeTo$2(t,i,n),i.set(r,o),new Digest$2(e,t,r,i)}function decode$k(e){const r=coerce$3(e),[t,n]=decode$l(r),[o,i]=decode$l(r.subarray(n)),s=r.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Digest$2(t,o,s,r)}function equals$6(e,r){if(e===r)return!0;{const t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&equals$7(e.bytes,t.bytes)}}let Digest$2=class{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"size"),__publicField(this,"digest"),__publicField(this,"bytes"),this.code=e,this.size=r,this.digest=t,this.bytes=n}};function format$3(e,r){const{bytes:t,version:n}=e;return 0===n?toStringV0$2(t,baseCache$2(e),null!=r?r:base58btc$3.encoder):toStringV1$2(t,baseCache$2(e),null!=r?r:base32$6.encoder)}const cache$2=new WeakMap;function baseCache$2(e){const r=cache$2.get(e);if(null==r){const r=new Map;return cache$2.set(e,r),r}return r}let CID$2=class e{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"version"),__publicField(this,"multihash"),__publicField(this,"bytes"),__publicField(this,"/"),__publicField(this,_c,"CID"),this.code=r,this.version=e,this.multihash=t,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:t}=this;if(r!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:t}=this.multihash,n=create$3(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(e,r){const t=r;return null!=t&&e.code===t.code&&e.version===t.version&&equals$6(e.multihash,t.multihash)}toString(e){return format$3(this,e)}toJSON(){return{"/":format$3(this)}}link(){return this}[(_c=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(r){if(null==r)return null;const t=r;if(t instanceof e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:n,multihash:o,bytes:i}=t;return new e(r,n,o,null!=i?i:encodeCID$3(r,n,o.bytes))}if(!0===t[cidSymbol$2]){const{version:r,multihash:n,code:o}=t,i=decode$k(n);return e.create(r,o,i)}return null}static create(r,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:if(t!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new e(r,t,n,n.bytes);case 1:{const o=encodeCID$3(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,DAG_PB_CODE$2,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){const[t,n]=e.decodeFirst(r);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(r){const t=e.inspectBytes(r),n=t.size-t.multihashSize,o=coerce$3(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),s=new Digest$2(t.multihashCode,t.digestSize,i,o);return[0===t.version?e.createV0(s):e.createV1(t.codec,s),r.subarray(t.size)]}static inspectBytes(e){let r=0;const t=()=>{const[t,n]=decode$l(e.subarray(r));return r+=n,t};let n=t(),o=DAG_PB_CODE$2;if(18===n?(n=0,r=0):o=t(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=r,s=t(),a=t(),c=r+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(r,t){const[n,o]=parseCIDtoBytes$2(r,t),i=e.decode(o);if(0===i.version&&"Q"!==r[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache$2(i).set(n,r),i}};function parseCIDtoBytes$2(e,r){switch(e[0]){case"Q":{const t=null!=r?r:base58btc$3;return[base58btc$3.prefix,t.decode(`${base58btc$3.prefix}${e}`)]}case base58btc$3.prefix:{const t=null!=r?r:base58btc$3;return[base58btc$3.prefix,t.decode(e)]}case base32$6.prefix:{const t=null!=r?r:base32$6;return[base32$6.prefix,t.decode(e)]}case base36$6.prefix:{const t=null!=r?r:base36$6;return[base36$6.prefix,t.decode(e)]}default:if(null==r)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}function toStringV0$2(e,r,t){const{prefix:n}=t;if(n!==base58btc$3.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=r.get(n);if(null==o){const o=t.encode(e).slice(1);return r.set(n,o),o}return o}function toStringV1$2(e,r,t){const{prefix:n}=t,o=r.get(n);if(null==o){const o=t.encode(e);return r.set(n,o),o}return o}const DAG_PB_CODE$2=112,SHA_256_CODE$2=18;function encodeCID$3(e,r,t){const n=encodingLength$3(e),o=n+encodingLength$3(r),i=new Uint8Array(o+t.byteLength);return encodeTo$2(e,i,0),encodeTo$2(r,i,n),i.set(t,o),i}const cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),base64$7=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});function toByteView(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const r=CID$2.asCID(e);if(!r)return null;const t=r.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,t,t.length),new Token(Type.break,void 0,1)]}function bytesEncoder(e){const r=base64$7.encode(e).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,r,r.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function taBytesEncoder(e){return bytesEncoder(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function abBytesEncoder(e){return bytesEncoder(new Uint8Array(e))}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});const encodeOptions={typeEncoders:{Object:cidEncoder,Buffer:bytesEncoder,Uint8Array:bytesEncoder,Int8Array:taBytesEncoder,Uint16Array:taBytesEncoder,Int16Array:taBytesEncoder,Uint32Array:taBytesEncoder,Int32Array:taBytesEncoder,Float32Array:taBytesEncoder,Float64Array:taBytesEncoder,Uint8ClampedArray:taBytesEncoder,BigInt64Array:taBytesEncoder,BigUint64Array:taBytesEncoder,DataView:taBytesEncoder,ArrayBuffer:abBytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(e,r){super(e,r),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===Type.map){const e=this._next();if(e.type===Type.string&&"/"===e.value){const e=this._next();if(e.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new Token(Type.tag,42,0)}if(e.type===Type.map){const e=this._next();if(e.type===Type.string&&"bytes"===e.value){const e=this._next();if(e.type===Type.string){for(let e=0;e<2;e++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const r=base64$7.decode(`m${e.value}`);return new Token(Type.bytes,r,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID$2.parse;const name$4="dag-json",code$4=297,encode$e=e=>encode$h(e,encodeOptions),decode$j=e=>{const r=toByteView(e);return decode$o(r,Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(r,decodeOptions)}))},format$2=e=>utf8Decoder.decode(encode$e(e)),utf8Decoder=new TextDecoder,parse$1=e=>decode$j(utf8Encoder.encode(e)),utf8Encoder=new TextEncoder,dagJSON=Object.freeze(Object.defineProperty({__proto__:null,code:code$4,decode:decode$j,encode:encode$e,format:format$2,name:name$4,parse:parse$1,stringify:format$2},Symbol.toStringTag,{value:"Module"}));function base$2(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src$3=base$2,_brrp__multiformats_scope_baseX$2=src$3;const equals$5=(e,r)=>{if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0},coerce$2=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},fromString$5=e=>(new TextEncoder).encode(e),toString$5=e=>(new TextDecoder).decode(e);let Encoder$2=class{constructor(e,r,t){this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{constructor(e,r,t){if(this.name=e,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or$2(this,e)}},ComposedDecoder$2=class{constructor(e){this.decoders=e}or(e){return or$2(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$2=(e,r)=>new ComposedDecoder$2(__spreadValues(__spreadValues({},e.decoders||{[e.prefix]:e}),r.decoders||{[r.prefix]:r}));let Codec$2=class{constructor(e,r,t,n){this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder$2(e,r,t),this.decoder=new Decoder$2(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$3=({name:e,prefix:r,encode:t,decode:n})=>new Codec$2(e,r,t,n),baseX$2=({prefix:e,name:r,alphabet:t})=>{const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$2(t,r);return from$3({prefix:e,name:r,encode:n,decode:e=>coerce$2(o(e))})},decode$i=(e,r,t,n)=>{const o={};for(let l=0;l<r.length;++l)o[r[l]]=l;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const r=o[e[l]];if(void 0===r)throw new SyntaxError(`Non-${n} character`);c=c<<t|r,a+=t,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},encode$d=(e,r,t)=>{const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i},rfc4648$2=({name:e,prefix:r,bitsPerChar:t,alphabet:n})=>from$3({prefix:r,name:e,encode:e=>encode$d(e,n,t),decode:r=>decode$i(r,n,t,e)}),base64$5=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$6=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$5,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"}));function toBase64url(e){return base64url$2.encode(e).slice(1)}function fromBase64url(e){return base64url$2.decode(`u${e}`)}var encode_1$2=encode$c,MSB$2=128,MSBALL$1=-128,INT$1=Math.pow(2,31);function encode$c(e,r,t){r=r||[];for(var n=t=t||0;e>=INT$1;)r[t++]=255&e|MSB$2,e/=128;for(;e&MSBALL$1;)r[t++]=255&e|MSB$2,e>>>=7;return r[t]=0|e,encode$c.bytes=t-n+1,r}var decode$h=read$1,MSB$1$2=128,REST$1$1=127;function read$1(e,r){var t,n=0,o=0,i=r=r||0,s=e.length;do{if(i>=s)throw read$1.bytes=0,new RangeError("Could not decode varint");t=e[i++],n+=o<28?(t&REST$1$1)<<o:(t&REST$1$1)*Math.pow(2,o),o+=7}while(t>=MSB$1$2);return read$1.bytes=i-r,n}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(e){return e<N1$2?1:e<N2$2?2:e<N3$2?3:e<N4$2?4:e<N5$2?5:e<N6$2?6:e<N7$2?7:e<N8$1?8:e<N9$1?9:10},varint$3={encode:encode_1$2,decode:decode$h,encodingLength:length$2},_brrp_varint$1=varint$3;const decode$g=(e,r=0)=>[_brrp_varint$1.decode(e,r),_brrp_varint$1.decode.bytes],encodeTo$1=(e,r,t=0)=>(_brrp_varint$1.encode(e,r,t),r),encodingLength$2=e=>_brrp_varint$1.encodingLength(e),create$2=(e,r)=>{const t=r.byteLength,n=encodingLength$2(e),o=n+encodingLength$2(t),i=new Uint8Array(o+t);return encodeTo$1(e,i,0),encodeTo$1(t,i,n),i.set(r,o),new Digest$1(e,t,r,i)},decode$f=e=>{const r=coerce$2(e),[t,n]=decode$g(r),[o,i]=decode$g(r.subarray(n)),s=r.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Digest$1(t,o,s,r)},equals$4=(e,r)=>{if(e===r)return!0;{const t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&equals$5(e.bytes,t.bytes)}};let Digest$1=class{constructor(e,r,t,n){this.code=e,this.size=r,this.digest=t,this.bytes=n}};const base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),format$1=(e,r)=>{const{bytes:t,version:n}=e;return 0===n?toStringV0$1(t,baseCache$1(e),r||base58btc$2.encoder):toStringV1$1(t,baseCache$1(e),r||base32$4.encoder)},cache$1=new WeakMap,baseCache$1=e=>{const r=cache$1.get(e);if(null==r){const r=new Map;return cache$1.set(e,r),r}return r};let CID$1=class e{constructor(e,r,t,n){this.code=r,this.version=e,this.multihash=t,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:t}=this;if(r!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:t}=this.multihash,n=create$2(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(e,r){const t=r;return t&&e.code===t.code&&e.version===t.version&&equals$4(e.multihash,t.multihash)}toString(e){return format$1(this,e)}toJSON(){return{"/":format$1(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(null==r)return null;const t=r;if(t instanceof e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:n,multihash:o,bytes:i}=t;return new e(r,n,o,i||encodeCID$2(r,n,o.bytes))}if(!0===t[cidSymbol$1]){const{version:r,multihash:n,code:o}=t,i=decode$f(n);return e.create(r,o,i)}return null}static create(r,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:if(t!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new e(r,t,n,n.bytes);case 1:{const o=encodeCID$2(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,DAG_PB_CODE$1,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){const[t,n]=e.decodeFirst(r);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(r){const t=e.inspectBytes(r),n=t.size-t.multihashSize,o=coerce$2(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),s=new Digest$1(t.multihashCode,t.digestSize,i,o);return[0===t.version?e.createV0(s):e.createV1(t.codec,s),r.subarray(t.size)]}static inspectBytes(e){let r=0;const t=()=>{const[t,n]=decode$g(e.subarray(r));return r+=n,t};let n=t(),o=DAG_PB_CODE$1;if(18===n?(n=0,r=0):o=t(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=r,s=t(),a=t(),c=r+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(r,t){const[n,o]=parseCIDtoBytes$1(r,t),i=e.decode(o);if(0===i.version&&"Q"!==r[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(i).set(n,r),i}};const parseCIDtoBytes$1=(e,r)=>{switch(e[0]){case"Q":{const t=r||base58btc$2;return[base58btc$2.prefix,t.decode(`${base58btc$2.prefix}${e}`)]}case base58btc$2.prefix:{const t=r||base58btc$2;return[base58btc$2.prefix,t.decode(e)]}case base32$4.prefix:{const t=r||base32$4;return[base32$4.prefix,t.decode(e)]}default:if(null==r)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}},toStringV0$1=(e,r,t)=>{const{prefix:n}=t;if(n!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=r.get(n);if(null==o){const o=t.encode(e).slice(1);return r.set(n,o),o}return o},toStringV1$1=(e,r,t)=>{const{prefix:n}=t,o=r.get(n);if(null==o){const o=t.encode(e);return r.set(n,o),o}return o},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$2=(e,r,t)=>{const n=encodingLength$2(e),o=n+encodingLength$2(r),i=new Uint8Array(o+t.byteLength);return encodeTo$1(e,i,0),encodeTo$1(r,i,n),i.set(t,o),i},cidSymbol$1=Symbol.for("@ipld/js-cid/CID");function fromSplit$1(e){const[r,t,n]=e;return{payload:t,signatures:[{protected:r,signature:n}],link:CID$1.decode(fromBase64url(t))}}function encodeSignature(e){const r={signature:fromBase64url(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=fromBase64url(e.protected)),r}function encode$b(e){const r=fromBase64url(e.payload);try{CID$1.decode(r)}catch(t){throw new Error("Not a valid DagJWS")}return{payload:r,signatures:e.signatures.map(encodeSignature)}}function decodeSignature(e){const r={signature:toBase64url(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=toBase64url(e.protected)),r}function decode$e(e){const r={payload:toBase64url(e.payload),signatures:e.signatures.map(decodeSignature)};return r.link=CID$1.decode(new Uint8Array(e.payload)),r}function fromSplit(e){const[r,t,n,o,i]=e,s={ciphertext:o,iv:n,protected:r,tag:i};return t&&(s.recipients=[{encrypted_key:t}]),s}function encodeRecipient(e){const r={};return e.encrypted_key&&(r.encrypted_key=fromBase64url(e.encrypted_key)),e.header&&(r.header=e.header),r}function encode$a(e){const r={ciphertext:fromBase64url(e.ciphertext),protected:fromBase64url(e.protected),iv:fromBase64url(e.iv),tag:fromBase64url(e.tag)};return e.aad&&(r.aad=fromBase64url(e.aad)),e.recipients&&(r.recipients=e.recipients.map(encodeRecipient)),e.unprotected&&(r.unprotected=e.unprotected),r}function decodeRecipient(e){const r={};return e.encrypted_key&&(r.encrypted_key=toBase64url(e.encrypted_key)),e.header&&(r.header=e.header),r}function decode$d(e){const r={ciphertext:toBase64url(e.ciphertext),protected:toBase64url(e.protected),iv:toBase64url(e.iv),tag:toBase64url(e.tag)};return e.aad&&(r.aad=toBase64url(e.aad)),e.recipients&&(r.recipients=e.recipients.map(decodeRecipient)),e.unprotected&&(r.unprotected=e.unprotected),r}const name$3="dag-jose",code$3=133;function isDagJWS(e){return"payload"in e&&"string"==typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function isEncodedJWS(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function isEncodedJWE(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function isDagJWE(e){return"ciphertext"in e&&"string"==typeof e.ciphertext&&"iv"in e&&"string"==typeof e.iv&&"protected"in e&&"string"==typeof e.protected&&"tag"in e&&"string"==typeof e.tag}function toGeneral(e){if("string"==typeof e){const r=e.split(".");if(3===r.length)return fromSplit$1(r);if(5===r.length)return fromSplit(r);throw new Error("Not a valid JOSE string")}if(isDagJWS(e)||isDagJWE(e))return e;throw new Error("Not a valid unencoded JOSE object")}function encode$9(e){let r;if("string"==typeof e&&(e=toGeneral(e)),isDagJWS(e))r=encode$b(e);else{if(!isDagJWE(e))throw new Error("Not a valid JOSE object");r=encode$a(e)}return new Uint8Array(encode$i(r))}function decode$c(e){let r;try{r=decode$p(e)}catch(t){throw new Error("Not a valid DAG-JOSE object")}if(isEncodedJWS(r))return decode$e(r);if(isEncodedJWE(r))return decode$d(r);throw new Error("Not a valid DAG-JOSE object")}const dagJOSE=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$c,encode:encode$9,name:name$3,toGeneral:toGeneral},Symbol.toStringTag,{value:"Module"})),code$2=0,name$2="identity",encode$8=coerce$2,digest=e=>create$2(code$2,encode$8(e)),identity$3={code:code$2,name:name$2,encode:encode$8,digest:digest},identity$4=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"})),identity$2=from$3({prefix:"\0",name:"identity",encode:e=>toString$5(e),decode:e=>fromString$5(e)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),base10$4=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars$2=alphabet$2.reduce((e,r,t)=>(e[t]=r,e),[]),alphabetCharsToBytes$2=alphabet$2.reduce((e,r,t)=>(e[r.codePointAt(0)]=t,e),[]);function encode$7(e){return e.reduce((e,r)=>e+alphabetBytesToChars$2[r],"")}function decode$b(e){const r=[];for(const t of e){const e=alphabetCharsToBytes$2[t.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${t}`);r.push(e)}return new Uint8Array(r)}const base256emoji$4=from$3({prefix:"",name:"base256emoji",encode:encode$7,decode:decode$b}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),from$2=({name:e,code:r,encode:t})=>new Hasher(e,r,t);class Hasher{constructor(e,r,t){this.name=e,this.code=r,this.encode=t}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?create$2(this.code,r):r.then(e=>create$2(this.code,e))}throw Error("Unknown type, must be binary type")}}const sha=e=>r=>__async(null,null,function*(){return new Uint8Array(yield crypto.subtle.digest(e,r))}),sha256=from$2({name:"sha2-256",code:18,encode:sha("SHA-256")}),sha512=from$2({name:"sha2-512",code:19,encode:sha("SHA-512")}),sha2=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256,sha512:sha512},Symbol.toStringTag,{value:"Module"})),name$1="raw",code$1=85,encode$6=e=>coerce$2(e),decode$a=e=>coerce$2(e),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,decode:decode$a,encode:encode$6,name:name$1},Symbol.toStringTag,{value:"Module"})),textEncoder=new TextEncoder,textDecoder=new TextDecoder,name="json",code=512,encode$5=e=>textEncoder.encode(JSON.stringify(e)),decode$9=e=>JSON.parse(textDecoder.decode(e)),json=Object.freeze(Object.defineProperty({__proto__:null,code:code,decode:decode$9,encode:encode$5,name:name},Symbol.toStringTag,{value:"Module"})),bases$2=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},identityBase$2),base2$5),base8$5),base10$5),base16$5),base32$5),base36$5),base58$2),base64$6),base256emoji$5),hashes=__spreadValues(__spreadValues({},sha2),identity$4),codecs$1={raw:raw,json:json};class Parser{constructor(){__publicField(this,"index",0),__publicField(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const r=this.index,t=e();return void 0===t&&(this.index=r),t}parseWith(e){const r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const r=this.readChar();if(r===e)return r})}readSeparator(e,r,t){return this.readAtomically(()=>{if(!(r>0&&void 0===this.readGivenChar(e)))return t()})}readNumber(e,r,t,n){return this.readAtomically(()=>{let o=0,i=0;const s=this.peekChar();if(void 0===s)return;const a="0"===s,c=__pow(2,8*n)-1;for(;;){const t=this.readAtomically(()=>{const r=this.readChar();if(void 0===r)return;const t=Number.parseInt(r,e);return Number.isNaN(t)?void 0:t});if(void 0===t)break;if(o*=e,o+=t,o>c)return;if(i+=1,void 0!==r&&i>r)return}return 0===i||!t&&a&&i>1?void 0:o})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let r=0;r<e.length;r++){const t=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(void 0===t)return;e[r]=t}return e})}readIPv6Addr(){const e=e=>{for(let r=0;r<e.length/2;r++){const t=2*r;if(r<e.length-3){const n=this.readSeparator(":",r,()=>this.readIPv4Addr());if(void 0!==n)return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],[t+4,!0]}const n=this.readSeparator(":",r,()=>this.readNumber(16,4,!0,2));if(void 0===n)return[t,!1];e[t]=n>>8,e[t+1]=255&n}return[e.length,!1]};return this.readAtomically(()=>{const r=new Uint8Array(16),[t,n]=e(r);if(16===t)return r;if(n)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const o=new Uint8Array(14),i=16-(t+2),[s]=e(o.subarray(0,i));return r.set(o.subarray(0,s),16-s),r})}readIPAddr(){var e;return null!=(e=this.readIPv4Addr())?e:this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser=new Parser;function parseIPv4(e){if(!(e.length>MAX_IPV4_LENGTH))return parser.new(e).parseWith(()=>parser.readIPv4Addr())}function parseIPv6(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>MAX_IPV6_LENGTH))return parser.new(e).parseWith(()=>parser.readIPv6Addr())}function parseIP(e,r=!1){if(e.includes("%")&&(e=e.split("%")[0]),e.length>MAX_IPV6_LENGTH)return;const t=parser.new(e).parseWith(()=>parser.readIPAddr());return t?r&&4===t.length?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,t[0],t[1],t[2],t[3]]):t:void 0}function isIPv4(e){return Boolean(parseIPv4(e))}function isIPv6(e){return Boolean(parseIPv6(e))}function isIP(e){return Boolean(parseIP(e))}function base$1(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src$2=base$1,_brrp__multiformats_scope_baseX$1=src$2;const coerce$1=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},fromString$4=e=>(new TextEncoder).encode(e),toString$4=e=>(new TextDecoder).decode(e);let Encoder$1=class{constructor(e,r,t){this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$1=class{constructor(e,r,t){if(this.name=e,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or$1(this,e)}},ComposedDecoder$1=class{constructor(e){this.decoders=e}or(e){return or$1(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$1=(e,r)=>new ComposedDecoder$1(__spreadValues(__spreadValues({},e.decoders||{[e.prefix]:e}),r.decoders||{[r.prefix]:r}));let Codec$1=class{constructor(e,r,t,n){this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder$1(e,r,t),this.decoder=new Decoder$1(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$1=({name:e,prefix:r,encode:t,decode:n})=>new Codec$1(e,r,t,n),baseX$1=({prefix:e,name:r,alphabet:t})=>{const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$1(t,r);return from$1({prefix:e,name:r,encode:n,decode:e=>coerce$1(o(e))})},decode$8=(e,r,t,n)=>{const o={};for(let l=0;l<r.length;++l)o[r[l]]=l;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const r=o[e[l]];if(void 0===r)throw new SyntaxError(`Non-${n} character`);c=c<<t|r,a+=t,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},encode$4=(e,r,t)=>{const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i},rfc4648$1=({name:e,prefix:r,bitsPerChar:t,alphabet:n})=>from$1({prefix:r,name:e,encode:e=>encode$4(e,n,t),decode:r=>decode$8(r,n,t,e)}),base10$2=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from(""),alphabetBytesToChars$1=alphabet$1.reduce((e,r,t)=>(e[t]=r,e),[]),alphabetCharsToBytes$1=alphabet$1.reduce((e,r,t)=>(e[r.codePointAt(0)]=t,e),[]);function encode$3(e){return e.reduce((e,r)=>e+alphabetBytesToChars$1[r],"")}function decode$7(e){const r=[];for(const t of e){const e=alphabetCharsToBytes$1[t.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${t}`);r.push(e)}return new Uint8Array(r)}const base256emoji$2=from$1({prefix:"",name:"base256emoji",encode:encode$3,decode:decode$7}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"})),base32$2=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$3=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$4=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$3,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),identity$1=from$1({prefix:"\0",name:"identity",encode:e=>toString$4(e),decode:e=>fromString$4(e)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$1},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;const bases$1=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},identityBase$1),base2$3),base8$3),base10$3),base16$3),base32$3),base36$3),base58$1),base64$4),base256emoji$3);function asUint8Array$1(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function allocUnsafe$1(e=0){var r;return null!=(null==(r=globalThis.Buffer)?void 0:r.allocUnsafe)?asUint8Array$1(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function createCodec$1(e,r,t,n){return{name:e,prefix:r,encoder:{name:e,prefix:r,encode:t},decoder:{decode:n}}}const string$1=createCodec$1("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),ascii$1=createCodec$1("ascii","a",e=>{let r="a";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e=>{const r=allocUnsafe$1((e=e.substring(1)).length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}),BASES$1=__spreadValues({utf8:string$1,"utf-8":string$1,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1},bases$1);function toString$3(e,r="utf8"){const t=BASES$1[r];if(null==t)throw new Error(`Unsupported encoding "${r}"`);return"utf8"!==r&&"utf-8"!==r||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const isV4=isIPv4,isV6=isIPv6,toBytes$1=function(e){let r=0;if(e=e.toString().trim(),isV4(e)){const t=new Uint8Array(r+4);return e.split(/\./g).forEach(e=>{t[r++]=255&parseInt(e,10)}),t}if(isV6(e)){const t=e.split(":",8);let n;for(n=0;n<t.length;n++){let e;isV4(t[n])&&(e=toBytes$1(t[n]),t[n]=toString$3(e.slice(0,2),"base16")),null!=e&&++n<8&&t.splice(n,0,toString$3(e.slice(2,4),"base16"))}if(""===t[0])for(;t.length<8;)t.unshift("0");else if(""===t[t.length-1])for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&""!==t[n];n++);const e=[n,1];for(n=9-t.length;n>0;n--)e.push("0");t.splice.apply(t,e)}const o=new Uint8Array(r+16);for(n=0;n<t.length;n++){const e=parseInt(t[n],16);o[r++]=e>>8&255,o[r++]=255&e}return o}throw new Error("invalid ip address")},toString$2=function(e,r=0,t){r=~~r,t=null!=t?t:e.length-r;const n=new DataView(e.buffer);if(4===t){const n=[];for(let o=0;o<t;o++)n.push(e[r+o]);return n.join(".")}if(16===t){const e=[];for(let o=0;o<t;o+=2)e.push(n.getUint16(r+o).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$1=-1,names={},codes={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$1,"ip6zone"],[43,8,"ipcidr"],[53,V$1,"dns",!0],[54,V$1,"dns4",!0],[55,V$1,"dns6",!0],[56,V$1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$1,"unix",!1,!0],[421,V$1,"ipfs"],[421,V$1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$1,"garlic64"],[448,0,"tls"],[449,V$1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$1,"memory"]];function createProtocol(e,r,t,n,o){return{code:e,size:r,name:t,resolvable:Boolean(n),path:Boolean(o)}}function getProtocol(e){if("number"==typeof e){if(null!=codes[e])return codes[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=names[e])return names[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}var encode_1$1,hasRequiredEncode,decode$6,hasRequiredDecode,length$1,hasRequiredLength,varint$2,hasRequiredVarint;function requireEncode(){if(hasRequiredEncode)return encode_1$1;hasRequiredEncode=1,encode_1$1=function n(o,i,s){if(Number.MAX_SAFE_INTEGER&&o>Number.MAX_SAFE_INTEGER)throw n.bytes=0,new RangeError("Could not encode varint");i=i||[];for(var a=s=s||0;o>=t;)i[s++]=255&o|e,o/=128;for(;o&r;)i[s++]=255&o|e,o>>>=7;return i[s]=0|o,n.bytes=s-a+1,i};var e=128,r=-128,t=Math.pow(2,31);return encode_1$1}function requireDecode(){if(hasRequiredDecode)return decode$6;hasRequiredDecode=1,decode$6=function t(n,o){var i,s=0,a=0,c=o=o||0,u=n.length;do{if(c>=u||a>49)throw t.bytes=0,new RangeError("Could not decode varint");i=n[c++],s+=a<28?(i&r)<<a:(i&r)*Math.pow(2,a),a+=7}while(i>=e);return t.bytes=c-o,s};var e=128,r=127;return decode$6}function requireLength(){if(hasRequiredLength)return length$1;hasRequiredLength=1;var e=Math.pow(2,7),r=Math.pow(2,14),t=Math.pow(2,21),n=Math.pow(2,28),o=Math.pow(2,35),i=Math.pow(2,42),s=Math.pow(2,49),a=Math.pow(2,56),c=Math.pow(2,63);return length$1=function(u){return u<e?1:u<r?2:u<t?3:u<n?4:u<o?5:u<i?6:u<s?7:u<a?8:u<c?9:10}}function requireVarint(){return hasRequiredVarint?varint$2:(hasRequiredVarint=1,varint$2={encode:requireEncode(),decode:requireDecode(),encodingLength:requireLength()})}table.forEach(e=>{const r=createProtocol(...e);codes[r.code]=r,names[r.name]=r});var varintExports=requireVarint();const varint$1=getDefaultExportFromCjs(varintExports);function fromString$3(e,r="utf8"){const t=BASES$1[r];if(null==t)throw new Error(`Unsupported encoding "${r}"`);return"utf8"!==r&&"utf-8"!==r||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${e}`):asUint8Array$1(globalThis.Buffer.from(e,"utf-8"))}function concat$1(e,r){null==r&&(r=e.reduce((e,r)=>e+r.length,0));const t=allocUnsafe$1(r);let n=0;for(const o of e)t.set(o,n),n+=o.length;return asUint8Array$1(t)}function convertToString(e,r){switch(getProtocol(e).code){case 4:case 41:return bytes2ip(r);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(r);case 6:case 273:case 33:case 132:return bytes2port$1(r).toString();case 421:return bytes2mh(r);case 444:case 445:return bytes2onion$1(r);case 466:return bytes2mb$1(r);default:return toString$3(r,"base16")}}function convertToBytes(e,r){switch(getProtocol(e).code){case 4:case 41:return ip2bytes(r);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(r);case 6:case 273:case 33:case 132:return port2bytes$1(parseInt(r,10));case 421:return mh2bytes(r);case 444:return onion2bytes$1(r);case 445:return onion32bytes$1(r);case 466:return mb2bytes$1(r);default:return fromString$3(r,"base16")}}const decoders$1=Object.values(bases$2).map(e=>e.decoder),anybaseDecoder$1=function(){let e=decoders$1[0].or(decoders$1[1]);return decoders$1.slice(2).forEach(r=>e=e.or(r)),e}();function ip2bytes(e){if(!isIP(e))throw new Error("invalid ip address");return toBytes$1(e)}function bytes2ip(e){const r=toString$2(e,0,e.length);if(null==r)throw new Error("ipBuff is required");if(!isIP(r))throw new Error("invalid ip address");return r}function port2bytes$1(e){const r=new ArrayBuffer(2);return new DataView(r).setUint16(0,e),new Uint8Array(r)}function bytes2port$1(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function str2bytes(e){const r=fromString$3(e),t=Uint8Array.from(varint$1.encode(r.length));return concat$1([t,r],t.length+r.length)}function bytes2str(e){const r=varint$1.decode(e);if((e=e.slice(varint$1.decode.bytes)).length!==r)throw new Error("inconsistent lengths");return toString$3(e)}function mh2bytes(e){let r;r="Q"===e[0]||"1"===e[0]?decode$f(base58btc$2.decode(`z${e}`)).bytes:CID$1.parse(e).multihash.bytes;const t=Uint8Array.from(varint$1.encode(r.length));return concat$1([t,r],t.length+r.length)}function mb2bytes$1(e){const r=anybaseDecoder$1.decode(e),t=Uint8Array.from(varint$1.encode(r.length));return concat$1([t,r],t.length+r.length)}function bytes2mb$1(e){const r=varint$1.decode(e),t=e.slice(varint$1.decode.bytes);if(t.length!==r)throw new Error("inconsistent lengths");return"u"+toString$3(t,"base64url")}function bytes2mh(e){const r=varint$1.decode(e),t=e.slice(varint$1.decode.bytes);if(t.length!==r)throw new Error("inconsistent lengths");return toString$3(t,"base58btc")}function onion2bytes$1(e){const r=e.split(":");if(2!==r.length)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(16!==r[0].length)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion address.`);const t=base32$4.decode("b"+r[0]),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$1(n);return concat$1([t,o],t.length+o.length)}function onion32bytes$1(e){const r=e.split(":");if(2!==r.length)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(56!==r[0].length)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion3 address.`);const t=base32$4.decode(`b${r[0]}`),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$1(n);return concat$1([t,o],t.length+o.length)}function bytes2onion$1(e){const r=e.slice(0,e.length-2),t=e.slice(e.length-2);return`${toString$3(r,"base32")}:${bytes2port$1(t)}`}function stringToStringTuples(e){const r=[],t=e.split("/").slice(1);if(1===t.length&&""===t[0])return[];for(let n=0;n<t.length;n++){const o=t[n],i=getProtocol(o);if(0!==i.size){if(n++,n>=t.length)throw ParseError("invalid address: "+e);if(!0===i.path){r.push([o,cleanPath(t.slice(n).join("/"))]);break}r.push([o,t[n]])}else r.push([o])}return r}function stringTuplesToString(e){const r=[];return e.map(e=>{const t=protoFromTuple(e);return r.push(t.name),e.length>1&&null!=e[1]&&r.push(e[1]),null}),cleanPath(r.join("/"))}function stringTuplesToTuples(e){return e.map(e=>{Array.isArray(e)||(e=[e]);const r=protoFromTuple(e);return e.length>1?[r.code,convertToBytes(r.code,e[1])]:[r.code]})}function tuplesToStringTuples(e){return e.map(e=>{const r=protoFromTuple(e);return null!=e[1]?[r.code,convertToString(r.code,e[1])]:[r.code]})}function tuplesToBytes(e){return fromBytes(concat$1(e.map(e=>{const r=protoFromTuple(e);let t=Uint8Array.from(varint$1.encode(r.code));return e.length>1&&null!=e[1]&&(t=concat$1([t,e[1]])),t})))}function sizeForAddr$1(e,r){var t;return e.size>0?e.size/8:0===e.size?0:varint$1.decode(r)+(null!=(t=varint$1.decode.bytes)?t:0)}function bytesToTuples(e){var r;const t=[];let n=0;for(;n<e.length;){const o=varint$1.decode(e,n),i=null!=(r=varint$1.decode.bytes)?r:0,s=sizeForAddr$1(getProtocol(o),e.slice(n+i));if(0===s){t.push([o]),n+=i;continue}const a=e.slice(n+i,n+i+s);if(n+=s+i,n>e.length)throw ParseError("Invalid address Uint8Array: "+toString$3(e,"base16"));t.push([o,a])}return t}function bytesToString$1(e){return stringTuplesToString(tuplesToStringTuples(bytesToTuples(e)))}function stringToBytes$1(e){return tuplesToBytes(stringTuplesToTuples(stringToStringTuples(e=cleanPath(e))))}function fromString$2(e){return stringToBytes$1(e)}function fromBytes(e){const r=validateBytes(e);if(null!=r)throw r;return Uint8Array.from(e)}function validateBytes(e){try{bytesToTuples(e)}catch(r){return r}}function cleanPath(e){return"/"+e.trim().split("/").filter(e=>e).join("/")}function ParseError(e){return new Error("Error parsing address: "+e)}function protoFromTuple(e){return getProtocol(e[0])}var errCode$1,hasRequiredErrCode;function requireErrCode(){if(hasRequiredErrCode)return errCode$1;function e(e,r){for(const t in r)Object.defineProperty(e,t,{value:r[t],enumerable:!0,configurable:!0});return e}return hasRequiredErrCode=1,errCode$1=function(r,t,n){if(!r||"string"==typeof r)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof t&&(n=t,t=""),t&&(n.code=t);try{return e(r,n)}catch(o){n.message=r.message,n.stack=r.stack;const t=function(){};return t.prototype=Object.create(Object.getPrototypeOf(r)),e(new t,n)}}}var errCodeExports=requireErrCode();const errCode=getDefaultExportFromCjs(errCodeExports);function equals$3(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}var __classPrivateFieldGet=function(e,r,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof r?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(e):n?n.value:r.get(e)},__classPrivateFieldSet=function(e,r,t,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof r?e!==r||!o:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,t):o?o.value=t:r.set(e,t),t},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect$2=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$1=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],resolvers$1=new Map,symbol$2=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$1(e){return Boolean(null==e?void 0:e[symbol$2])}class DefaultMultiaddr{constructor(e){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=fromBytes(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=fromString$2(e)}else{if(!isMultiaddr$1(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=fromBytes(e.bytes)}}toString(){return null==__classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")&&__classPrivateFieldSet(this,_DefaultMultiaddr_string,bytesToString$1(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){let e,r,t,n,o="";const i=getProtocol("tcp"),s=getProtocol("udp"),a=getProtocol("ip4"),c=getProtocol("ip6"),u=getProtocol("dns6"),l=getProtocol("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(o=`%${null!=f?f:""}`),DNS_CODES$1.includes(d)&&(r=i.name,n=443,t=`${null!=f?f:""}${o}`,e=d===u.code?6:4),d!==i.code&&d!==s.code||(r=getProtocol(d).name,n=parseInt(null!=f?f:"")),d!==a.code&&d!==c.code||(r=getProtocol(d).name,t=`${null!=f?f:""}${o}`,e=d===c.code?6:4);if(null==e||null==r||null==t||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:t,transport:r,port:n}}protos(){return this.protoCodes().map(e=>Object.assign({},getProtocol(e)))}protoCodes(){var e;const r=[],t=this.bytes;let n=0;for(;n<t.length;){const o=varint$1.decode(t,n),i=null!=(e=varint$1.decode.bytes)?e:0;n+=sizeForAddr$1(getProtocol(o),t.slice(n+i))+i,r.push(o)}return r}protoNames(){return this.protos().map(e=>e.name)}tuples(){return null==__classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")&&__classPrivateFieldSet(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return null==__classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")&&__classPrivateFieldSet(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(e){return e=new DefaultMultiaddr(e),new DefaultMultiaddr(this.toString()+e.toString())}decapsulate(e){const r=e.toString(),t=this.toString(),n=t.lastIndexOf(r);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new DefaultMultiaddr(t.slice(0,n))}decapsulateCode(e){const r=this.tuples();for(let t=r.length-1;t>=0;t--)if(r[t][0]===e)return new DefaultMultiaddr(tuplesToBytes(r.slice(0,t)));return this}getPeerId(){try{const e=this.stringTuples().filter(e=>e[0]===names.ipfs.code).pop();if(null!=(null==e?void 0:e[1])){const r=e[1];return"Q"===r[0]||"1"===r[0]?toString$3(base58btc$2.decode(`z${r}`),"base58btc"):toString$3(CID$1.parse(r).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(e=>!0===getProtocol(e[0]).path)[0][1],null==e&&(e=null)}catch(r){e=null}return e}equals(e){return equals$3(this.bytes,e.bytes)}resolve(e){return __async(this,null,function*(){const r=this.protos().find(e=>e.resolvable);if(null==r)return[this];const t=resolvers$1.get(r.name);if(null==t)throw errCode(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(yield t(this,e)).map(e=>new DefaultMultiaddr(e))})}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const r=(null!=e?e:this).protos();return!(2!==r.length||4!==r[0].code&&41!==r[0].code||6!==r[1].code&&273!==r[1].code)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol$2,inspect$2)](){return`Multiaddr(${bytesToString$1(this.bytes)})`}}function multiaddr$1(e){return new DefaultMultiaddr(e)}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var isElectron_1,hasRequiredIsElectron,env,hasRequiredEnv;function requireIsElectron(){return hasRequiredIsElectron?isElectron_1:(hasRequiredIsElectron=1,isElectron_1=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0})}function requireEnv(){if(hasRequiredEnv)return env;hasRequiredEnv=1;const e=requireIsElectron(),r="object"==typeof window&&"object"==typeof document&&9===document.nodeType,t=e(),n=r&&!t,o=t&&!r,i=t&&r,s="function"==typeof commonjsRequire&&"undefined"!=typeof process&&void 0!==process.release&&"node"===process.release.name&&!t,a="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,c="undefined"!=typeof process&&!1,u="undefined"!=typeof navigator&&"ReactNative"===navigator.product;return env={isTest:c,isElectron:t,isElectronMain:o,isElectronRenderer:i,isNode:s,isBrowser:n,isWebWorker:a,isEnvWithDom:r,isReactNative:u}}var envExports=requireEnv();const unit=Object.create(null),m=6e4,h=60*m,d=24*h,y=365.25*d;unit.year=unit.yr=unit.y=y,unit.month=unit.mo=unit.mth=y/12,unit.week=unit.wk=unit.w=7*d,unit.day=unit.d=d,unit.hour=unit.hr=unit.h=h,unit.minute=unit.min=unit.m=m,unit.second=unit.sec=unit.s=1e3,unit.millisecond=unit.millisec=unit.ms=1,unit.microsecond=unit.microsec=unit.us=unit.s=.001,unit.nanosecond=unit.nanosec=unit.ns=1e-6,unit.group=",",unit.decimal=".",unit.placeholder=" _";const durationRE=/((?:\d{1,16}(?:\.\d{1,16})?|\.\d{1,16})(?:[eE][-+]?\d{1,4})?)\s?([\p{L}]{0,14})/gu;function parse(e="",r="ms"){let t,n=null;return String(e).replace(new RegExp(`(\\d)[${parse.unit.placeholder}${parse.unit.group}](\\d)`,"g"),"$1$2").replace(parse.unit.decimal,".").replace(durationRE,(e,o,i)=>{if(i)i=i.toLowerCase();else if(t){for(const r in parse.unit)if(parse.unit[r]<t){i=r;break}}else i=r;t=i=parse.unit[i]||parse.unit[i.replace(/s$/,"")],i&&(n=(n||0)+o*i)}),n&&n/(parse.unit[r]||1)*("-"===e[0]?-1:1)}parse.unit=unit;var browser$1={exports:{}},ms,hasRequiredMs,common,hasRequiredCommon,hasRequiredBrowser$1;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,r=60*e,t=60*r,n=24*t,o=7*n;function i(e,r,t,n){var o=r>=1.5*t;return Math.round(e/t)+" "+n+(o?"s":"")}return ms=function(s,a){a=a||{};var c,u,l=typeof s;if("string"===l&&s.length>0)return function(i){if(!((i=String(i)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(s){var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*n;case"hours":case"hour":case"hrs":case"hr":case"h":return a*t;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(s);if("number"===l&&isFinite(s))return a.long?(c=s,(u=Math.abs(c))>=n?i(c,u,n,"day"):u>=t?i(c,u,t,"hour"):u>=r?i(c,u,r,"minute"):u>=e?i(c,u,e,"second"):c+" ms"):function(o){var i=Math.abs(o);return i>=n?Math.round(o/n)+"d":i>=t?Math.round(o/t)+"h":i>=r?Math.round(o/r)+"m":i>=e?Math.round(o/e)+"s":o+"ms"}(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))}}function requireCommon(){return hasRequiredCommon?common:(hasRequiredCommon=1,common=function(e){function r(e){let n,o,i,s=null;function a(...e){if(!a.enabled)return;const t=a,o=Number(new Date),i=o-(n||o);t.diff=i,t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return"%";s++;const i=r.formatters[o];if("function"==typeof i){const r=e[s];n=i.call(t,r),e.splice(s,1),s--}return n}),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return a.namespace=e,a.useColors=r.useColors(),a.color=r.selectColor(e),a.extend=t,a.destroy=r.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==r.namespaces&&(o=r.namespaces,i=r.enabled(e)),i),set:e=>{s=e}}),"function"==typeof r.init&&r.init(a),a}function t(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function n(e,r){let t=0,n=0,o=-1,i=0;for(;t<e.length;)if(n<r.length&&(r[n]===e[t]||"*"===r[n]))"*"===r[n]?(o=n,i=t,n++):(t++,n++);else{if(-1===o)return!1;n=o+1,i++,t=i}for(;n<r.length&&"*"===r[n];)n++;return n===r.length}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names,...r.skips.map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){r.save(e),r.namespaces=e,r.names=[],r.skips=[];const t=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const n of t)"-"===n[0]?r.skips.push(n.slice(1)):r.names.push(n)},r.enabled=function(e){for(const t of r.skips)if(n(e,t))return!1;for(const t of r.names)if(n(e,t))return!0;return!1},r.humanize=requireMs(),r.destroy=function(){},Object.keys(e).forEach(t=>{r[t]=e[t]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return r.colors[Math.abs(t)%r.colors.length]},r.enable(r.load()),r})}function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(e,r){var t={};r.formatArgs=function(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;r.splice(1,0,t,"color: inherit");let n=0,o=0;r[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))}),r.splice(o,0,t)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(t){}},r.load=function(){let e;try{e=r.storage.getItem("debug")||r.storage.getItem("DEBUG")}catch(n){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=t.DEBUG),e},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0)}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),e.exports=requireCommon()(r);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}}(browser$1,browser$1.exports)),browser$1.exports}var browserExports=requireBrowser$1();const debug=getDefaultExportFromCjs(browserExports);function createDisabledLogger(e){const r=()=>{};return r.enabled=!1,r.color="",r.diff=0,r.log=()=>{},r.namespace=e,r.destroy=()=>!0,r.extend=()=>r,r}function logger(e){let r=createDisabledLogger(`${e}:trace`);return debug.enabled(`${e}:trace`)&&null!=debug.names.map(e=>e.toString()).find(e=>e.includes(":trace"))&&(r=debug(`${e}:trace`)),Object.assign(debug(e),{error:debug(`${e}:error`),trace:r})}debug.formatters.b=e=>null==e?"undefined":base58btc$2.baseEncode(e),debug.formatters.t=e=>null==e?"undefined":base32$4.baseEncode(e),debug.formatters.m=e=>null==e?"undefined":base64$5.baseEncode(e),debug.formatters.p=e=>null==e?"undefined":e.toString(),debug.formatters.c=e=>null==e?"undefined":e.toString(),debug.formatters.k=e=>null==e?"undefined":e.toString(),debug.formatters.a=e=>null==e?"undefined":e.toString();var error={},hasRequiredError;function requireError(){if(hasRequiredError)return error;hasRequiredError=1;class e extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}error.TimeoutError=e;class r extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}error.AbortError=r;class t extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}return error.HTTPError=t,error}var src$1={exports:{}},browser={exports:{}},hasRequiredBrowser,hasRequiredSrc,fetch_browser$1,hasRequiredFetch_browser$1,fetch_browser,hasRequiredFetch_browser,isPlainObj,hasRequiredIsPlainObj,mergeOptions$1,hasRequiredMergeOptions,urlBrowser,hasRequiredUrlBrowser,relative,hasRequiredRelative,isoUrl,hasRequiredIsoUrl;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,e=browser,r=browser.exports,t=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==commonjsGlobal)return commonjsGlobal;throw new Error("unable to locate global object")}(),e.exports=r=t.fetch,t.fetch&&(r.default=t.fetch.bind(t)),r.Headers=t.Headers,r.Request=t.Request,r.Response=t.Response),browser.exports;var e,r,t}function requireSrc(){return hasRequiredSrc||(hasRequiredSrc=1,globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$1.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$1.exports={default:requireBrowser().default,Headers:requireBrowser().Headers,Request:requireBrowser().Request,Response:requireBrowser().Response}),src$1.exports}function requireFetch_browser$1(){return hasRequiredFetch_browser$1?fetch_browser$1:(hasRequiredFetch_browser$1=1,fetch_browser$1=requireSrc())}function requireFetch_browser(){if(hasRequiredFetch_browser)return fetch_browser;hasRequiredFetch_browser=1;const{TimeoutError:e,AbortError:r}=requireError(),{Response:t,Request:n,Headers:o,default:i}=requireFetch_browser$1(),s=i,a=e=>{const r=new o;for(const t of e.trim().split(/[\r\n]+/)){const e=t.indexOf(": ");e>0&&r.set(t.slice(0,e),t.slice(e+1))}return r};class c extends t{constructor(e,r,t){super(r,t),Object.defineProperty(this,"url",{value:e})}}return fetch_browser={fetch:(n,i={})=>null!=i.onUploadProgress?((n,i={})=>{const s=new XMLHttpRequest;s.open(i.method||"GET",n.toString(),!0);const{timeout:u,headers:l}=i;if(u&&u>0&&u<1/0&&(s.timeout=u),null!=i.overrideMimeType&&s.overrideMimeType(i.overrideMimeType),l)for(const[e,r]of new o(l))s.setRequestHeader(e,r);return i.signal&&(i.signal.onabort=()=>s.abort()),i.onUploadProgress&&(s.upload.onprogress=i.onUploadProgress),s.responseType="arraybuffer",new Promise((n,o)=>{const u=i=>{switch(i.type){case"error":n(t.error());break;case"load":n(new c(s.responseURL,s.response,{status:s.status,statusText:s.statusText,headers:a(s.getAllResponseHeaders())}));break;case"timeout":o(new e);break;case"abort":o(new r)}};s.onerror=u,s.onload=u,s.ontimeout=u,s.onabort=u,s.send(i.body)})})(n,i):s(n,i),Request:n,Headers:o}}function requireIsPlainObj(){return hasRequiredIsPlainObj?isPlainObj:(hasRequiredIsPlainObj=1,isPlainObj=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const r=Object.getPrototypeOf(e);return null===r||r===Object.prototype})}function requireMergeOptions(){if(hasRequiredMergeOptions)return mergeOptions$1;hasRequiredMergeOptions=1;const e=requireIsPlainObj(),{hasOwnProperty:r}=Object.prototype,{propertyIsEnumerable:t}=Object,n=(e,r,t)=>Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0}),o=mergeOptions$1,i={concatArrays:!1,ignoreUndefined:!1},s=e=>{const n=[];for(const t in e)r.call(e,t)&&n.push(t);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const o of r)t.call(e,o)&&n.push(o)}return n};function a(r){return Array.isArray(r)?function(e){const r=e.slice(0,0);return s(e).forEach(t=>{n(r,t,a(e[t]))}),r}(r):e(r)?function(e){const r=null===Object.getPrototypeOf(e)?Object.create(null):{};return s(e).forEach(t=>{n(r,t,a(e[t]))}),r}(r):r}const c=(e,r,t,o)=>(t.forEach(t=>{void 0===r[t]&&o.ignoreUndefined||(t in e&&e[t]!==Object.getPrototypeOf(e)?n(e,t,l(e[t],r[t],o)):n(e,t,a(r[t])))}),e),u=(e,t,o)=>{let i=e.slice(0,0),u=0;return[e,t].forEach(t=>{const l=[];for(let o=0;o<t.length;o++)r.call(t,o)&&(l.push(String(o)),n(i,u++,t===e?t[o]:a(t[o])));i=c(i,t,s(t).filter(e=>!l.includes(e)),o)}),i};function l(r,t,n){return n.concatArrays&&Array.isArray(r)&&Array.isArray(t)?u(r,t,n):e(t)&&e(r)?c(r,t,s(t),n):a(t)}return mergeOptions$1=function(...r){const t=l(a(i),this!==o&&this||{},i);let n={_:{}};for(const o of r)if(void 0!==o){if(!e(o))throw new TypeError("`"+o+"` is not an Option Object");n=l(n,{_:o},t)}return n._}}function requireUrlBrowser(){if(hasRequiredUrlBrowser)return urlBrowser;hasRequiredUrlBrowser=1;const e="undefined"!=typeof navigator&&"ReactNative"===navigator.product,r=self.URL,t=e?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:"";return urlBrowser={URLWithLegacySupport:class{constructor(e="",n=t){this.super=new r(e,n),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return r.createObjectURL(e)}static revokeObjectURL(e){r.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:t,format:function(e){if("string"==typeof e)return new r(e).toString();if(!(e instanceof r)){const r=e.username&&e.password?`${e.username}:${e.password}@`:"",t=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",o=e.protocol?e.protocol+"//":"",i=e.host||"",s=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",u=e.pathname||"";return`${o}${r||t}${i||s+n}${e.path||u+a}${c}`}}}}function requireRelative(){if(hasRequiredRelative)return relative;hasRequiredRelative=1;const{URLWithLegacySupport:e,format:r}=requireUrlBrowser();return relative=(t,n={},o={},i)=>{let s,a=n.protocol?n.protocol.replace(":",""):"http";a=(o[a]||i||a)+":";try{s=new e(t)}catch(u){s={}}const c=Object.assign({},n,{protocol:a||s.protocol,host:n.host||s.host});return new e(t,r(c)).toString()}}function requireIsoUrl(){if(hasRequiredIsoUrl)return isoUrl;hasRequiredIsoUrl=1;const{URLWithLegacySupport:e,format:r,URLSearchParams:t,defaultBase:n}=requireUrlBrowser(),o=requireRelative();return isoUrl={URL:e,URLSearchParams:t,format:r,relative:o,defaultBase:n}}var anySignal={exports:{}},hasRequiredAnySignal,browserReadablestreamToIt,hasRequiredBrowserReadablestreamToIt,itAll,hasRequiredItAll,http,hasRequiredHttp;function requireAnySignal(){if(hasRequiredAnySignal)return anySignal.exports;function e(e){const r=new globalThis.AbortController;function t(){r.abort();for(const r of e)r&&r.removeEventListener&&r.removeEventListener("abort",t)}for(const n of e)if(n&&n.addEventListener){if(n.aborted){t();break}n.addEventListener("abort",t)}return r.signal}return hasRequiredAnySignal=1,anySignal.exports=e,anySignal.exports.anySignal=e,anySignal.exports}function requireBrowserReadablestreamToIt(){return hasRequiredBrowserReadablestreamToIt||(hasRequiredBrowserReadablestreamToIt=1,browserReadablestreamToIt=function(e){return __asyncGenerator(this,arguments,function*(e,r={}){const t=e.getReader();try{for(;;){const e=yield new __await(t.read());if(e.done)return;yield e.value}}finally{!0!==r.preventCancel&&t.cancel(),t.releaseLock()}})}),browserReadablestreamToIt}function requireItAll(){return hasRequiredItAll?itAll:(hasRequiredItAll=1,itAll=e=>__async(null,null,function*(){const r=[];try{for(var t,n,o,i=__forAwait(e);t=!(n=yield i.next()).done;t=!1){const e=n.value;r.push(e)}}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield n.call(i))}finally{if(o)throw o[0]}}return r}))}function requireHttp(){if(hasRequiredHttp)return http;hasRequiredHttp=1;const{fetch:e,Request:r,Headers:t}=requireFetch_browser(),{TimeoutError:n,HTTPError:o}=requireError(),i=requireMergeOptions().bind({ignoreUndefined:!0}),{URL:s,URLSearchParams:a}=requireIsoUrl(),c=requireAnySignal(),u=requireBrowserReadablestreamToIt(),{isBrowser:l,isWebWorker:d}=requireEnv(),f=requireItAll(),h={throwHttpErrors:!0,credentials:"same-origin"};class p{constructor(e={}){this.opts=i(h,e)}fetch(h){return __async(this,arguments,function*(h,p={}){const m=i(this.opts,p),g=new t(m.headers);if("string"!=typeof h&&!(h instanceof s||h instanceof r))throw new TypeError("`resource` must be a string, URL, or Request");const _=new s(h.toString(),m.base),{searchParams:w,transformSearchParams:$,json:v}=m;w&&(_.search="function"==typeof $?$(new a(m.searchParams)):new a(m.searchParams)),v&&(m.body=JSON.stringify(m.json),g.set("content-type","application/json"));const E=new AbortController,S=c([E.signal,m.signal]);null!=globalThis.ReadableStream&&m.body instanceof globalThis.ReadableStream&&(l||d)&&(m.body=new Blob(yield f(u(m.body))));const T=yield((e,r,t)=>{if(void 0===r)return e;const o=Date.now(),i=()=>Date.now()-o>=r;return new Promise((o,s)=>{const a=setTimeout(()=>{i()&&(s(new n),t.abort())},r),c=e=>r=>{clearTimeout(a),i()?s(new n):e(r)};e.then(c(o),c(s))})})(e(_.toString(),__spreadProps(__spreadValues({},m),{signal:S,timeout:void 0,headers:g,duplex:"half"})),m.timeout,E);if(!T.ok&&m.throwHttpErrors)throw m.handleError&&(yield m.handleError(T)),new o(T);return T.iterator=function(){return __asyncGenerator(this,null,function*(){yield*__yieldStar(b(T.body))})},T.ndjson=function(){return __asyncGenerator(this,null,function*(){try{for(var e,r,t,n=__forAwait(y(T.iterator()));e=!(r=yield new __await(n.next())).done;e=!1){const e=r.value;p.transform?yield p.transform(e):yield e}}catch(r){t=[r]}finally{try{e&&(r=n.return)&&(yield new __await(r.call(n)))}finally{if(t)throw t[0]}}})},T})}post(e,r={}){return this.fetch(e,__spreadProps(__spreadValues({},r),{method:"POST"}))}get(e,r={}){return this.fetch(e,__spreadProps(__spreadValues({},r),{method:"GET"}))}put(e,r={}){return this.fetch(e,__spreadProps(__spreadValues({},r),{method:"PUT"}))}delete(e,r={}){return this.fetch(e,__spreadProps(__spreadValues({},r),{method:"DELETE"}))}options(e,r={}){return this.fetch(e,__spreadProps(__spreadValues({},r),{method:"OPTIONS"}))}}const y=function(e){return __asyncGenerator(this,null,function*(){const r=new TextDecoder;let t="";try{for(var n,o,i,s=__forAwait(e);n=!(o=yield new __await(s.next())).done;n=!1){const e=o.value;t+=r.decode(e,{stream:!0});const n=t.split(/\r?\n/);for(let r=0;r<n.length-1;r++){const e=n[r].trim();e.length>0&&(yield JSON.parse(e))}t=n[n.length-1]}}catch(o){i=[o]}finally{try{n&&(o=s.return)&&(yield new __await(o.call(s)))}finally{if(i)throw i[0]}}t+=r.decode(),t=t.trim(),0!==t.length&&(yield JSON.parse(t))})},b=e=>{if(m(e))return e;if(_(e)){const r=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:r.next.bind(r),return:t=>(e.destroy(),"function"==typeof r.return?r.return():Promise.resolve({done:!0,value:t}))})}}if(g(e)){const r=e.getReader();return function(){return __asyncGenerator(this,null,function*(){try{for(;;){const{done:e,value:t}=yield new __await(r.read());if(e)return;t&&(yield t)}}finally{r.releaseLock()}})}()}throw new TypeError("Body can't be converted to AsyncIterable")},m=e=>"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.asyncIterator],g=e=>e&&"function"==typeof e.getReader,_=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");return p.HTTPError=o,p.TimeoutError=n,p.streamToAsyncIterator=b,p.post=(e,r)=>new p(r).post(e,r),p.get=(e,r)=>new p(r).get(e,r),p.put=(e,r)=>new p(r).put(e,r),p.delete=(e,r)=>new p(r).delete(e,r),p.options=(e,r)=>new p(r).options(e,r),http=p}var httpExports=requireHttp();const HTTP=getDefaultExportFromCjs(httpExports);var mergeOptionsExports=requireMergeOptions();const mergeOptions=getDefaultExportFromCjs(mergeOptionsExports);function equals$2(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function coerce(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$1(e){return(new TextEncoder).encode(e)}function toString$1(e){return(new TextDecoder).decode(e)}function base(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===c;)n++,r++;for(var i=(e.length-r)*u+1>>>0,s=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=i-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}if(" "!==e[r]){for(var h=i-o;h!==i&&0===s[h];)h++;for(var p=new Uint8Array(n+(i-h)),y=n;h!==i;)p[y++]=s[h++];return p}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var t=0,n=0,o=0,i=r.length;o!==i&&0===r[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var d=r[o],f=0,h=s-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*u[h]>>>0,u[h]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,o++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var y=c.repeat(t);p<s;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error(`Non-${r} character`)}}}var src=base,_brrp__multiformats_scope_baseX=src;class Encoder{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(e,r,t){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseDecode"),__publicField(this,"prefixCodePoint"),this.name=e,this.prefix=r;const n=r.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=t}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or(this,e)}}class ComposedDecoder{constructor(e){__publicField(this,"decoders"),this.decoders=e}or(e){return or(this,e)}decode(e){const r=e[0],t=this.decoders[r];if(null!=t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or(e,r){var t,n;return new ComposedDecoder(__spreadValues(__spreadValues({},null!=(t=e.decoders)?t:{[e.prefix]:e}),null!=(n=r.decoders)?n:{[r.prefix]:r}))}class Codec{constructor(e,r,t,n){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),__publicField(this,"baseDecode"),__publicField(this,"encoder"),__publicField(this,"decoder"),this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=n,this.encoder=new Encoder(e,r,t),this.decoder=new Decoder(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function from({name:e,prefix:r,encode:t,decode:n}){return new Codec(e,r,t,n)}function baseX({name:e,prefix:r,alphabet:t}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX(t,e);return from({prefix:r,name:e,encode:n,decode:e=>coerce(o(e))})}function decode$5(e,r,t,n){let o=e.length;for(;"="===e[o-1];)--o;const i=new Uint8Array(o*t/8|0);let s=0,a=0,c=0;for(let u=0;u<o;++u){const o=r[e[u]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);a=a<<t|o,s+=t,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=t||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return i}function encode$2(e,r,t){const n="="===r[r.length-1],o=(1<<t)-1;let i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>t;)s-=t,i+=r[o&a>>s];if(0!==s&&(i+=r[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i}function createAlphabetIdx(e){const r={};for(let t=0;t<e.length;++t)r[e[t]]=t;return r}function rfc4648({name:e,prefix:r,bitsPerChar:t,alphabet:n}){const o=createAlphabetIdx(n);return from({prefix:r,name:e,encode:e=>encode$2(e,n,t),decode:r=>decode$5(r,o,t,e)})}const base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10:base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16:base16,base16upper:base16upper},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2:base2},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from(""),alphabetBytesToChars=alphabet.reduce((e,r,t)=>(e[t]=r,e),[]),alphabetCharsToBytes=alphabet.reduce((e,r,t)=>{const n=r.codePointAt(0);if(null==n)throw new Error(`Invalid character: ${r}`);return e[n]=t,e},[]);function encode$1(e){return e.reduce((e,r)=>e+alphabetBytesToChars[r],"")}function decode$4(e){const r=[];for(const t of e){const e=t.codePointAt(0);if(null==e)throw new Error(`Invalid character: ${t}`);const n=alphabetCharsToBytes[e];if(null==n)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const base256emoji=from({prefix:"",name:"base256emoji",encode:encode$1,decode:decode$4}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32:base32,base32hex:base32hex,base32hexpad:base32hexpad,base32hexpadupper:base32hexpadupper,base32hexupper:base32hexupper,base32pad:base32pad,base32padupper:base32padupper,base32upper:base32upper,base32z:base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36:base36,base36upper:base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc,base58flickr:base58flickr},Symbol.toStringTag,{value:"Module"})),base64$1=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$2=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$1,base64pad:base64pad,base64url:base64url,base64urlpad:base64urlpad},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8:base8},Symbol.toStringTag,{value:"Module"})),identity=from({prefix:"\0",name:"identity",encode:e=>toString$1(e),decode:e=>fromString$1(e)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;var encode_1=encode,MSB$1=128,MSBALL=-128,INT=Math.pow(2,31);function encode(e,r,t){r=r||[];for(var n=t=t||0;e>=INT;)r[t++]=255&e|MSB$1,e/=128;for(;e&MSBALL;)r[t++]=255&e|MSB$1,e>>>=7;return r[t]=0|e,encode.bytes=t-n+1,r}var decode$3=read,MSB$1$1=128,REST$1=127;function read(e,r){var t,n=0,o=0,i=r=r||0,s=e.length;do{if(i>=s)throw read.bytes=0,new RangeError("Could not decode varint");t=e[i++],n+=o<28?(t&REST$1)<<o:(t&REST$1)*Math.pow(2,o),o+=7}while(t>=MSB$1$1);return read.bytes=i-r,n}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(e){return e<N1$1?1:e<N2$1?2:e<N3$1?3:e<N4$1?4:e<N5$1?5:e<N6$1?6:e<N7$1?7:e<N8?8:e<N9?9:10},varint={encode:encode_1,decode:decode$3,encodingLength:length},_brrp_varint=varint;function decode$2(e,r=0){return[_brrp_varint.decode(e,r),_brrp_varint.decode.bytes]}function encodeTo(e,r,t=0){return _brrp_varint.encode(e,r,t),r}function encodingLength$1(e){return _brrp_varint.encodingLength(e)}function create$1(e,r){const t=r.byteLength,n=encodingLength$1(e),o=n+encodingLength$1(t),i=new Uint8Array(o+t);return encodeTo(e,i,0),encodeTo(t,i,n),i.set(r,o),new Digest(e,t,r,i)}function decode$1(e){const r=coerce(e),[t,n]=decode$2(r),[o,i]=decode$2(r.subarray(n)),s=r.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Digest(t,o,s,r)}function equals$1(e,r){if(e===r)return!0;{const t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&equals$2(e.bytes,t.bytes)}}class Digest{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"size"),__publicField(this,"digest"),__publicField(this,"bytes"),this.code=e,this.size=r,this.digest=t,this.bytes=n}}function format(e,r){const{bytes:t,version:n}=e;return 0===n?toStringV0(t,baseCache(e),null!=r?r:base58btc.encoder):toStringV1(t,baseCache(e),null!=r?r:base32.encoder)}const cache=new WeakMap;function baseCache(e){const r=cache.get(e);if(null==r){const r=new Map;return cache.set(e,r),r}return r}class CID{constructor(e,r,t,n){__publicField(this,"code"),__publicField(this,"version"),__publicField(this,"multihash"),__publicField(this,"bytes"),__publicField(this,"/"),__publicField(this,_d,"CID"),this.code=r,this.version=e,this.multihash=t,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:r}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:r}=this.multihash,t=create$1(e,r);return CID.createV1(this.code,t)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return CID.equals(this,e)}static equals(e,r){const t=r;return null!=t&&e.code===t.code&&e.version===t.version&&equals$1(e.multihash,t.multihash)}toString(e){return format(this,e)}toJSON(){return{"/":format(this)}}link(){return this}[(_d=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const r=e;if(r instanceof CID)return r;if(null!=r["/"]&&r["/"]===r.bytes||r.asCID===r){const{version:e,code:t,multihash:n,bytes:o}=r;return new CID(e,t,n,null!=o?o:encodeCID$1(e,t,n.bytes))}if(!0===r[cidSymbol]){const{version:e,multihash:t,code:n}=r,o=decode$1(t);return CID.create(e,n,o)}return null}static create(e,r,t){if("number"!=typeof r)throw new Error("String codecs are no longer supported");if(!(t.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(r!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(e,r,t,t.bytes);case 1:{const n=encodeCID$1(e,r,t.bytes);return new CID(e,r,t,n)}default:throw new Error("Invalid version")}}static createV0(e){return CID.create(0,DAG_PB_CODE,e)}static createV1(e,r){return CID.create(1,e,r)}static decode(e){const[r,t]=CID.decodeFirst(e);if(0!==t.length)throw new Error("Incorrect length");return r}static decodeFirst(e){const r=CID.inspectBytes(e),t=r.size-r.multihashSize,n=coerce(e.subarray(t,t+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");const o=n.subarray(r.multihashSize-r.digestSize),i=new Digest(r.multihashCode,r.digestSize,o,n);return[0===r.version?CID.createV0(i):CID.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0;const t=()=>{const[t,n]=decode$2(e.subarray(r));return r+=n,t};let n=t(),o=DAG_PB_CODE;if(18===n?(n=0,r=0):o=t(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=r,s=t(),a=t(),c=r+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(e,r){const[t,n]=parseCIDtoBytes(e,r),o=CID.decode(n);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache(o).set(t,e),o}}function parseCIDtoBytes(e,r){switch(e[0]){case"Q":{const t=null!=r?r:base58btc;return[base58btc.prefix,t.decode(`${base58btc.prefix}${e}`)]}case base58btc.prefix:{const t=null!=r?r:base58btc;return[base58btc.prefix,t.decode(e)]}case base32.prefix:{const t=null!=r?r:base32;return[base32.prefix,t.decode(e)]}case base36.prefix:{const t=null!=r?r:base36;return[base36.prefix,t.decode(e)]}default:if(null==r)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}function toStringV0(e,r,t){const{prefix:n}=t;if(n!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=r.get(n);if(null==o){const o=t.encode(e).slice(1);return r.set(n,o),o}return o}function toStringV1(e,r,t){const{prefix:n}=t,o=r.get(n);if(null==o){const o=t.encode(e);return r.set(n,o),o}return o}const DAG_PB_CODE=112,SHA_256_CODE=18;function encodeCID$1(e,r,t){const n=encodingLength$1(e),o=n+encodingLength$1(r),i=new Uint8Array(o+t.byteLength);return encodeTo(e,i,0),encodeTo(r,i,n),i.set(t,o),i}const cidSymbol=Symbol.for("@ipld/js-cid/CID"),bases=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},identityBase),base2$1),base8$1),base10$1),base16$1),base32$1),base36$1),base58),base64$2),base256emoji$1);function allocUnsafe(e=0){return new Uint8Array(e)}function createCodec(e,r,t,n){return{name:e,prefix:r,encoder:{name:e,prefix:r,encode:t},decoder:{decode:n}}}const string=createCodec("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),ascii=createCodec("ascii","a",e=>{let r="a";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e=>{const r=allocUnsafe((e=e.substring(1)).length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}),BASES=__spreadValues({utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii:ascii,binary:ascii},bases);function toString(e,r="utf8"){const t=BASES[r];if(null==t)throw new Error(`Unsupported encoding "${r}"`);return t.encoder.encode(e).substring(1)}class InvalidMultiaddrError extends Error{constructor(){super(...arguments),__publicField(this,"name","InvalidMultiaddrError")}}__publicField(InvalidMultiaddrError,"name","InvalidMultiaddrError");class ValidationError extends Error{constructor(){super(...arguments),__publicField(this,"name","ValidationError")}}__publicField(ValidationError,"name","ValidationError");class InvalidParametersError extends Error{constructor(){super(...arguments),__publicField(this,"name","InvalidParametersError")}}__publicField(InvalidParametersError,"name","InvalidParametersError");class UnknownProtocolError extends Error{constructor(){super(...arguments),__publicField(this,"name","UnknownProtocolError")}}function equals(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function fromString(e,r="utf8"){const t=BASES[r];if(null==t)throw new Error(`Unsupported encoding "${r}"`);return t.decoder.decode(`${t.prefix}${e}`)}__publicField(UnknownProtocolError,"name","UnknownProtocolError");const N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),MSB=128,REST=127;function encodingLength(e){if(e<N1)return 1;if(e<N2)return 2;if(e<N3)return 3;if(e<N4)return 4;if(e<N5)return 5;if(e<N6)return 6;if(e<N7)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(e,r,t=0){switch(encodingLength(e)){case 8:r[t++]=255&e|MSB,e/=128;case 7:r[t++]=255&e|MSB,e/=128;case 6:r[t++]=255&e|MSB,e/=128;case 5:r[t++]=255&e|MSB,e/=128;case 4:r[t++]=255&e|MSB,e>>>=7;case 3:r[t++]=255&e|MSB,e>>>=7;case 2:r[t++]=255&e|MSB,e>>>=7;case 1:r[t++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return r}function decodeUint8Array(e,r){let t=e[r],n=0;if(n+=t&REST,t<MSB)return n;if(t=e[r+1],n+=(t&REST)<<7,t<MSB)return n;if(t=e[r+2],n+=(t&REST)<<14,t<MSB)return n;if(t=e[r+3],n+=(t&REST)<<21,t<MSB)return n;if(t=e[r+4],n+=(t&REST)*N4,t<MSB)return n;if(t=e[r+5],n+=(t&REST)*N5,t<MSB)return n;if(t=e[r+6],n+=(t&REST)*N6,t<MSB)return n;if(t=e[r+7],n+=(t&REST)*N7,t<MSB)return n;throw new RangeError("Could not decode varint")}function decodeUint8ArrayList(e,r){let t=e.get(r),n=0;if(n+=t&REST,t<MSB)return n;if(t=e.get(r+1),n+=(t&REST)<<7,t<MSB)return n;if(t=e.get(r+2),n+=(t&REST)<<14,t<MSB)return n;if(t=e.get(r+3),n+=(t&REST)<<21,t<MSB)return n;if(t=e.get(r+4),n+=(t&REST)*N4,t<MSB)return n;if(t=e.get(r+5),n+=(t&REST)*N5,t<MSB)return n;if(t=e.get(r+6),n+=(t&REST)*N6,t<MSB)return n;if(t=e.get(r+7),n+=(t&REST)*N7,t<MSB)return n;throw new RangeError("Could not decode varint")}function decode(e,r=0){return e instanceof Uint8Array?decodeUint8Array(e,r):decodeUint8ArrayList(e,r)}function asUint8Array(e){return e}function concat(e,r){null==r&&(r=e.reduce((e,r)=>e+r.length,0));const t=allocUnsafe(r);let n=0;for(const o of e)t.set(o,n),n+=o.length;return asUint8Array(t)}const CODE_IP4=4,CODE_TCP=6,CODE_UDP=273,CODE_DCCP=33,CODE_IP6=41,CODE_IP6ZONE=42,CODE_IPCIDR=43,CODE_DNS=53,CODE_DNS4=54,CODE_DNS6=55,CODE_DNSADDR=56,CODE_SCTP=132,CODE_UDT=301,CODE_UTP=302,CODE_UNIX=400,CODE_P2P=421,CODE_ONION=444,CODE_ONION3=445,CODE_GARLIC64=446,CODE_GARLIC32=447,CODE_TLS=448,CODE_SNI=449,CODE_NOISE=454,CODE_QUIC=460,CODE_QUIC_V1=461,CODE_WEBTRANSPORT=465,CODE_CERTHASH=466,CODE_HTTP=480,CODE_HTTP_PATH=481,CODE_HTTPS=443,CODE_WS=477,CODE_WSS=478,CODE_P2P_WEBSOCKET_STAR=479,CODE_P2P_STARDUST=277,CODE_P2P_WEBRTC_STAR=275,CODE_P2P_WEBRTC_DIRECT=276,CODE_WEBRTC_DIRECT=280,CODE_WEBRTC=281,CODE_P2P_CIRCUIT=290,CODE_MEMORY=777;function bytesToString(e){return r=>toString(r,e)}function stringToBytes(e){return r=>fromString(r,e)}function bytes2port(e){return new DataView(e.buffer).getUint16(e.byteOffset).toString()}function port2bytes(e){const r=new ArrayBuffer(2);return new DataView(r).setUint16(0,"string"==typeof e?parseInt(e):e),new Uint8Array(r)}function onion2bytes(e){const r=e.split(":");if(2!==r.length)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(16!==r[0].length)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion address.`);const t=fromString(r[0],"base32"),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(n);return concat([t,o],t.length+o.length)}function onion32bytes(e){const r=e.split(":");if(2!==r.length)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(56!==r[0].length)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion3 address.`);const t=base32.decode(`b${r[0]}`),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(n);return concat([t,o],t.length+o.length)}function bytes2onion(e){const r=e.subarray(0,e.length-2),t=e.subarray(e.length-2);return`${toString(r,"base32")}:${bytes2port(t)}`}const ip4ToBytes=function(e){e=e.toString().trim();const r=new Uint8Array(4);return e.split(/\./g).forEach((e,t)=>{const n=parseInt(e,10);if(isNaN(n)||n<0||n>255)throw new InvalidMultiaddrError("Invalid byte value in IP address");r[t]=n}),r},ip6ToBytes=function(e){let r=0;const t=(e=e.toString().trim()).split(":",8);let n;for(n=0;n<t.length;n++){let e;isIPv4(t[n])&&(e=ip4ToBytes(t[n]),t[n]=toString(e.subarray(0,2),"base16")),null!=e&&++n<8&&t.splice(n,0,toString(e.subarray(2,4),"base16"))}if(""===t[0])for(;t.length<8;)t.unshift("0");else if(""===t[t.length-1])for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&""!==t[n];n++);const e=[n,1];for(n=9-t.length;n>0;n--)e.push("0");t.splice.apply(t,e)}const o=new Uint8Array(r+16);for(n=0;n<t.length;n++){""===t[n]&&(t[n]="0");const e=parseInt(t[n],16);if(isNaN(e)||e<0||e>65535)throw new InvalidMultiaddrError("Invalid byte value in IP address");o[r++]=e>>8&255,o[r++]=255&e}return o},ip4ToString=function(e){if(4!==e.byteLength)throw new InvalidMultiaddrError("IPv4 address was incorrect length");const r=[];for(let t=0;t<e.byteLength;t++)r.push(e[t]);return r.join(".")},ip6ToString=function(e){if(16!==e.byteLength)throw new InvalidMultiaddrError("IPv6 address was incorrect length");const r=[];for(let o=0;o<e.byteLength;o+=2){const t=e[o],n=e[o+1],i=`${t.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}`;r.push(i)}const t=r.join(":");try{const e=new URL(`http://[${t}]`);return e.hostname.substring(1,e.hostname.length-1)}catch(n){throw new InvalidMultiaddrError(`Invalid IPv6 address "${t}"`)}};function ip6StringToValue(e){try{const r=new URL(`http://[${e}]`);return r.hostname.substring(1,r.hostname.length-1)}catch(r){throw new InvalidMultiaddrError(`Invalid IPv6 address "${e}"`)}}const decoders=Object.values(bases).map(e=>e.decoder),anybaseDecoder=function(){let e=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(r=>e=e.or(r)),e}();function mb2bytes(e){return anybaseDecoder.decode(e)}function bytes2mb(e){return r=>e.encoder.encode(r)}function integer(e){if(parseInt(e).toString()!==e)throw new ValidationError("Value must be an integer")}function positive(e){if(e<0)throw new ValidationError("Value must be a positive integer, or zero")}function maxValue(e){return r=>{if(r>e)throw new ValidationError(`Value must be smaller than or equal to ${e}`)}}function validate$1(...e){return r=>{for(const t of e)t(r)}}const validatePort=validate$1(integer,positive,maxValue(65535)),V=-1;class Registry{constructor(){__publicField(this,"protocolsByCode",new Map),__publicField(this,"protocolsByName",new Map)}getProtocol(e){let r;if(r="string"==typeof e?this.protocolsByName.get(e):this.protocolsByCode.get(e),null==r)throw new UnknownProtocolError(`Protocol ${e} was unknown`);return r}addProtocol(e){var r;this.protocolsByCode.set(e.code,e),this.protocolsByName.set(e.name,e),null==(r=e.aliases)||r.forEach(r=>{this.protocolsByName.set(r,e)})}removeProtocol(e){var r;const t=this.protocolsByCode.get(e);null!=t&&(this.protocolsByCode.delete(t.code),this.protocolsByName.delete(t.name),null==(r=t.aliases)||r.forEach(e=>{this.protocolsByName.delete(e)}))}}const registry=new Registry,codecs=[{code:CODE_IP4,name:"ip4",size:32,valueToBytes:ip4ToBytes,bytesToValue:ip4ToString,validate:e=>{if(!isIPv4(e))throw new ValidationError(`Invalid IPv4 address "${e}"`)}},{code:CODE_TCP,name:"tcp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDP,name:"udp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_DCCP,name:"dccp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_IP6,name:"ip6",size:128,valueToBytes:ip6ToBytes,bytesToValue:ip6ToString,stringToValue:ip6StringToValue,validate:e=>{if(!isIPv6(e))throw new ValidationError(`Invalid IPv6 address "${e}"`)}},{code:CODE_IP6ZONE,name:"ip6zone",size:V},{code:CODE_IPCIDR,name:"ipcidr",size:8,bytesToValue:bytesToString("base10"),valueToBytes:stringToBytes("base10")},{code:CODE_DNS,name:"dns",size:V,resolvable:!0},{code:CODE_DNS4,name:"dns4",size:V,resolvable:!0},{code:CODE_DNS6,name:"dns6",size:V,resolvable:!0},{code:CODE_DNSADDR,name:"dnsaddr",size:V,resolvable:!0},{code:CODE_SCTP,name:"sctp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDT,name:"udt"},{code:CODE_UTP,name:"utp"},{code:CODE_UNIX,name:"unix",size:V,path:!0,stringToValue:e=>decodeURIComponent(e),valueToString:e=>encodeURIComponent(e)},{code:CODE_P2P,name:"p2p",aliases:["ipfs"],size:V,bytesToValue:bytesToString("base58btc"),valueToBytes:e=>e.startsWith("Q")||e.startsWith("1")?stringToBytes("base58btc")(e):CID.parse(e).multihash.bytes},{code:CODE_ONION,name:"onion",size:96,bytesToValue:bytes2onion,valueToBytes:onion2bytes},{code:CODE_ONION3,name:"onion3",size:296,bytesToValue:bytes2onion,valueToBytes:onion32bytes},{code:CODE_GARLIC64,name:"garlic64",size:V},{code:CODE_GARLIC32,name:"garlic32",size:V},{code:CODE_TLS,name:"tls"},{code:CODE_SNI,name:"sni",size:V},{code:CODE_NOISE,name:"noise"},{code:CODE_QUIC,name:"quic"},{code:CODE_QUIC_V1,name:"quic-v1"},{code:CODE_WEBTRANSPORT,name:"webtransport"},{code:CODE_CERTHASH,name:"certhash",size:V,bytesToValue:bytes2mb(base64url),valueToBytes:mb2bytes},{code:CODE_HTTP,name:"http"},{code:CODE_HTTP_PATH,name:"http-path",size:V,stringToValue:e=>`/${decodeURIComponent(e)}`,valueToString:e=>encodeURIComponent(e.substring(1))},{code:CODE_HTTPS,name:"https"},{code:CODE_WS,name:"ws"},{code:CODE_WSS,name:"wss"},{code:CODE_P2P_WEBSOCKET_STAR,name:"p2p-websocket-star"},{code:CODE_P2P_STARDUST,name:"p2p-stardust"},{code:CODE_P2P_WEBRTC_STAR,name:"p2p-webrtc-star"},{code:CODE_P2P_WEBRTC_DIRECT,name:"p2p-webrtc-direct"},{code:CODE_WEBRTC_DIRECT,name:"webrtc-direct"},{code:CODE_WEBRTC,name:"webrtc"},{code:CODE_P2P_CIRCUIT,name:"p2p-circuit"},{code:CODE_MEMORY,name:"memory",size:V}];function bytesToComponents(e){var r,t;const n=[];let o=0;for(;o<e.length;){const i=decode(e,o),s=registry.getProtocol(i),a=encodingLength(i),c=sizeForAddr(s,e,o+a);let u=0;c>0&&s.size===V&&(u=encodingLength(c));const l=a+u+c,d={code:i,name:s.name,bytes:e.subarray(o,o+l)};if(c>0){const n=o+a+u,i=e.subarray(n,n+c);d.value=null!=(t=null==(r=s.bytesToValue)?void 0:r.call(s,i))?t:toString(i)}n.push(d),o+=l}return n}function componentsToBytes(e){var r,t;let n=0;const o=[];for(const i of e){if(null==i.bytes){const e=registry.getProtocol(i.code),n=encodingLength(i.code);let o,s=0,a=0;null!=i.value&&(o=null!=(t=null==(r=e.valueToBytes)?void 0:r.call(e,i.value))?t:fromString(i.value),s=o.byteLength,e.size===V&&(a=encodingLength(s)));const c=new Uint8Array(n+a+s);let u=0;encodeUint8Array(i.code,c,u),u+=n,null!=o&&(e.size===V&&(encodeUint8Array(s,c,u),u+=a),c.set(o,u)),i.bytes=c}o.push(i.bytes),n+=i.bytes.byteLength}return concat(o,n)}function stringToComponents(e){var r,t;if("/"!==e.charAt(0))throw new InvalidMultiaddrError('String multiaddr must start with "/"');const n=[];let o="protocol",i="",s="";for(let a=1;a<e.length;a++){const c=e.charAt(a);"/"!==c&&("protocol"===o?s+=e.charAt(a):i+=e.charAt(a));const u=a===e.length-1;if("/"===c||u){const e=registry.getProtocol(s);if("protocol"===o){if(null==e.size||0===e.size){n.push({code:e.code,name:e.name}),i="",s="",o="protocol";continue}if(u)throw new InvalidMultiaddrError(`Component ${s} was missing value`);o="value"}else if("value"===o){const a={code:e.code,name:e.name};if(null!=e.size&&0!==e.size){if(""===i)throw new InvalidMultiaddrError(`Component ${s} was missing value`);a.value=null!=(t=null==(r=e.stringToValue)?void 0:r.call(e,i))?t:i}n.push(a),i="",s="",o="protocol"}}}if(""!==s&&""!==i)throw new InvalidMultiaddrError("Incomplete multiaddr");return n}function componentsToString(e){return`/${e.flatMap(e=>{var r,t;if(null==e.value)return e.name;const n=registry.getProtocol(e.code);if(null==n)throw new InvalidMultiaddrError(`Unknown protocol code ${e.code}`);return[e.name,null!=(t=null==(r=n.valueToString)?void 0:r.call(n,e.value))?t:e.value]}).join("/")}`}function sizeForAddr(e,r,t){return null==e.size||0===e.size?0:e.size>0?e.size/8:decode(r,t)}codecs.forEach(e=>{registry.addProtocol(e)});const inspect$1=Symbol.for("nodejs.util.inspect.custom"),symbol$1=Symbol.for("@multiformats/multiaddr"),DNS_CODES=[CODE_DNS,CODE_DNS4,CODE_DNS6,CODE_DNSADDR];class NoAvailableResolverError extends Error{constructor(e="No available resolver"){super(e),this.name="NoAvailableResolverError"}}function toComponents(e){if(null==e&&(e="/"),isMultiaddr(e))return e.getComponents();if(e instanceof Uint8Array)return bytesToComponents(e);if("string"==typeof e)return""===(e=e.replace(/\/(\/)+/,"/").replace(/(\/)+$/,""))&&(e="/"),stringToComponents(e);if(Array.isArray(e))return e;throw new InvalidMultiaddrError("Must be a string, Uint8Array, Component[], or another Multiaddr")}const _Multiaddr=class e{constructor(e="/",r={}){__publicField(this,_e,!0),__privateAdd(this,_components),__privateAdd(this,_string),__privateAdd(this,_bytes),__privateSet(this,_components,toComponents(e)),!1!==r.validate&&validate(this)}get bytes(){return null==__privateGet(this,_bytes)&&__privateSet(this,_bytes,componentsToBytes(__privateGet(this,_components))),__privateGet(this,_bytes)}toString(){return null==__privateGet(this,_string)&&__privateSet(this,_string,componentsToString(__privateGet(this,_components))),__privateGet(this,_string)}toJSON(){return this.toString()}toOptions(){let e,r,t,n,o="";for(const{code:i,name:s,value:a}of __privateGet(this,_components))i===CODE_IP6ZONE&&(o=`%${null!=a?a:""}`),DNS_CODES.includes(i)&&(r="tcp",n=443,t=`${null!=a?a:""}${o}`,e=i===CODE_DNS6?6:4),i!==CODE_TCP&&i!==CODE_UDP||(r="tcp"===s?"tcp":"udp",n=parseInt(null!=a?a:"")),i!==CODE_IP4&&i!==CODE_IP6||(r="tcp",t=`${null!=a?a:""}${o}`,e=i===CODE_IP6?6:4);if(null==e||null==r||null==t||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:t,transport:r,port:n}}getComponents(){return[...__privateGet(this,_components)]}protos(){return __privateGet(this,_components).map(({code:e,value:r})=>{var t;const n=registry.getProtocol(e);return{code:e,size:null!=(t=n.size)?t:0,name:n.name,resolvable:Boolean(n.resolvable),path:Boolean(n.path)}})}protoCodes(){return __privateGet(this,_components).map(({code:e})=>e)}protoNames(){return __privateGet(this,_components).map(({name:e})=>e)}tuples(){return __privateGet(this,_components).map(({code:e,value:r})=>{var t,n;if(null==r)return[e];const o=registry.getProtocol(e),i=[e];return null!=r&&i.push(null!=(n=null==(t=o.valueToBytes)?void 0:t.call(o,r))?n:fromString(r)),i})}stringTuples(){return __privateGet(this,_components).map(({code:e,value:r})=>null==r?[e]:[e,r])}encapsulate(r){const t=new e(r);return new e([...__privateGet(this,_components),...t.getComponents()],{validate:!1})}decapsulate(r){const t=r.toString(),n=this.toString(),o=n.lastIndexOf(t);if(o<0)throw new InvalidParametersError(`Address ${this.toString()} does not contain subaddress: ${r.toString()}`);return new e(n.slice(0,o),{validate:!1})}decapsulateCode(r){let t;for(let e=__privateGet(this,_components).length-1;e>-1;e--)if(__privateGet(this,_components)[e].code===r){t=e;break}return new e(__privateGet(this,_components).slice(0,t),{validate:!1})}getPeerId(){try{let e=[];__privateGet(this,_components).forEach(({code:r,value:t})=>{r===CODE_P2P&&e.push([r,t]),r===CODE_P2P_CIRCUIT&&(e=[])});const r=e.pop();if(null!=(null==r?void 0:r[1])){const e=r[1];return"Q"===e[0]||"1"===e[0]?toString(base58btc.decode(`z${e}`),"base58btc"):toString(CID.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){var e;for(const r of __privateGet(this,_components))if(registry.getProtocol(r.code).path)return null!=(e=r.value)?e:null;return null}equals(e){return equals(this.bytes,e.bytes)}resolve(e){return __async(this,null,function*(){const r=this.protos().find(e=>e.resolvable);if(null==r)return[this];const t=resolvers.get(r.name);if(null==t)throw new NoAvailableResolverError(`no available resolver for ${r.name}`);return(yield t(this,e)).map(e=>multiaddr(e))})}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(){return!(2!==__privateGet(this,_components).length||__privateGet(this,_components)[0].code!==CODE_IP4&&__privateGet(this,_components)[0].code!==CODE_IP6||__privateGet(this,_components)[1].code!==CODE_TCP&&__privateGet(this,_components)[1].code!==CODE_UDP)}[(_e=symbol$1,inspect$1)](){return`Multiaddr(${this.toString()})`}};_components=new WeakMap,_string=new WeakMap,_bytes=new WeakMap;let Multiaddr=_Multiaddr;function validate(e){e.getComponents().forEach(e=>{var r;const t=registry.getProtocol(e.code);null!=e.value&&(null==(r=t.validate)||r.call(t,e.value))})}const resolvers=new Map;function isMultiaddr(e){return Boolean(null==e?void 0:e[symbol$1])}function multiaddr(e){return new Multiaddr(e)}function protocols(e){var r;const t=registry.getProtocol(e);return{code:t.code,size:null!=(r=t.size)?r:0,name:t.name,resolvable:Boolean(t.resolvable),path:Boolean(t.path)}}function extractSNI(e){let r;try{r=protocols("sni").code}catch(t){return null}for(const[n,o]of e)if(n===r&&void 0!==o)return o;return null}function hasTLS(e){return e.some(([e,r])=>e===protocols("tls").code)}function interpretNext(e,r,t){const n=interpreters[protocols(e).name];if(void 0===n)throw new Error(`Can't interpret protocol ${protocols(e).name}`);const o=n(r,t);return e===protocols("ip6").code?`[${o}]`:o}const interpreters={ip4:(e,r)=>e,ip6:(e,r)=>0===r.length?e:`[${e}]`,tcp:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`tcp://${interpretNext(n[0],null!=(t=n[1])?t:"",r)}:${e}`},udp:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`udp://${interpretNext(n[0],null!=(t=n[1])?t:"",r)}:${e}`},dnsaddr:(e,r)=>e,dns4:(e,r)=>e,dns6:(e,r)=>e,dns:(e,r)=>e,ipfs:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${interpretNext(n[0],null!=(t=n[1])?t:"",r)}/ipfs/${e}`},p2p:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${interpretNext(n[0],null!=(t=n[1])?t:"",r)}/p2p/${e}`},http:(e,r)=>{var t;const n=hasTLS(r),o=extractSNI(r);if(n&&null!==o)return`https://${o}`;const i=n?"https://":"http://",s=r.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");let a=interpretNext(s[0],null!=(t=s[1])?t:"",r);return a=a.replace("tcp://",""),`${i}${a}`},tls:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return interpretNext(n[0],null!=(t=n[1])?t:"",r)},sni:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return interpretNext(n[0],null!=(t=n[1])?t:"",r)},https:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");let o=interpretNext(n[0],null!=(t=n[1])?t:"",r);return o=o.replace("tcp://",""),`https://${o}`},ws:(e,r)=>{var t;const n=hasTLS(r),o=extractSNI(r);if(n&&null!==o)return`wss://${o}`;const i=n?"wss://":"ws://",s=r.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");let a=interpretNext(s[0],null!=(t=s[1])?t:"",r);return a=a.replace("tcp://",""),`${i}${a}`},wss:(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");let o=interpretNext(n[0],null!=(t=n[1])?t:"",r);return o=o.replace("tcp://",""),`wss://${o}`},"p2p-websocket-star":(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${interpretNext(n[0],null!=(t=n[1])?t:"",r)}/p2p-websocket-star`},"p2p-webrtc-star":(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${interpretNext(n[0],null!=(t=n[1])?t:"",r)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,r)=>{var t;const n=r.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return`${interpretNext(n[0],null!=(t=n[1])?t:"",r)}/p2p-webrtc-direct`}};function multiaddrToUri(e,r){var t;const n=multiaddr(e).stringTuples(),o=n.pop();if(void 0===o)throw new Error("Unexpected end of multiaddr");const i=protocols(o[0]),s=interpreters[i.name];if(null==s)throw new Error(`No interpreter found for ${i.name}`);let a=s(null!=(t=o[1])?t:"",n);return o[0]===protocols("tcp").code&&(a=a.replace("tcp://","http://"),"443"!==o[1]&&"80"!==o[1]||("443"===o[1]&&(a=a.replace("http://","https://")),a=a.substring(0,a.lastIndexOf(":")))),a}function toUrlString(e){try{e=multiaddrToUri(multiaddr$1(e))}catch(r){}return e.toString()}const getAgent=()=>{},log$1=logger("ipfs-http-client:lib:error-handler"),merge=mergeOptions.bind({ignoreUndefined:!0}),DEFAULT_PROTOCOL=envExports.isBrowser||envExports.isWebWorker?location.protocol:"http",DEFAULT_HOST=envExports.isBrowser||envExports.isWebWorker?location.hostname:"localhost",DEFAULT_PORT=envExports.isBrowser||envExports.isWebWorker?location.port:"5001",normalizeOptions=(e={})=>{let r,t,n={};if("string"==typeof e||isMultiaddr$1(e))r=new URL(toUrlString(e));else if(e instanceof URL)r=e;else if("string"==typeof e.url||isMultiaddr$1(e.url))r=new URL(toUrlString(e.url)),n=e;else if(e.url instanceof URL)r=e.url,n=e;else{n=e||{};const t=(n.protocol||DEFAULT_PROTOCOL).replace(":",""),o=(n.host||DEFAULT_HOST).split(":")[0],i=n.port||DEFAULT_PORT;r=new URL(`${t}://${o}:${i}`)}if(n.apiPath?r.pathname=n.apiPath:"/"!==r.pathname&&void 0!==r.pathname||(r.pathname="api/v0"),envExports.isNode){const e=getAgent();t=n.agent||new e({keepAlive:!0,maxSockets:6})}return __spreadProps(__spreadValues({},n),{host:r.host,protocol:r.protocol.replace(":",""),port:Number(r.port),apiPath:r.pathname,url:r,agent:t})},errorHandler=e=>__async(null,null,function*(){let r;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const t=yield e.json();log$1(t),r=t.Message||t.message}else r=yield e.text()}catch(n){log$1("Failed to parse error response",n),r=n.message}let t=new HTTP.HTTPError(e);throw r&&(r.includes("deadline has elapsed")&&(t=new HTTP.TimeoutError),r&&r.includes("context deadline exceeded")&&(t=new HTTP.TimeoutError)),r&&r.includes("request timed out")&&(t=new HTTP.TimeoutError),r&&(t.message=r),t}),KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,kebabCase=e=>e.replace(KEBAB_REGEX,function(e){return"-"+e.toLowerCase()}),parseTimeout=e=>"string"==typeof e?parse(e):e;class Client extends HTTP{constructor(e={}){const r=normalizeOptions(e);super({timeout:parseTimeout(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:errorHandler,transformSearchParams:e=>{const r=new URLSearchParams;for(const[t,n]of e)"undefined"!==n&&"null"!==n&&"signal"!==t&&r.append(kebabCase(t),n),"timeout"!==t||isNaN(n)||r.append(kebabCase(t),n);return r},agent:r.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const t=this.fetch;this.fetch=(e,n={})=>("string"!=typeof e||e.startsWith("/")||(e=`${r.url}/${e}`),t.call(this,e,merge(n,{method:"POST"})))}}HTTP.HTTPError;const configure=e=>r=>e(new Client(r),r);function modeToString$1(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}function parseMtime$1(e){if(null==e)return;let r;if(null!=e.secs&&(r={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(r={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(r={secs:e[0],nsecs:e[1]}),e instanceof Date){const t=e.getTime(),n=Math.floor(t/1e3);r={secs:n,nsecs:1e3*(t-1e3*n)}}if(Object.prototype.hasOwnProperty.call(r,"secs")){if(null!=r&&null!=r.nsecs&&(r.nsecs<0||r.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return r}}function toUrlSearchParams(e={}){var r=e,{arg:t,searchParams:n,hashAlg:o,mtime:i,mode:s}=r,a=__objRest(r,["arg","searchParams","hashAlg","mtime","mode"]);n&&(a=__spreadValues(__spreadValues({},a),n)),o&&(a.hash=o),null!=i&&(i=parseMtime$1(i),a.mtime=i.secs,a.mtimeNsecs=i.nsecs),null!=s&&(a.mode=modeToString$1(s)),a.timeout&&!isNaN(a.timeout)&&(a.timeout=`${a.timeout}ms`),null==t?t=[]:Array.isArray(t)||(t=[t]);const c=new URLSearchParams(a);return t.forEach(e=>c.append("arg",e)),c}const createWantlist=configure(e=>function(){return __async(this,arguments,function*(r={}){return((yield(yield e.post("bitswap/wantlist",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Keys||[]).map(e=>CID$1.parse(e["/"]))})}),createWantlistForPeer=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){return((yield(yield e.post("bitswap/wantlist",{signal:t.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},t),{peer:r.toString()})),headers:t.headers})).json()).Keys||[]).map(e=>CID$1.parse(e["/"]))})}),symbol=Symbol.for("@libp2p/peer-id"),inspect=Symbol.for("nodejs.util.inspect.custom"),baseDecoder=Object.values(bases$2).map(e=>e.decoder).reduce((e,r)=>e.or(r),bases$2.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;class PeerIdImpl{constructor(e){__publicField(this,"type"),__publicField(this,"multihash"),__publicField(this,"privateKey"),__publicField(this,"publicKey"),__publicField(this,"string"),__publicField(this,_h,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}toString(){return null==this.string&&(this.string=base58btc$2.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID$1.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var r;if(e instanceof Uint8Array)return equals$3(this.multihash.bytes,e);if("string"==typeof e)return peerIdFromString(e).equals(this);if(null!=(null==(r=null==e?void 0:e.multihash)?void 0:r.bytes))return equals$3(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[(_h=symbol,inspect)](){return`PeerId(${this.toString()})`}}class RSAPeerIdImpl extends PeerIdImpl{constructor(e){super(__spreadProps(__spreadValues({},e),{type:"RSA"})),__publicField(this,"type","RSA"),__publicField(this,"publicKey"),this.publicKey=e.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{constructor(e){super(__spreadProps(__spreadValues({},e),{type:"Ed25519"})),__publicField(this,"type","Ed25519"),__publicField(this,"publicKey"),this.publicKey=e.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{constructor(e){super(__spreadProps(__spreadValues({},e),{type:"secp256k1"})),__publicField(this,"type","secp256k1"),__publicField(this,"publicKey"),this.publicKey=e.multihash.digest}}function peerIdFromString(e,r){if("1"===e.charAt(0)||"Q"===e.charAt(0)){const r=decode$f(base58btc$2.decode(`z${e}`));return e.startsWith("12D")?new Ed25519PeerIdImpl({multihash:r}):e.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:r}):new RSAPeerIdImpl({multihash:r})}return peerIdFromBytes(baseDecoder.decode(e))}function peerIdFromBytes(e){try{const r=decode$f(e);if(r.code===identity$3.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:r});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:r})}if(r.code===sha256.code)return new RSAPeerIdImpl({multihash:r})}catch(r){return peerIdFromCID(CID$1.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const r=e.multihash;if(r.code===sha256.code)return new RSAPeerIdImpl({multihash:e.multihash});if(r.code===identity$3.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:e.multihash});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}const createStat$4=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("bitswap/stat",{searchParams:toUrlSearchParams(r),signal:r.signal,headers:r.headers});return toCoreInterface$4(yield t.json())})});function toCoreInterface$4(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(e=>CID$1.parse(e["/"])),peers:(e.Peers||[]).map(e=>peerIdFromString(e)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const createUnwant=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){return(yield e.post("bitswap/unwant",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers})).json()})});function createBitswap(e){return{wantlist:createWantlist(e),wantlistForPeer:createWantlistForPeer(e),unwant:createUnwant(e),stat:createStat$4(e)}}const createGet$5=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("block/get",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers});return new Uint8Array(yield n.arrayBuffer())})});function peekableIterator(e){const[r,t]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>r.next(),push:e=>{n.push(e)},next:()=>n.length>0?{done:!1,value:n.shift()}:r.next(),[t](){return this}}}function browserReadableStreamToIt(e){return __asyncGenerator(this,arguments,function*(e,r={}){const t=e.getReader();try{for(;;){const e=yield new __await(t.read());if(e.done)return;yield e.value}}finally{!0!==r.preventCancel&&(yield new __await(t.cancel())),t.releaseLock()}})}function all(e){return __async(this,null,function*(){const r=[];try{for(var t,n,o,i=__forAwait(e);t=!(n=yield i.next()).done;t=!1){const e=n.value;r.push(e)}}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield n.call(i))}finally{if(o)throw o[0]}}return r})}function isBytes(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function isBlob(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"==typeof e.stream}function isFileObject(e){return"object"==typeof e&&(e.path||e.content)}const isReadableStream=e=>e&&"function"==typeof e.getReader;function normaliseContent$1(e){return __async(this,null,function*(){if(isBytes(e))return new Blob([e]);if("string"==typeof e||e instanceof String)return new Blob([e.toString()]);if(isBlob(e))return e;if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=peekableIterator(e),{value:t,done:n}=yield r.peek();if(n)return itToBlob(r);if(r.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(yield all(r))]);if(isBytes(t)||"string"==typeof t||t instanceof String)return itToBlob(r)}throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")})}function itToBlob(e){return __async(this,null,function*(){const r=[];try{for(var t,n,o,i=__forAwait(e);t=!(n=yield i.next()).done;t=!1){const e=n.value;r.push(e)}}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield n.call(i))}finally{if(o)throw o[0]}}return new Blob(r)})}function map(e,r){return __asyncGenerator(this,null,function*(){try{for(var t,n,o,i=__forAwait(e);t=!(n=yield new __await(i.next())).done;t=!1){const e=n.value;yield r(e)}}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield new __await(n.call(i)))}finally{if(o)throw o[0]}}})}var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){return hasRequiredAspromise||(hasRequiredAspromise=1,aspromise=function(e,r){for(var t=new Array(arguments.length-1),n=0,o=2,i=!0;o<arguments.length;)t[n++]=arguments[o++];return new Promise(function(o,s){t[n]=function(e){if(i)if(i=!1,e)s(e);else{for(var r=new Array(arguments.length-1),t=0;t<r.length;)r[t++]=arguments[t];o.apply(null,r)}};try{e.apply(r||null,t)}catch(a){i&&(i=!1,s(a))}})}),aspromise}var base64={},hasRequiredBase64,eventemitter,hasRequiredEventemitter,float,hasRequiredFloat,inquire_1,hasRequiredInquire;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(){var e=base64;e.length=function(e){var r=e.length;if(!r)return 0;for(var t=0;--r%4>1&&"="===e.charAt(r);)++t;return Math.ceil(3*e.length)/4-t};for(var r=new Array(64),t=new Array(123),n=0;n<64;)t[r[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;e.encode=function(e,t,n){for(var o,i=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=r[u>>2],o=(3&u)<<4,c=1;break;case 1:s[a++]=r[o|u>>4],o=(15&u)<<2,c=2;break;case 2:s[a++]=r[o|u>>6],s[a++]=r[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=r[o],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var o="invalid encoding";e.decode=function(e,r,n){for(var i,s=n,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=t[u]))throw Error(o);switch(a){case 0:i=u,a=1;break;case 1:r[n++]=i<<2|(48&u)>>4,i=u,a=2;break;case 2:r[n++]=(15&i)<<4|(60&u)>>2,i=u,a=3;break;case 3:r[n++]=(3&i)<<6|u,a=0}}if(1===a)throw Error(o);return n-s},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}()),base64}function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;function e(){this._listeners={}}return hasRequiredEventemitter=1,eventemitter=e,e.prototype.on=function(e,r,t){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:t||this}),this},e.prototype.off=function(e,r){if(void 0===e)this._listeners={};else if(void 0===r)this._listeners[e]=[];else for(var t=this._listeners[e],n=0;n<t.length;)t[n].fn===r?t.splice(n,1):++n;return this},e.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,t)}return this},eventemitter}function requireFloat(){if(hasRequiredFloat)return float;function e(e){return"undefined"!=typeof Float32Array?function(){var r=new Float32Array([-0]),t=new Uint8Array(r.buffer),n=128===t[3];function o(e,n,o){r[0]=e,n[o]=t[0],n[o+1]=t[1],n[o+2]=t[2],n[o+3]=t[3]}function i(e,n,o){r[0]=e,n[o]=t[3],n[o+1]=t[2],n[o+2]=t[1],n[o+3]=t[0]}function s(e,n){return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],r[0]}function a(e,n){return t[3]=e[n],t[2]=e[n+1],t[1]=e[n+2],t[0]=e[n+3],r[0]}e.writeFloatLE=n?o:i,e.writeFloatBE=n?i:o,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function i(e,r,t,n){var o=r<0?1:0;if(o&&(r=-r),0===r)e(1/r>0?0:2147483648,t,n);else if(isNaN(r))e(2143289344,t,n);else if(r>34028234663852886e22)e((o<<31|2139095040)>>>0,t,n);else if(r<11754943508222875e-54)e((o<<31|Math.round(r/1401298464324817e-60))>>>0,t,n);else{var i=Math.floor(Math.log(r)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(r*Math.pow(2,-i)*8388608))>>>0,t,n)}}function s(e,r,t){var n=e(r,t),o=2*(n>>31)+1,i=n>>>23&255,s=8388607&n;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=i.bind(null,r),e.writeFloatBE=i.bind(null,t),e.readFloatLE=s.bind(null,n),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var r=new Float64Array([-0]),t=new Uint8Array(r.buffer),n=128===t[7];function o(e,n,o){r[0]=e,n[o]=t[0],n[o+1]=t[1],n[o+2]=t[2],n[o+3]=t[3],n[o+4]=t[4],n[o+5]=t[5],n[o+6]=t[6],n[o+7]=t[7]}function i(e,n,o){r[0]=e,n[o]=t[7],n[o+1]=t[6],n[o+2]=t[5],n[o+3]=t[4],n[o+4]=t[3],n[o+5]=t[2],n[o+6]=t[1],n[o+7]=t[0]}function s(e,n){return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t[4]=e[n+4],t[5]=e[n+5],t[6]=e[n+6],t[7]=e[n+7],r[0]}function a(e,n){return t[7]=e[n],t[6]=e[n+1],t[5]=e[n+2],t[4]=e[n+3],t[3]=e[n+4],t[2]=e[n+5],t[1]=e[n+6],t[0]=e[n+7],r[0]}e.writeDoubleLE=n?o:i,e.writeDoubleBE=n?i:o,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function i(e,r,t,n,o,i){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,o,i+r),e(1/n>0?0:2147483648,o,i+t);else if(isNaN(n))e(0,o,i+r),e(2146959360,o,i+t);else if(n>17976931348623157e292)e(0,o,i+r),e((s<<31|2146435072)>>>0,o,i+t);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,o,i+r),e((s<<31|a/4294967296)>>>0,o,i+t);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,o,i+r),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+t)}}}function s(e,r,t,n,o){var i=e(n,o+r),s=e(n,o+t),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=i.bind(null,r,0,4),e.writeDoubleBE=i.bind(null,t,4,0),e.readDoubleLE=s.bind(null,n,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,r,t){r[t]=255&e,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24}function t(e,r,t){r[t]=e>>>24,r[t+1]=e>>>16&255,r[t+2]=e>>>8&255,r[t+3]=255&e}function n(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24)>>>0}function o(e,r){return(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3])>>>0}return hasRequiredFloat=1,float=e(e)}function requireInquire(){if(hasRequiredInquire)return inquire_1;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return hasRequiredInquire=1,inquire_1=inquire,inquire_1}var utf8={},hasRequiredUtf8,pool_1,hasRequiredPool,longbits,hasRequiredLongbits,hasRequiredMinimal$1,writer,hasRequiredWriter,writer_buffer,hasRequiredWriter_buffer,reader,hasRequiredReader,reader_buffer,hasRequiredReader_buffer;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,(e=utf8).length=function(e){for(var r=0,t=0,n=0;n<e.length;++n)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:55296==(64512&t)&&56320==(64512&e.charCodeAt(n+1))?(++n,r+=4):r+=3;return r},e.read=function(e,r,t){if(t-r<1)return"";for(var n,o=null,i=[],s=0;r<t;)(n=e[r++])<128?i[s++]=n:n>191&&n<224?i[s++]=(31&n)<<6|63&e[r++]:n>239&&n<365?(n=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,i[s++]=55296+(n>>10),i[s++]=56320+(1023&n)):i[s++]=(15&n)<<12|(63&e[r++])<<6|63&e[r++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},e.write=function(e,r,t){for(var n,o,i=t,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?r[t++]=n:n<2048?(r[t++]=n>>6|192,r[t++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&o),++s,r[t++]=n>>18|240,r[t++]=n>>12&63|128,r[t++]=n>>6&63|128,r[t++]=63&n|128):(r[t++]=n>>12|224,r[t++]=n>>6&63|128,r[t++]=63&n|128);return t-i}),utf8;var e}function requirePool(){return hasRequiredPool?pool_1:(hasRequiredPool=1,pool_1=function(e,r,t){var n=t||8192,o=n>>>1,i=null,s=n;return function(t){if(t<1||t>o)return e(t);s+t>n&&(i=e(n),s=0);var a=r.call(i,s,s+=t);return 7&s&&(s=1+(7|s)),a}})}function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=r;var e=requireMinimal$1();function r(e,r){this.lo=e>>>0,this.hi=r>>>0}var t=r.zero=new r(0,0);t.toNumber=function(){return 0},t.zzEncode=t.zzDecode=function(){return this},t.length=function(){return 1};var n=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return t;var n=e<0;n&&(e=-e);var o=e>>>0,i=(e-o)/4294967296>>>0;return n&&(i=~i>>>0,o=~o>>>0,++o>4294967295&&(o=0,++i>4294967295&&(i=0))),new r(o,i)},r.from=function(n){if("number"==typeof n)return r.fromNumber(n);if(e.isString(n)){if(!e.Long)return r.fromNumber(parseInt(n,10));n=e.Long.fromString(n)}return n.low||n.high?new r(n.low>>>0,n.high>>>0):t},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=1+~this.lo>>>0,t=~this.hi>>>0;return r||(t=t+1>>>0),-(r+4294967296*t)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(r){return e.Long?new e.Long(0|this.lo,0|this.hi,Boolean(r)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(r)}};var o=String.prototype.charCodeAt;return r.fromHash=function(e){return e===n?t:new r((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,t=this.hi>>>24;return 0===t?0===r?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:t<128?9:10},longbits}function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(){var e=minimal$1;function r(e,r,t){for(var n=Object.keys(r),o=0;o<n.length;++o)void 0!==e[n[o]]&&t||(e[n[o]]=r[n[o]]);return e}function t(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}e.asPromise=requireAspromise(),e.base64=requireBase64(),e.EventEmitter=requireEventemitter(),e.float=requireFloat(),e.inquire=requireInquire(),e.utf8=requireUtf8(),e.pool=requirePool(),e.LongBits=requireLongbits(),e.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||minimal$1,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},e.isString=function(e){return"string"==typeof e||e instanceof String},e.isObject=function(e){return e&&"object"==typeof e},e.isset=e.isSet=function(e,r){var t=e[r];return!(null==t||!e.hasOwnProperty(r))&&("object"!=typeof t||(Array.isArray(t)?t.length:Object.keys(t).length)>0)},e.Buffer=function(){try{var r=e.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(t){return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(r){return"number"==typeof r?e.Buffer?e._Buffer_allocUnsafe(r):new e.Array(r):e.Buffer?e._Buffer_from(r):"undefined"==typeof Uint8Array?r:new Uint8Array(r)},e.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(r){return r?e.LongBits.from(r).toHash():e.LongBits.zeroHash},e.longFromHash=function(r,t){var n=e.LongBits.fromHash(r);return e.Long?e.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},e.merge=r,e.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},e.newError=t,e.ProtocolError=t("ProtocolError"),e.oneOfGetter=function(e){for(var r={},t=0;t<e.length;++t)r[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;t>-1;--t)if(1===r[e[t]]&&void 0!==this[e[t]]&&null!==this[e[t]])return e[t]}},e.oneOfSetter=function(e){return function(r){for(var t=0;t<e.length;++t)e[t]!==r&&delete this[e[t]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var r=e.Buffer;r?(e._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,t){return new r(e,t)},e._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}):e._Buffer_from=e._Buffer_allocUnsafe=null}}()),minimal$1}function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=c;var e,r=requireMinimal$1(),t=r.LongBits,n=r.base64,o=r.utf8;function i(e,r,t){this.fn=e,this.len=r,this.next=void 0,this.val=t}function s(){}function a(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function c(){this.len=0,this.head=new i(s,0,0),this.tail=this.head,this.states=null}var u=function(){return r.Buffer?function(){return(c.create=function(){return new e})()}:function(){return new c}};function l(e,r,t){r[t]=255&e}function d(e,r){this.len=e,this.next=void 0,this.val=r}function f(e,r,t){for(;e.hi;)r[t++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)r[t++]=127&e.lo|128,e.lo=e.lo>>>7;r[t++]=e.lo}function h(e,r,t){r[t]=255&e,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24}c.create=u(),c.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(c.alloc=r.pool(c.alloc,r.Array.prototype.subarray)),c.prototype._push=function(e,r,t){return this.tail=this.tail.next=new i(e,r,t),this.len+=r,this},d.prototype=Object.create(i.prototype),d.prototype.fn=function(e,r,t){for(;e>127;)r[t++]=127&e|128,e>>>=7;r[t]=e},c.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},c.prototype.int32=function(e){return e<0?this._push(f,10,t.fromNumber(e)):this.uint32(e)},c.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},c.prototype.uint64=function(e){var r=t.from(e);return this._push(f,r.length(),r)},c.prototype.int64=c.prototype.uint64,c.prototype.sint64=function(e){var r=t.from(e).zzEncode();return this._push(f,r.length(),r)},c.prototype.bool=function(e){return this._push(l,1,e?1:0)},c.prototype.fixed32=function(e){return this._push(h,4,e>>>0)},c.prototype.sfixed32=c.prototype.fixed32,c.prototype.fixed64=function(e){var r=t.from(e);return this._push(h,4,r.lo)._push(h,4,r.hi)},c.prototype.sfixed64=c.prototype.fixed64,c.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},c.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var p=r.Array.prototype.set?function(e,r,t){r.set(e,t)}:function(e,r,t){for(var n=0;n<e.length;++n)r[t+n]=e[n]};return c.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(l,1,0);if(r.isString(e)){var o=c.alloc(t=n.length(e));n.decode(e,o,0),e=o}return this.uint32(t)._push(p,t,e)},c.prototype.string=function(e){var r=o.length(e);return r?this.uint32(r)._push(o.write,r,e):this._push(l,1,0)},c.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new i(s,0,0),this.len=0,this},c.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(s,0,0),this.len=0),this},c.prototype.ldelim=function(){var e=this.head,r=this.tail,t=this.len;return this.reset().uint32(t),t&&(this.tail.next=e.next,this.tail=r,this.len+=t),this},c.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),t=0;e;)e.fn(e.val,r,t),t+=e.len,e=e.next;return r},c._configure=function(r){e=r,c.create=u(),e._configure()},writer}function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=t;var e=requireWriter();(t.prototype=Object.create(e.prototype)).constructor=t;var r=requireMinimal$1();function t(){e.call(this)}function n(e,t,n){e.length<40?r.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}return t._configure=function(){t.alloc=r._Buffer_allocUnsafe,t.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,r,t){r.set(e,t)}:function(e,r,t){if(e.copy)e.copy(r,t,0,e.length);else for(var n=0;n<e.length;)r[t++]=e[n++]}},t.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var n=e.length>>>0;return this.uint32(n),n&&this._push(t.writeBytesBuffer,n,e),this},t.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(n,t,e),this},t._configure(),writer_buffer}function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=i;var e,r=requireMinimal$1(),t=r.LongBits,n=r.utf8;function o(e,r){return RangeError("index out of range: "+e.pos+" + "+(r||1)+" > "+e.len)}function i(e){this.buf=e,this.pos=0,this.len=e.length}var s="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new i(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new i(e);throw Error("illegal buffer")},a=function(){return r.Buffer?function(t){return(i.create=function(t){return r.Buffer.isBuffer(t)?new e(t):s(t)})(t)}:s};function c(){var e=new t(0,0),r=0;if(!(this.len-this.pos>4)){for(;r<3;++r){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*r)>>>0,e}for(;r<4;++r)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(r=0,this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function u(e,r){return(e[r-4]|e[r-3]<<8|e[r-2]<<16|e[r-1]<<24)>>>0}function l(){if(this.pos+8>this.len)throw o(this,8);return new t(u(this.buf,this.pos+=4),u(this.buf,this.pos+=4))}return i.create=a(),i.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,i.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return e}}(),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return u(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|u(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},i.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},i.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw o(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var i=r.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},i.prototype.string=function(){var e=this.bytes();return n.read(e,0,e.length)},i.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw o(this)}while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},i._configure=function(t){e=t,i.create=a(),e._configure();var n=r.Long?"toLong":"toNumber";r.merge(i.prototype,{int64:function(){return c.call(this)[n](!1)},uint64:function(){return c.call(this)[n](!0)},sint64:function(){return c.call(this).zzDecode()[n](!1)},fixed64:function(){return l.call(this)[n](!0)},sfixed64:function(){return l.call(this)[n](!1)}})},reader}function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=t;var e=requireReader();(t.prototype=Object.create(e.prototype)).constructor=t;var r=requireMinimal$1();function t(r){e.call(this,r)}return t._configure=function(){r.Buffer&&(t.prototype._slice=r.Buffer.prototype.slice)},t.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},t._configure(),reader_buffer}var rpc={},service,hasRequiredService,hasRequiredRpc,roots,hasRequiredRoots,hasRequiredIndexMinimal,minimal,hasRequiredMinimal;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=r;var e=requireMinimal$1();function r(r,t,n){if("function"!=typeof r)throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}return(r.prototype=Object.create(e.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function r(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return e.asPromise(r,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof o))try{r=o[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(n){return a.emit("error",n,t),s(n)}return a.emit("data",r,t),s(null,r)}a.end(!0)})}catch(c){return a.emit("error",c,t),void setTimeout(function(){s(c)},0)}else setTimeout(function(){s(Error("already ended"))},0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,rpc.Service=requireService()),rpc}function requireRoots(){return hasRequiredRoots?roots:(hasRequiredRoots=1,roots={})}function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(){var e=indexMinimal;function r(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}e.build="minimal",e.Writer=requireWriter(),e.BufferWriter=requireWriter_buffer(),e.Reader=requireReader(),e.BufferReader=requireReader_buffer(),e.util=requireMinimal$1(),e.rpc=requireRpc(),e.roots=requireRoots(),e.configure=r,r()}()),indexMinimal}function requireMinimal(){return hasRequiredMinimal?minimal:(hasRequiredMinimal=1,minimal=requireIndexMinimal())}var minimalExports=requireMinimal();const $protobuf=getDefaultExportFromCjs(minimalExports),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-unixfs"]||($protobuf.roots["ipfs-unixfs"]={});function parseMode(e){if(null!=e)return"number"==typeof e?4095&e:"0"===(e=e.toString()).substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10)}function parseMtime(e){if(null==e)return;let r;if(null!=e.secs&&(r={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(r={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(r={secs:e[0],nsecs:e[1]}),e instanceof Date){const t=e.getTime(),n=Math.floor(t/1e3);r={secs:n,nsecs:1e3*(t-1e3*n)}}if(Object.prototype.hasOwnProperty.call(r,"secs")){if(null!=r&&null!=r.nsecs&&(r.nsecs<0||r.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return r}}function normaliseCandidateMultiple(e,r){return __asyncGenerator(this,null,function*(){if("string"==typeof e||e instanceof String||isBytes(e)||isBlob(e)||e._readableState)throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=peekableIterator(e),{value:n,done:o}=yield new __await(t.peek());if(o)return void(yield*__yieldStar([]));if(t.push(n),Number.isInteger(n))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState)return void(yield*__yieldStar(map(t,e=>toFileObject$1({content:e},r))));if(isBytes(n))return void(yield toFileObject$1({content:t},r));if(isFileObject(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||isReadableStream(n)||isBlob(n))return void(yield*__yieldStar(map(t,e=>toFileObject$1(e,r))))}if(isFileObject(e))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")})}function toFileObject$1(e,r){return __async(this,null,function*(){const{path:t,mode:n,mtime:o,content:i}=e,s={path:t||"",mode:parseMode(n),mtime:parseMtime(o)};return i?s.content=yield r(i):t||(s.content=yield r(e)),s})}function normaliseInput$2(e){return normaliseCandidateMultiple(e,normaliseContent$1)}function modeToString(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}function multipartRequest(e,r){return __async(this,arguments,function*(e,r,t={}){const n=[],o=new FormData;let i=0,s=0;try{for(var a,c,u,l=__forAwait(normaliseInput$2(e));a=!(c=yield l.next()).done;a=!1){const{content:e,path:r,mode:t,mtime:a}=c.value;let u="";i>0&&(u=`-${i}`);let l=(e?"file":"dir")+u;const d=[];if(null!=t&&d.push(`mode=${modeToString(t)}`),null!=a){const{secs:e,nsecs:r}=a;d.push(`mtime=${e}`),null!=r&&d.push(`mtime-nsecs=${r}`)}if(d.length&&(l=`${l}?${d.join("&")}`),e){o.set(l,e,null!=r?encodeURIComponent(r):void 0);const t=s+e.size;n.push({name:r,start:s,end:t}),s=t}else{if(null==r)throw new Error("path or content or both must be set");o.set(l,new File([""],encodeURIComponent(r),{type:"application/x-directory"}))}i++}}catch(c){u=[c]}finally{try{a&&(c=l.return)&&(yield c.call(l))}finally{if(u)throw u[0]}}return{total:s,parts:n,headers:t,body:o}})}$root.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return e.prototype.Type=0,e.prototype.Data=$util.newBuffer([]),e.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=$util.emptyArray,e.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,r){if(r||(r=$Writer.create()),r.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&r.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&r.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var t=0;t<e.blocksizes.length;++t)r.uint32(32).uint64(e.blocksizes[t]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&r.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&r.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&r.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&$root.UnixTime.encode(e.mtime,r.uint32(66).fork()).ldelim(),r},e.decode=function(e,r){e instanceof $Reader||(e=$Reader.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new $root.Data;e.pos<t;){var o=e.uint32();switch(o>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=$root.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&o)}}if(!n.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof $root.Data)return e;var r=new $root.Data;switch(e.Type){case"Raw":case 0:r.Type=0;break;case"Directory":case 1:r.Type=1;break;case"File":case 2:r.Type=2;break;case"Metadata":case 3:r.Type=3;break;case"Symlink":case 4:r.Type=4;break;case"HAMTShard":case 5:r.Type=5}if(null!=e.Data&&("string"==typeof e.Data?$util.base64.decode(e.Data,r.Data=$util.newBuffer($util.base64.length(e.Data)),0):e.Data.length&&(r.Data=e.Data)),null!=e.filesize&&($util.Long?(r.filesize=$util.Long.fromValue(e.filesize)).unsigned=!0:"string"==typeof e.filesize?r.filesize=parseInt(e.filesize,10):"number"==typeof e.filesize?r.filesize=e.filesize:"object"==typeof e.filesize&&(r.filesize=new $util.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");r.blocksizes=[];for(var t=0;t<e.blocksizes.length;++t)$util.Long?(r.blocksizes[t]=$util.Long.fromValue(e.blocksizes[t])).unsigned=!0:"string"==typeof e.blocksizes[t]?r.blocksizes[t]=parseInt(e.blocksizes[t],10):"number"==typeof e.blocksizes[t]?r.blocksizes[t]=e.blocksizes[t]:"object"==typeof e.blocksizes[t]&&(r.blocksizes[t]=new $util.LongBits(e.blocksizes[t].low>>>0,e.blocksizes[t].high>>>0).toNumber(!0))}if(null!=e.hashType&&($util.Long?(r.hashType=$util.Long.fromValue(e.hashType)).unsigned=!0:"string"==typeof e.hashType?r.hashType=parseInt(e.hashType,10):"number"==typeof e.hashType?r.hashType=e.hashType:"object"==typeof e.hashType&&(r.hashType=new $util.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&($util.Long?(r.fanout=$util.Long.fromValue(e.fanout)).unsigned=!0:"string"==typeof e.fanout?r.fanout=parseInt(e.fanout,10):"number"==typeof e.fanout?r.fanout=e.fanout:"object"==typeof e.fanout&&(r.fanout=new $util.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(r.mode=e.mode>>>0),null!=e.mtime){if("object"!=typeof e.mtime)throw TypeError(".Data.mtime: object expected");r.mtime=$root.UnixTime.fromObject(e.mtime)}return r},e.toObject=function(e,r){r||(r={});var t={};if((r.arrays||r.defaults)&&(t.blocksizes=[]),r.defaults){if(t.Type=r.enums===String?"Raw":0,r.bytes===String?t.Data="":(t.Data=[],r.bytes!==Array&&(t.Data=$util.newBuffer(t.Data))),$util.Long){var n=new $util.Long(0,0,!0);t.filesize=r.longs===String?n.toString():r.longs===Number?n.toNumber():n}else t.filesize=r.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!0),t.hashType=r.longs===String?n.toString():r.longs===Number?n.toNumber():n):t.hashType=r.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!0),t.fanout=r.longs===String?n.toString():r.longs===Number?n.toNumber():n):t.fanout=r.longs===String?"0":0,t.mode=0,t.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(t.Type=r.enums===String?$root.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(t.Data=r.bytes===String?$util.base64.encode(e.Data,0,e.Data.length):r.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"==typeof e.filesize?t.filesize=r.longs===String?String(e.filesize):e.filesize:t.filesize=r.longs===String?$util.Long.prototype.toString.call(e.filesize):r.longs===Number?new $util.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){t.blocksizes=[];for(var o=0;o<e.blocksizes.length;++o)"number"==typeof e.blocksizes[o]?t.blocksizes[o]=r.longs===String?String(e.blocksizes[o]):e.blocksizes[o]:t.blocksizes[o]=r.longs===String?$util.Long.prototype.toString.call(e.blocksizes[o]):r.longs===Number?new $util.LongBits(e.blocksizes[o].low>>>0,e.blocksizes[o].high>>>0).toNumber(!0):e.blocksizes[o]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"==typeof e.hashType?t.hashType=r.longs===String?String(e.hashType):e.hashType:t.hashType=r.longs===String?$util.Long.prototype.toString.call(e.hashType):r.longs===Number?new $util.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"==typeof e.fanout?t.fanout=r.longs===String?String(e.fanout):e.fanout:t.fanout=r.longs===String?$util.Long.prototype.toString.call(e.fanout):r.longs===Number?new $util.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(t.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(t.mtime=$root.UnixTime.toObject(e.mtime,r)),t},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.DataType=function(){const e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),e})(),$root.UnixTime=(()=>{function e(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return e.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,r){return r||(r=$Writer.create()),r.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&r.uint32(21).fixed32(e.FractionalNanoseconds),r},e.decode=function(e,r){e instanceof $Reader||(e=$Reader.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new $root.UnixTime;e.pos<t;){var o=e.uint32();switch(o>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&o)}}if(!n.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof $root.UnixTime)return e;var r=new $root.UnixTime;return null!=e.Seconds&&($util.Long?(r.Seconds=$util.Long.fromValue(e.Seconds)).unsigned=!1:"string"==typeof e.Seconds?r.Seconds=parseInt(e.Seconds,10):"number"==typeof e.Seconds?r.Seconds=e.Seconds:"object"==typeof e.Seconds&&(r.Seconds=new $util.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(r.FractionalNanoseconds=e.FractionalNanoseconds>>>0),r},e.toObject=function(e,r){r||(r={});var t={};if(r.defaults){if($util.Long){var n=new $util.Long(0,0,!1);t.Seconds=r.longs===String?n.toString():r.longs===Number?n.toNumber():n}else t.Seconds=r.longs===String?"0":0;t.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"==typeof e.Seconds?t.Seconds=r.longs===String?String(e.Seconds):e.Seconds:t.Seconds=r.longs===String?$util.Long.prototype.toString.call(e.Seconds):r.longs===Number?new $util.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(t.FractionalNanoseconds=e.FractionalNanoseconds),t},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})(),$root.Metadata=(()=>{function e(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return e.prototype.MimeType="",e.encode=function(e,r){return r||(r=$Writer.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&r.uint32(10).string(e.MimeType),r},e.decode=function(e,r){e instanceof $Reader||(e=$Reader.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new $root.Metadata;e.pos<t;){var o=e.uint32();o>>>3==1?n.MimeType=e.string():e.skipType(7&o)}return n},e.fromObject=function(e){if(e instanceof $root.Metadata)return e;var r=new $root.Metadata;return null!=e.MimeType&&(r.MimeType=String(e.MimeType)),r},e.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(t.MimeType=e.MimeType),t},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();var anySignalExports=requireAnySignal();function filter(e){return e.filter(Boolean)}function abortSignal(...e){return anySignalExports.anySignal(filter(e))}const createPut$3=configure(e=>function r(t){return __async(this,arguments,function*(t,n={}){const o=new AbortController,i=abortSignal(o.signal,n.signal);let s;try{const r=yield e.post("block/put",__spreadValues({signal:i,searchParams:toUrlSearchParams(n)},yield multipartRequest([t],o,n.headers)));s=yield r.json()}catch(a){if("dag-pb"===n.format)return r(t,__spreadProps(__spreadValues({},n),{format:"protobuf"}));if("dag-cbor"===n.format)return r(t,__spreadProps(__spreadValues({},n),{format:"cbor"}));throw a}return CID$1.parse(s.Key)})}),createRm$6=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){Array.isArray(r)||(r=[r]);const n=yield new __await(e.post("block/rm",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.map(e=>e.toString()),"stream-channels":!0},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield toCoreInterface$3(e)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})});function toCoreInterface$3(e){const r={cid:CID$1.parse(e.Hash)};return e.Error&&(r.error=new Error(e.Error)),r}const createStat$3=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("block/stat",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers}),o=yield n.json();return{cid:CID$1.parse(o.Key),size:o.Size}})});function createBlock(e){return{get:createGet$5(e),put:createPut$3(e),rm:createRm$6(e),stat:createStat$3(e)}}const createAdd$4=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("bootstrap/add",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),{Peers:o}=yield n.json();return{Peers:o.map(e=>multiaddr$1(e))}})}),createClear=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("bootstrap/rm",{signal:r.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},r),{all:!0})),headers:r.headers}),{Peers:n}=yield t.json();return{Peers:n.map(e=>multiaddr$1(e))}})}),createList$2=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("bootstrap/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Peers:n}=yield t.json();return{Peers:n.map(e=>multiaddr$1(e))}})}),createReset=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("bootstrap/add",{signal:r.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},r),{default:!0})),headers:r.headers}),{Peers:n}=yield t.json();return{Peers:n.map(e=>multiaddr$1(e))}})}),createRm$5=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("bootstrap/rm",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),{Peers:o}=yield n.json();return{Peers:o.map(e=>multiaddr$1(e))}})});function createBootstrap(e){return{add:createAdd$4(e),clear:createClear(e),list:createList$2(e),reset:createReset(e),rm:createRm$5(e)}}const createApply=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("config/profile/apply",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),o=yield n.json();return{original:o.OldCfg,updated:o.NewCfg}})});function objectToCamel(e){if(null==e)return e;const r=/^[A-Z]+$/;return Object.keys(e).reduce((t,n)=>(r.test(n)?t[n.toLowerCase()]=e[n]:r.test(n[0])?t[n[0].toLowerCase()+n.slice(1)]=e[n]:t[n]=e[n],t),{})}const createList$1=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("config/profile/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return(yield t.json()).map(e=>objectToCamel(e))})});function createProfiles(e){return{apply:createApply(e),list:createList$1(e)}}const createGet$4=configure(e=>(r,...t)=>__async(null,[r,...t],function*(r,t={}){if(!r)throw new Error("key argument is required");const n=yield e.post("config",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});return(yield n.json()).Value})),createGetAll=configure(e=>(...r)=>__async(null,[...r],function*(r={}){const t=yield e.post("config/show",{signal:r.signal,searchParams:toUrlSearchParams(__spreadValues({},r)),headers:r.headers});return yield t.json()})),createReplace=configure(e=>(r,...t)=>__async(null,[r,...t],function*(r,t={}){const n=new AbortController,o=abortSignal(n.signal,t.signal),i=yield e.post("config/replace",__spreadValues({signal:o,searchParams:toUrlSearchParams(t)},yield multipartRequest([fromString$3(JSON.stringify(r))],n,t.headers)));yield i.text()})),createSet=configure(e=>(r,t,...n)=>__async(null,[r,t,...n],function*(r,t,n={}){if("string"!=typeof r)throw new Error("Invalid key type");const o=__spreadValues(__spreadValues({},n),encodeParam(r,t)),i=yield e.post("config",{signal:n.signal,searchParams:toUrlSearchParams(o),headers:n.headers});yield i.text()})),encodeParam=(e,r)=>{switch(typeof r){case"boolean":return{arg:[e,r.toString()],bool:!0};case"string":return{arg:[e,r]};default:return{arg:[e,JSON.stringify(r)],json:!0}}};function createConfig(e){return{getAll:createGetAll(e),get:createGet$4(e),set:createSet(e),replace:createReplace(e),profiles:createProfiles(e)}}const createExport$1=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("dag/export",{signal:t.signal,searchParams:toUrlSearchParams({arg:r.toString()}),headers:t.headers}));yield*__yieldStar(n.iterator())})});function resolve(e,r,t,n,o){return __asyncGenerator(this,null,function*(){const i=e=>__async(null,null,function*(){const r=yield t.getCodec(e.code),i=yield n(e,o);return r.decode(i)}),s=r.split("/").filter(Boolean);let a=yield new __await(i(e)),c=e;for(;s.length;){const e=s.shift();if(!e)throw errCode(new Error(`Could not resolve path "${r}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw errCode(new Error(`no link named "${e}" under ${c}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:s.join("/")};const t=CID$1.asCID(a);t&&(c=t,a=yield new __await(i(a)))}yield{value:a,remainderPath:""}})}function first(e){return __async(this,null,function*(){try{for(var r,t,n,o=__forAwait(e);r=!(t=yield o.next()).done;r=!1)return t.value}catch(t){n=[t]}finally{try{r&&(t=o.return)&&(yield t.call(o))}finally{if(n)throw n[0]}}})}function last(e){return __async(this,null,function*(){let r;try{for(var t,n,o,i=__forAwait(e);t=!(n=yield i.next()).done;t=!1)r=n.value}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield n.call(i))}finally{if(o)throw o[0]}}return r})}const createGet$3=(e,r)=>configure((r,t)=>{const n=createGet$5(t);return(r,...t)=>__async(null,[r,...t],function*(r,t={}){if(t.path){const o=t.localResolve?yield first(resolve(r,t.path,e,n,t)):yield last(resolve(r,t.path,e,n,t));if(!o)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return o}const o=yield e.getCodec(r.code),i=yield n(r,t);return{value:o.decode(i),remainderPath:""}})})(r),createImport$1=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=new AbortController,o=abortSignal(n.signal,t.signal),{headers:i,body:s}=yield new __await(multipartRequest(r,n,t.headers)),a=yield new __await(e.post("dag/import",{signal:o,headers:i,body:s,searchParams:toUrlSearchParams({"pin-roots":t.pinRoots})}));try{for(var c,u,l,d=__forAwait(a.ndjson());c=!(u=yield new __await(d.next())).done;c=!1){const{Root:e}=u.value;if(void 0!==e){const{Cid:{"/":r},PinErrorMsg:t}=e;yield{root:{cid:CID$1.parse(r),pinErrorMsg:t}}}}}catch(u){l=[u]}finally{try{c&&(u=d.return)&&(yield new __await(u.call(d)))}finally{if(l)throw l[0]}}})}),createPut$2=(e,r)=>configure(r=>(t,...n)=>__async(null,[t,...n],function*(t,n={}){const o=__spreadValues({storeCodec:"dag-cbor",hashAlg:"sha2-256"},n);let i;if(o.inputCodec){if(!(t instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=t}else i=(yield e.getCodec(o.storeCodec)).encode(t),o.inputCodec=o.storeCodec;const s=new AbortController,a=abortSignal(s.signal,o.signal),c=yield r.post("dag/put",__spreadValues({timeout:o.timeout,signal:a,searchParams:toUrlSearchParams(o)},yield multipartRequest([i],s,o.headers))),u=yield c.json();return CID$1.parse(u.Cid["/"])}))(r),createResolve$2=configure(e=>(r,...t)=>__async(null,[r,...t],function*(r,t={}){const n=yield e.post("dag/resolve",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r}${t.path?`/${t.path}`.replace(/\/[/]+/g,"/"):""}`},t)),headers:t.headers}),o=yield n.json();return{cid:CID$1.parse(o.Cid["/"]),remainderPath:o.RemPath}}));function createDag(e,r){return{export:createExport$1(r),get:createGet$3(e,r),import:createImport$1(r),put:createPut$2(e,r),resolve:createResolve$2(r)}}const SendingQuery=0,PeerResponse=1,FinalPeer=2,QueryError=3,Provider=4,Value=5,AddingPeer=6,DialingPeer=7,mapEvent=e=>{var r;if(e.Type===SendingQuery)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===PeerResponse)return{from:peerIdFromString(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:e,Addrs:r})=>({id:peerIdFromString(e),multiaddrs:r.map(e=>multiaddr$1(e)),protocols:[]})),providers:(e.Responses||[]).map(({ID:e,Addrs:r})=>({id:peerIdFromString(e),multiaddrs:r.map(e=>multiaddr$1(e)),protocols:[]}))};if(e.Type===FinalPeer){let t={id:null!=(r=e.ID)?r:peerIdFromString(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:peerIdFromString(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(e=>multiaddr$1(e)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===QueryError)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===Provider)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:e,Addrs:r})=>({id:peerIdFromString(e),multiaddrs:r.map(e=>multiaddr$1(e)),protocols:[]}))};if(e.Type===Value)return{name:"VALUE",type:e.Type,value:fromString$3(e.Extra,"base64pad")};if(e.Type===AddingPeer){const r=e.Responses.map(({ID:e})=>peerIdFromString(e));if(!r.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:r[0]}}if(e.Type===DialingPeer)return{name:"DIALING_PEER",type:e.Type,peer:peerIdFromString(e.ID)};throw new Error("Unknown DHT event type")},createFindPeer=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("dht/findpeer",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield mapEvent(e)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})}),createFindProvs=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("dht/findprovs",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield mapEvent(e)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})}),createGet$2=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("dht/get",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r instanceof Uint8Array?toString$3(r):r.toString()},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield mapEvent(e)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})}),createProvide=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={recursive:!1}){const n=Array.isArray(r)?r:[r],o=yield new __await(e.post("dht/provide",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:n.map(e=>e.toString())},t)),headers:t.headers}));try{for(var i,s,a,c=__forAwait(o.ndjson());i=!(s=yield new __await(c.next())).done;i=!1){const e=s.value;yield mapEvent(e)}}catch(s){a=[s]}finally{try{i&&(s=c.return)&&(yield new __await(s.call(c)))}finally{if(a)throw a[0]}}})}),createPut$1=configure(e=>function(r,t){return __asyncGenerator(this,arguments,function*(r,t,n={}){const o=new AbortController,i=abortSignal(o.signal,n.signal),s=yield new __await(e.post("dht/put",__spreadValues({signal:i,searchParams:toUrlSearchParams(__spreadValues({arg:r instanceof Uint8Array?toString$3(r):r.toString()},n))},yield new __await(multipartRequest([t],o,n.headers)))));try{for(var a,c,u,l=__forAwait(s.ndjson());a=!(c=yield new __await(l.next())).done;a=!1){const e=c.value;yield mapEvent(e)}}catch(c){u=[c]}finally{try{a&&(c=l.return)&&(yield new __await(c.call(l)))}finally{if(u)throw u[0]}}})}),createQuery=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("dht/query",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield mapEvent(e)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})});function createDht(e){return{findPeer:createFindPeer(e),findProvs:createFindProvs(e),get:createGet$2(e),provide:createProvide(e),put:createPut$1(e),query:createQuery(e)}}const createCmds=configure(e=>function(){return __async(this,arguments,function*(r={}){return(yield e.post("diag/cmds",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()})}),createNet=configure(e=>function(){return __async(this,arguments,function*(r={}){return(yield e.post("diag/net",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()})}),createSys=configure(e=>function(){return __async(this,arguments,function*(r={}){return(yield e.post("diag/sys",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()})});function createDiag(e){return{cmds:createCmds(e),net:createNet(e),sys:createSys(e)}}const createChmod=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=yield e.post("files/chmod",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r,mode:t},n)),headers:n.headers});yield o.text()})}),createCp=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=Array.isArray(r)?r:[r],i=yield e.post("files/cp",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:o.concat(t).map(e=>CID$1.asCID(e)?`/ipfs/${e}`:e)},n)),headers:n.headers});yield i.text()})}),createFlush=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){if(!r||"string"!=typeof r)throw new Error("ipfs.files.flush requires a path");const n=yield e.post("files/flush",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),o=yield n.json();return CID$1.parse(o.Cid)})});function objectToCamelWithMetadata(e){const r=objectToCamel(e);return Object.prototype.hasOwnProperty.call(r,"mode")&&(r.mode=parseInt(r.mode,8)),Object.prototype.hasOwnProperty.call(r,"mtime")&&(r.mtime={secs:r.mtime,nsecs:r.mtimeNsecs||0},delete r.mtimeNsecs),r}const createLs$6=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){if(!r)throw new Error("ipfs.files.ls requires a path");const n=yield new __await(e.post("files/ls",{signal:t.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({arg:CID$1.asCID(r)?`/ipfs/${r}`:r,long:!0},t),{stream:!0})),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;if("Entries"in e)for(const r of e.Entries||[])yield toCoreInterface$2(objectToCamelWithMetadata(r));else yield toCoreInterface$2(objectToCamelWithMetadata(e))}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})});function toCoreInterface$2(e){return e.hash&&(e.cid=CID$1.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const createMkdir=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("files/mkdir",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});yield n.text()})}),createMv=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){Array.isArray(r)||(r=[r]);const o=yield e.post("files/mv",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.concat(t)},n)),headers:n.headers});yield o.text()})});var source,hasRequiredSource;function requireSource(){return hasRequiredSource?source:(hasRequiredSource=1,source=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return function(){return __asyncGenerator(this,null,function*(){const r=e.getReader();try{for(;;){const{done:e,value:t}=yield new __await(r.read());if(e)return;yield t}}finally{r.releaseLock()}})}();throw new Error("unknown stream")})}var sourceExports=requireSource();const toIterable=getDefaultExportFromCjs(sourceExports),createRead=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("files/read",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r,count:t.length},t)),headers:t.headers}));yield*__yieldStar(toIterable(n.body))})}),createRm$4=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("files/rm",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),o=yield n.text();if(""!==o){const e=new HTTP.HTTPError(n);throw e.message=o,e}})}),createStat$2=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("files/stat",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),o=yield n.json();return o.WithLocality=o.WithLocality||!1,toCoreInterface$1(objectToCamelWithMetadata(o))})});function toCoreInterface$1(e){return e.cid=CID$1.parse(e.hash),delete e.hash,e}const createTouch=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("files/touch",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});yield n.text()})}),createWrite=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=new AbortController,i=abortSignal(o.signal,n.signal),s=yield e.post("files/write",__spreadValues({signal:i,searchParams:toUrlSearchParams(__spreadValues({arg:r,streamChannels:!0,count:n.length},n))},yield multipartRequest([{content:t,path:"arg",mode:modeToString$1(n.mode),mtime:parseMtime$1(n.mtime)}],o,n.headers)));yield s.text()})});function createFiles(e){return{chmod:createChmod(e),cp:createCp(e),flush:createFlush(e),ls:createLs$6(e),mkdir:createMkdir(e),mv:createMv(e),read:createRead(e),rm:createRm$4(e),stat:createStat$2(e),touch:createTouch(e),write:createWrite(e)}}const createExport=configure(e=>(e,r,...t)=>__async(null,[e,r,...t],function*(e,r,t={}){throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),createGen=configure(e=>function(r,t){return __async(this,null,function*(){const n=null!=t?t:{type:"Ed25519"},o=yield e.post("key/gen",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},n)),headers:n.headers});return objectToCamel(yield o.json())})}),createImport=configure(e=>function(r,t,n){return __async(this,arguments,function*(r,t,n,o={}){const i=yield e.post("key/import",{signal:o.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r,pem:t,password:n},o)),headers:o.headers});return objectToCamel(yield i.json())})}),createInfo=configure(e=>(e,...r)=>__async(null,[e,...r],function*(e,r={}){throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),createList=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("key/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return((yield t.json()).Keys||[]).map(e=>objectToCamel(e))})}),createRename=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=yield e.post("key/rename",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:[r,t]},n)),headers:n.headers});return objectToCamel(yield o.json())})}),createRm$3=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("key/rm",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});return objectToCamel((yield n.json()).Keys[0])})});function createKey(e){return{export:createExport(e),gen:createGen(e),import:createImport(e),info:createInfo(e),list:createList(e),rename:createRename(e),rm:createRm$3(e)}}const createLevel=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=yield e.post("log/level",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:[r,t]},n)),headers:n.headers});return objectToCamel(yield o.json())})}),createLs$5=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("log/ls",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return(yield t.json()).Strings})}),createTail=configure(e=>function(){return __asyncGenerator(this,arguments,function*(r={}){const t=yield new __await(e.post("log/tail",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}));yield*__yieldStar(t.ndjson())})});function createLog(e){return{level:createLevel(e),ls:createLs$5(e),tail:createTail(e)}}const createPublish$1=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("name/publish",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r}`},t)),headers:t.headers});return objectToCamel(yield n.json())})}),createResolve$1=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("name/resolve",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r,stream:!0},t)),headers:t.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;yield e.Path}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})}),createCancel=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("name/pubsub/cancel",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});return objectToCamel(yield n.json())})}),createState=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("name/pubsub/state",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return objectToCamel(yield t.json())})}),createSubs=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("name/pubsub/subs",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return(yield t.json()).Strings||[]})});function createPubsub$1(e){return{cancel:createCancel(e),state:createState(e),subs:createSubs(e)}}function createName(e){return{publish:createPublish$1(e),resolve:createResolve$1(e),pubsub:createPubsub$1(e)}}const createData=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("object/data",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`},t)),headers:t.headers}),o=yield n.arrayBuffer();return new Uint8Array(o,0,o.byteLength)})}),createGet$1=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("object/get",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`,dataEncoding:"base64"},t)),headers:t.headers}),o=yield n.json();return{Data:fromString$3(o.Data,"base64pad"),Links:(o.Links||[]).map(e=>({Name:e.Name,Hash:CID$1.parse(e.Hash),Tsize:e.Size}))}})}),createLinks=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("object/links",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`},t)),headers:t.headers});return((yield n.json()).Links||[]).map(e=>({Name:e.Name,Tsize:e.Size,Hash:CID$1.parse(e.Hash)}))})}),createNew=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("object/new",{signal:r.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.template},r)),headers:r.headers}),{Hash:n}=yield t.json();return CID$1.parse(n)})}),createPut=(e,r)=>configure(t=>{const n=createPut$2(e,r);return function(e){return __async(this,arguments,function*(e,r={}){return n(e,__spreadProps(__spreadValues({},r),{storeCodec:"dag-pb",hashAlg:"sha2-256",version:1}))})}})(r),createStat$1=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("object/stat",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r}`},t)),headers:t.headers}),o=yield n.json();return __spreadProps(__spreadValues({},o),{Hash:CID$1.parse(o.Hash)})})}),createAddLink=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=yield e.post("object/patch/add-link",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:[`${r}`,t.Name||t.name||"",(t.Hash||t.cid||"").toString()||null]},n)),headers:n.headers}),{Hash:i}=yield o.json();return CID$1.parse(i)})}),createAppendData=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=new AbortController,i=abortSignal(o.signal,n.signal),s=yield e.post("object/patch/append-data",__spreadValues({signal:i,searchParams:toUrlSearchParams(__spreadValues({arg:`${r}`},n))},yield multipartRequest([t],o,n.headers))),{Hash:a}=yield s.json();return CID$1.parse(a)})}),createRmLink=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=yield e.post("object/patch/rm-link",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:[`${r}`,t.Name||t.name||null]},n)),headers:n.headers}),{Hash:i}=yield o.json();return CID$1.parse(i)})}),createSetData=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=new AbortController,i=abortSignal(o.signal,n.signal),s=yield e.post("object/patch/set-data",__spreadValues({signal:i,searchParams:toUrlSearchParams(__spreadValues({arg:[`${r}`]},n))},yield multipartRequest([t],o,n.headers))),{Hash:a}=yield s.json();return CID$1.parse(a)})});function createPatch(e){return{addLink:createAddLink(e),appendData:createAppendData(e),rmLink:createRmLink(e),setData:createSetData(e)}}function createObject(e,r){return{data:createData(r),get:createGet$1(r),links:createLinks(r),new:createNew(r),put:createPut(e,r),stat:createStat$1(r),patch:createPatch(r)}}function isIterable(e){return Symbol.iterator in e}function isAsyncIterable(e){return Symbol.asyncIterator in e}function isCID(e){return null!=CID$1.asCID(e)}function normaliseInput$1(e){return __asyncGenerator(this,null,function*(){if(null==e)throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const r=CID$1.asCID(e);if(r)yield toPin$1({cid:r});else{if(!(e instanceof String||"string"==typeof e)){if(null!=e.cid||null!=e.path)return yield toPin$1(e);if(isIterable(e)){const r=e[Symbol.iterator](),t=r.next();if(t.done)return r;if(isCID(t.value)){yield toPin$1({cid:t.value});for(const e of r)yield toPin$1({cid:e});return}if(t.value instanceof String||"string"==typeof t.value){yield toPin$1({path:t.value});for(const e of r)yield toPin$1({path:e});return}if(null!=t.value.cid||null!=t.value.path){yield toPin$1(t.value);for(const e of r)yield toPin$1(e);return}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(isAsyncIterable(e)){const r=e[Symbol.asyncIterator](),p=yield new __await(r.next());if(p.done)return r;if(isCID(p.value)){yield toPin$1({cid:p.value});try{for(var t,n,o,i=__forAwait(r);t=!(n=yield new __await(i.next())).done;t=!1){const e=n.value;yield toPin$1({cid:e})}}catch(n){o=[n]}finally{try{t&&(n=i.return)&&(yield new __await(n.call(i)))}finally{if(o)throw o[0]}}return}if(p.value instanceof String||"string"==typeof p.value){yield toPin$1({path:p.value});try{for(var s,a,c,u=__forAwait(r);s=!(a=yield new __await(u.next())).done;s=!1){const e=a.value;yield toPin$1({path:e})}}catch(a){c=[a]}finally{try{s&&(a=u.return)&&(yield new __await(a.call(u)))}finally{if(c)throw c[0]}}return}if(null!=p.value.cid||null!=p.value.path){yield toPin$1(p.value);try{for(var l,d,f,h=__forAwait(r);l=!(d=yield new __await(h.next())).done;l=!1){const e=d.value;yield toPin$1(e)}}catch(d){f=[d]}finally{try{l&&(d=h.return)&&(yield new __await(d.call(h)))}finally{if(f)throw f[0]}}return}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield toPin$1({path:e})}})}function toPin$1(e){const r=e.cid||`${e.path}`;if(!r)throw errCode(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const t={path:r,recursive:!1!==e.recursive};return null!=e.metadata&&(t.metadata=e.metadata),t}const createAddAll$1=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){try{for(var n,o,i,s=__forAwait(normaliseInput$1(r));n=!(o=yield new __await(s.next())).done;n=!1){const{path:r,recursive:n,metadata:i}=o.value,s=yield new __await(e.post("pin/add",{signal:t.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},t),{arg:r,recursive:n,metadata:i?JSON.stringify(i):void 0,stream:!0})),headers:t.headers}));try{for(var a,c,u,l=__forAwait(s.ndjson());a=!(c=yield new __await(l.next())).done;a=!1){const e=c.value;if(e.Pins)for(const r of e.Pins)yield CID$1.parse(r);else yield CID$1.parse(e)}}catch(c){u=[c]}finally{try{a&&(c=l.return)&&(yield new __await(c.call(l)))}finally{if(u)throw u[0]}}}}catch(o){i=[o]}finally{try{n&&(o=s.return)&&(yield new __await(o.call(s)))}finally{if(i)throw i[0]}}})});function createAdd$3(e){const r=createAddAll$1(e);return configure(()=>function(e){return __async(this,arguments,function*(e,t={}){return last(r([__spreadValues({path:e},t)],t))})})(e)}function toPin(e,r,t){const n={type:e,cid:CID$1.parse(r)};return t&&(n.metadata=t),n}const createLs$4=configure(e=>function(){return __asyncGenerator(this,arguments,function*(r={}){let t=[];r.paths&&(t=Array.isArray(r.paths)?r.paths:[r.paths]);const n=yield new __await(e.post("pin/ls",{signal:r.signal,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},r),{arg:t.map(e=>`${e}`),stream:!0})),headers:r.headers}));try{for(var o,i,s,a=__forAwait(n.ndjson());o=!(i=yield new __await(a.next())).done;o=!1){const e=i.value;if(e.Keys){for(const r of Object.keys(e.Keys))yield toPin(e.Keys[r].Type,r,e.Keys[r].Metadata);return}yield toPin(e.Type,e.Cid,e.Metadata)}}catch(i){s=[i]}finally{try{o&&(i=a.return)&&(yield new __await(i.call(a)))}finally{if(s)throw s[0]}}})}),createRmAll$1=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){try{for(var n,o,i,s=__forAwait(normaliseInput$1(r));n=!(o=yield new __await(s.next())).done;n=!1){const{path:r,recursive:n}=o.value,i=new URLSearchParams(t.searchParams);i.append("arg",`${r}`),null!=n&&i.set("recursive",String(n));const s=yield new __await(e.post("pin/rm",{signal:t.signal,headers:t.headers,searchParams:toUrlSearchParams(__spreadProps(__spreadValues({},t),{arg:`${r}`,recursive:n}))}));try{for(var a,c,u,l=__forAwait(s.ndjson());a=!(c=yield new __await(l.next())).done;a=!1){const e=c.value;e.Pins?yield*__yieldStar(e.Pins.map(e=>CID$1.parse(e))):yield CID$1.parse(e)}}catch(c){u=[c]}finally{try{a&&(c=l.return)&&(yield new __await(c.call(l)))}finally{if(u)throw u[0]}}}}catch(o){i=[o]}finally{try{n&&(o=s.return)&&(yield new __await(o.call(s)))}finally{if(i)throw i[0]}}})}),createRm$2=e=>{const r=createRmAll$1(e);return configure(()=>function(e){return __async(this,arguments,function*(e,t={}){return last(r([__spreadValues({path:e},t)],t))})})(e)},decodePin=({Name:e,Status:r,Cid:t})=>({cid:CID$1.parse(t),name:e,status:r}),encodeService=e=>{if("string"==typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},encodeCID=e=>{if(CID$1.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},encodeQuery=({service:e,cid:r,name:t,status:n,all:o})=>{const i=toUrlSearchParams({service:encodeService(e),name:t,force:!!o||void 0});if(r)for(const s of r)i.append("cid",encodeCID(s));if(n)for(const s of n)i.append("status",s);return i},encodeAddParams=({cid:e,service:r,background:t,name:n,origins:o})=>{const i=toUrlSearchParams({arg:encodeCID(e),service:encodeService(r),name:n,background:!!t||void 0});if(o)for(const s of o)i.append("origin",s.toString());return i};function createAdd$2(e){return function(r,t){return __async(this,null,function*(){var n=t,{timeout:o,signal:i,headers:s}=n,a=__objRest(n,["timeout","signal","headers"]);const c=yield e.post("pin/remote/add",{timeout:o,signal:i,headers:s,searchParams:encodeAddParams(__spreadValues({cid:r},a))});return decodePin(yield c.json())})}}function createLs$3(e){return function(r){return __asyncGenerator(this,null,function*(){var t=r,{timeout:n,signal:o,headers:i}=t,s=__objRest(t,["timeout","signal","headers"]);const a=yield new __await(e.post("pin/remote/ls",{timeout:n,signal:o,headers:i,searchParams:encodeQuery(s)}));try{for(var c,u,l,d=__forAwait(a.ndjson());c=!(u=yield new __await(d.next())).done;c=!1){const e=u.value;yield decodePin(e)}}catch(u){l=[u]}finally{try{c&&(u=d.return)&&(yield new __await(u.call(d)))}finally{if(l)throw l[0]}}})}}function createRm$1(e){return function(r){return __async(this,null,function*(){var t=r,{timeout:n,signal:o,headers:i}=t,s=__objRest(t,["timeout","signal","headers"]);yield e.post("pin/remote/rm",{timeout:n,signal:o,headers:i,searchParams:encodeQuery(__spreadProps(__spreadValues({},s),{all:!1}))})})}}function createRmAll(e){return function(r){return __async(this,null,function*(){var t=r,{timeout:n,signal:o,headers:i}=t,s=__objRest(t,["timeout","signal","headers"]);yield e.post("pin/remote/rm",{timeout:n,signal:o,headers:i,searchParams:encodeQuery(__spreadProps(__spreadValues({},s),{all:!0}))})})}}function encodeEndpoint(e){const r=String(e);if("undefined"===r)throw Error("endpoint is required");return"/"===r[r.length-1]?r.slice(0,-1):r}function decodeRemoteService(e){return __spreadValues({service:e.Service,endpoint:new URL(e.ApiEndpoint)},e.Stat&&{stat:decodeStat(e.Stat)})}function decodeStat(e){switch(e.Status){case"valid":{const{Pinning:r,Pinned:t,Queued:n,Failed:o}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:t,failed:o}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function createAdd$1(e){return function(r,t){return __async(this,null,function*(){const{endpoint:n,key:o,headers:i,timeout:s,signal:a}=t;yield e.post("pin/remote/service/add",{timeout:s,signal:a,searchParams:toUrlSearchParams({arg:[r,encodeEndpoint(n),o]}),headers:i})})}}function createLs$2(e){return function(){return __async(this,arguments,function*(r={}){const{stat:t,headers:n,timeout:o,signal:i}=r,s=yield e.post("pin/remote/service/ls",{timeout:o,signal:i,headers:n,searchParams:!0===t?toUrlSearchParams({stat:t}):void 0}),{RemoteServices:a}=yield s.json();return a.map(decodeRemoteService)})}}function createRm(e){return function(r){return __async(this,arguments,function*(r,t={}){yield e.post("pin/remote/service/rm",{signal:t.signal,headers:t.headers,searchParams:toUrlSearchParams({arg:r})})})}}function createService(e){const r=new Client(e);return{add:createAdd$1(r),ls:createLs$2(r),rm:createRm(r)}}function createRemote(e){const r=new Client(e);return{add:createAdd$2(r),ls:createLs$3(r),rm:createRm$1(r),rmAll:createRmAll(r),service:createService(e)}}function createPin(e){return{addAll:createAddAll$1(e),add:createAdd$3(e),ls:createLs$4(e),rmAll:createRmAll$1(e),rm:createRm$2(e),remote:createRemote(e)}}const rpcArrayToTextArray=e=>Array.isArray(e)?e.map(rpcToText):e,rpcToText=e=>toString$3(rpcToBytes(e)),rpcToBytes=e=>base64url$2.decode(e),rpcToBigInt=e=>BigInt(`0x${toString$3(base64url$2.decode(e),"base16")}`),textToUrlSafeRpc=e=>base64url$2.encode(fromString$3(e)),createLs$1=configure(e=>function(){return __async(this,arguments,function*(r={}){const{Strings:t}=yield(yield e.post("pubsub/ls",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json();return rpcArrayToTextArray(t)||[]})}),createPeers$1=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("pubsub/peers",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:textToUrlSafeRpc(r)},t)),headers:t.headers}),{Strings:o}=yield n.json();return o||[]})}),createPublish=configure(e=>function(r,t){return __async(this,arguments,function*(r,t,n={}){const o=toUrlSearchParams(__spreadValues({arg:textToUrlSafeRpc(r)},n)),i=new AbortController,s=abortSignal(i.signal,n.signal),a=yield e.post("pubsub/pub",__spreadValues({signal:s,searchParams:o},yield multipartRequest([t],i,n.headers)));yield a.text()})}),log=logger("ipfs-http-client:pubsub:subscribe"),createSubscribe=(e,r)=>configure(e=>function(t,n){return __async(this,arguments,function*(t,n,o={}){let i,s;o.signal=r.subscribe(t,n,o.signal);const a=new Promise((e,r)=>{i=e,s=r}),c=setTimeout(()=>i(),1e3);return e.post("pubsub/sub",{signal:o.signal,searchParams:toUrlSearchParams(__spreadValues({arg:textToUrlSafeRpc(t)},o)),headers:o.headers}).catch(e=>{r.unsubscribe(t,n),s(e)}).then(e=>{clearTimeout(c),e&&(readMessages(e,{onMessage:e=>{n&&("function"!=typeof n?"function"==typeof n.handleEvent&&n.handleEvent(e):n(e))},onEnd:()=>r.unsubscribe(t,n),onError:o.onError}),i())}),a})})(e);function readMessages(e,r){return __async(this,arguments,function*(e,{onMessage:r,onEnd:t,onError:n}){var o,i;n=n||log;try{try{for(var s,a,c,u=__forAwait(e.ndjson());s=!(a=yield u.next()).done;s=!1){const e=a.value;try{if(!e.from)continue;null!=e.from&&null!=e.seqno?r({type:"signed",from:peerIdFromString(e.from),data:rpcToBytes(e.data),sequenceNumber:rpcToBigInt(e.seqno),topic:rpcToText(e.topicIDs[0]),key:rpcToBytes(null!=(o=e.key)?o:"u"),signature:rpcToBytes(null!=(i=e.signature)?i:"u")}):r({type:"unsigned",data:rpcToBytes(e.data),topic:rpcToText(e.topicIDs[0])})}catch(l){l.message=`Failed to parse pubsub message: ${l.message}`,n(l,!1,e)}}}catch(a){c=[a]}finally{try{s&&(a=u.return)&&(yield a.call(u))}finally{if(c)throw c[0]}}}catch(l){isAbortError(l)||n(l,!0)}finally{t()}})}const isAbortError=e=>{switch(e.type){case"aborted":case"abort":return!0;default:return"AbortError"===e.name}},createUnsubscribe=(e,r)=>function(e,t){return __async(this,null,function*(){r.unsubscribe(e,t)})};class SubscriptionTracker{constructor(){this._subs=new Map}subscribe(e,r,t){const n=this._subs.get(e)||[];if(n.find(e=>e.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);const o=new AbortController;return this._subs.set(e,[{handler:r,controller:o}].concat(n)),t&&t.addEventListener("abort",()=>this.unsubscribe(e,r)),o.signal}unsubscribe(e,r){const t=this._subs.get(e)||[];let n;r?(this._subs.set(e,t.filter(e=>e.handler!==r)),n=t.filter(e=>e.handler===r)):(this._subs.set(e,[]),n=t),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(e=>e.controller.abort())}}function createPubsub(e){const r=new SubscriptionTracker;return{ls:createLs$1(e),peers:createPeers$1(e),publish:createPublish(e),subscribe:createSubscribe(e,r),unsubscribe:createUnsubscribe(e,r)}}const createLocal=configure(e=>function(){return __asyncGenerator(this,arguments,function*(r={}){const t=yield new __await(e.post("refs/local",{signal:r.signal,transform:objectToCamel,searchParams:toUrlSearchParams(r),headers:r.headers}));yield*__yieldStar(t.ndjson())})}),createRefs=configure((e,r)=>Object.assign(function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=Array.isArray(r)?r:[r],o=yield new __await(e.post("refs",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:n.map(e=>`${e instanceof Uint8Array?CID$1.decode(e):e}`)},t)),headers:t.headers,transform:objectToCamel}));yield*__yieldStar(o.ndjson())})},{local:createLocal(r)})),createGc=configure(e=>function(){return __asyncGenerator(this,arguments,function*(r={}){const t=yield new __await(e.post("repo/gc",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?CID$1.parse(e.Key["/"]):null})}));yield*__yieldStar(t.ndjson())})}),createStat=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("repo/stat",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),n=yield t.json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}})}),createVersion$1=configure(e=>function(){return __async(this,arguments,function*(r={}){return(yield(yield e.post("repo/version",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Version})});function createRepo(e){return{gc:createGc(e),stat:createStat(e),version:createVersion$1(e)}}const createBw=configure(e=>function(){return __asyncGenerator(this,arguments,function*(r={}){const t=yield new __await(e.post("stats/bw",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})}));yield*__yieldStar(t.ndjson())})});function createStats(e){return{bitswap:createStat$4(e),repo:createStat(e),bw:createBw(e)}}const createAddrs=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("swarm/addrs",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Addrs:n}=yield t.json();return Object.keys(n).map(e=>({id:peerIdFromString(e),addrs:(n[e]||[]).map(e=>multiaddr$1(e))}))})}),createConnect=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("swarm/connect",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),{Strings:o}=yield n.json();return o||[]})}),createDisconnect=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("swarm/disconnect",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),{Strings:o}=yield n.json();return o||[]})}),createLocalAddrs=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("swarm/addrs/local",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Strings:n}=yield t.json();return(n||[]).map(e=>multiaddr$1(e))})}),createPeers=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("swarm/peers",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Peers:n}=yield t.json();return(n||[]).map(e=>({addr:multiaddr$1(e.Addr),peer:peerIdFromString(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"}))})});function createSwarm(e){return{addrs:createAddrs(e),connect:createConnect(e),disconnect:createDisconnect(e),localAddrs:createLocalAddrs(e),peers:createPeers(e)}}const createAddAll=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=new AbortController,o=abortSignal(n.signal,t.signal),{headers:i,body:s,total:a,parts:c}=yield new __await(multipartRequest(r,n,t.headers)),[u,l]="function"==typeof t.progress?createProgressHandler(a,c,t.progress):[void 0,void 0],d=yield new __await(e.post("add",{searchParams:toUrlSearchParams(__spreadProps(__spreadValues({"stream-channels":!0},t),{progress:Boolean(u)})),onUploadProgress:l,signal:o,headers:i,body:s}));try{for(var f,h,p,y=__forAwait(d.ndjson());f=!(h=yield new __await(y.next())).done;f=!1){let e=h.value;e=objectToCamel(e),void 0!==e.hash?yield toCoreInterface(e):u&&u(e.bytes||0,e.name)}}catch(h){p=[h]}finally{try{f&&(h=y.return)&&(yield new __await(h.call(y)))}finally{if(p)throw p[0]}}})}),createProgressHandler=(e,r,t)=>r?[void 0,createOnUploadProgress(e,r,t)]:[t,void 0],createOnUploadProgress=(e,r,t)=>{let n=0;const o=r.length;return({loaded:i,total:s})=>{const a=Math.floor(i/s*e);for(;n<o;){const{start:e,end:o,name:i}=r[n];if(a<o){t(a-e,i);break}t(o-e,i),n+=1}}};function toCoreInterface({name:e,hash:r,size:t,mode:n,mtime:o,mtimeNsecs:i}){const s={path:e,cid:CID$1.parse(r),size:parseInt(t)};return null!=n&&(s.mode=parseInt(n,8)),null!=o&&(s.mtime={secs:o,nsecs:i||0}),s}function blobToIt(e){return"function"==typeof e.stream?browserReadableStreamToIt(e.stream()):browserReadableStreamToIt(new Response(e).body)}function toAsyncIterable(e){return __asyncGenerator(this,null,function*(){yield e})}function normaliseContent(e){return __async(this,null,function*(){if(isBytes(e))return toAsyncIterable(toBytes(e));if("string"==typeof e||e instanceof String)return toAsyncIterable(toBytes(e.toString()));if(isBlob(e))return blobToIt(e);if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=peekableIterator(e),{value:t,done:n}=yield r.peek();if(n)return toAsyncIterable(new Uint8Array(0));if(r.push(t),Number.isInteger(t))return toAsyncIterable(Uint8Array.from(yield all(r)));if(isBytes(t)||"string"==typeof t||t instanceof String)return map(r,toBytes)}throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")})}function toBytes(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):fromString$3(e.toString())}function normaliseCandidateSingle(e,r){return __asyncGenerator(this,null,function*(){if(null==e)throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if("string"==typeof e||e instanceof String)yield toFileObject(e.toString(),r);else if(isBytes(e)||isBlob(e))yield toFileObject(e,r);else{if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=peekableIterator(e),{value:n,done:o}=yield new __await(t.peek());if(o)return void(yield{content:[]});if(t.push(n),Number.isInteger(n)||isBytes(n)||"string"==typeof n||n instanceof String)return void(yield toFileObject(t,r));throw errCode(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!isFileObject(e))throw errCode(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield toFileObject(e,r)}})}function toFileObject(e,r){return __async(this,null,function*(){const{path:t,mode:n,mtime:o,content:i}=e,s={path:t||"",mode:parseMode(n),mtime:parseMtime(o)};return i?s.content=yield r(i):t||(s.content=yield r(e)),s})}function normaliseInput(e){return normaliseCandidateSingle(e,normaliseContent)}function createAdd(e){const r=createAddAll(e);return configure(()=>function(e){return __async(this,arguments,function*(e,t={}){return yield last(r(normaliseInput(e),t))})})(e)}const createCat=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("cat",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.toString()},t)),headers:t.headers}));yield*__yieldStar(n.iterator())})}),createCommands=configure(e=>(...r)=>__async(null,[...r],function*(r={}){return(yield e.post("commands",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()})),createDns=configure(e=>(r,...t)=>__async(null,[r,...t],function*(r,t={}){const n=yield e.post("dns",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers});return(yield n.json()).Path})),createGetEndpointConfig=configure(e=>()=>{const r=new URL(e.opts.base||"");return{host:r.hostname,port:r.port,protocol:r.protocol,pathname:r.pathname,"api-path":r.pathname}}),createGet=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=__spreadValues({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`},t);n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel);const o=yield new __await(e.post("get",{signal:t.signal,searchParams:toUrlSearchParams(n),headers:t.headers}));yield*__yieldStar(o.iterator())})}),createId=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("id",{signal:r.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r.peerId?r.peerId.toString():void 0},r)),headers:r.headers}),n=yield t.json(),o=__spreadValues({},objectToCamel(n));return o.id=peerIdFromString(o.id),o.addresses&&(o.addresses=o.addresses.map(e=>multiaddr$1(e))),o})}),createIsOnline=e=>{const r=createId(e);return function(){return __async(this,arguments,function*(e={}){const t=yield r(e);return Boolean(t&&t.addresses&&t.addresses.length)})}},createLs=configure((e,r)=>function(t){return __asyncGenerator(this,arguments,function*(t,n={}){const o=`${t instanceof Uint8Array?CID$1.decode(t):t}`;function i(e){return __async(this,null,function*(){let t=e.Hash;if(t.includes("/")){const e=t.startsWith("/ipfs/")?t:`/ipfs/${t}`;t=(yield createStat$2(r)(e)).cid}else t=CID$1.parse(t);const n={name:e.Name,path:o+(e.Name?`/${e.Name}`:""),size:e.Size,cid:t,type:typeOf(e)};return e.Mode&&(n.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(n.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(n.mtime.nsecs=e.MtimeNsecs)),n})}const s=yield new __await(e.post("ls",{signal:n.signal,searchParams:toUrlSearchParams(__spreadValues({arg:o},n)),headers:n.headers}));try{for(var a,c,u,l=__forAwait(s.ndjson());a=!(c=yield new __await(l.next())).done;a=!1){let e=c.value;if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const r=e.Links;if(!Array.isArray(r))throw new Error("expected one array in results.Objects[0].Links");if(!r.length)return void(yield i(e));yield*__yieldStar(r.map(i))}}catch(c){u=[c]}finally{try{a&&(c=l.return)&&(yield new __await(c.call(l)))}finally{if(u)throw u[0]}}})});function typeOf(e){switch(e.Type){case 1:case 5:return"dir";default:return"file"}}const createMount=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("dns",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return objectToCamel(yield t.json())})}),createPing=configure(e=>function(r){return __asyncGenerator(this,arguments,function*(r,t={}){const n=yield new __await(e.post("ping",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:`${r}`},t)),headers:t.headers,transform:objectToCamel}));yield*__yieldStar(n.ndjson())})}),createResolve=configure(e=>function(r){return __async(this,arguments,function*(r,t={}){const n=yield e.post("resolve",{signal:t.signal,searchParams:toUrlSearchParams(__spreadValues({arg:r},t)),headers:t.headers}),{Path:o}=yield n.json();return o})}),createStart=configure(e=>(...e)=>__async(null,[...e],function*(e={}){throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),createStop=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("shutdown",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});yield t.text()})}),createVersion=configure(e=>function(){return __async(this,arguments,function*(r={}){const t=yield e.post("version",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return __spreadProps(__spreadValues({},objectToCamel(yield t.json())),{"ipfs-http-client":"1.0.0"})})});var urlSource_1,hasRequiredUrlSource;function requireUrlSource(){if(hasRequiredUrlSource)return urlSource_1;hasRequiredUrlSource=1;const e=requireHttp();function r(r,t){return __asyncGenerator(this,null,function*(){const n=new e,o=yield new __await(n.get(r,t));yield*__yieldStar(o.iterator())})}return urlSource_1=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:r(e,t)})}function create(e={}){const r={name:identity$3.name,code:identity$3.code,encode:e=>e,decode:e=>e},t=Object.values(bases$2);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(e=>t.push(e));const n=new Multibases({bases:t,loadBase:e.ipld&&e.ipld.loadBase}),o=Object.values(codecs$1);[dagPB,dagCBOR,dagJSON,dagJOSE,r].concat(e.ipld&&e.ipld.codecs||[]).forEach(e=>o.push(e));const i=new Multicodecs({codecs:o,loadCodec:e.ipld&&e.ipld.loadCodec}),s=Object.values(hashes);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(e=>s.push(e));const a=new Multihashes({hashers:s,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:createAdd(e),addAll:createAddAll(e),bitswap:createBitswap(e),block:createBlock(e),bootstrap:createBootstrap(e),cat:createCat(e),commands:createCommands(e),config:createConfig(e),dag:createDag(i,e),dht:createDht(e),diag:createDiag(e),dns:createDns(e),files:createFiles(e),get:createGet(e),getEndpointConfig:createGetEndpointConfig(e),id:createId(e),isOnline:createIsOnline(e),key:createKey(e),log:createLog(e),ls:createLs(e),mount:createMount(e),name:createName(e),object:createObject(i,e),pin:createPin(e),ping:createPing(e),pubsub:createPubsub(e),refs:createRefs(e),repo:createRepo(e),resolve:createResolve(e),start:createStart(e),stats:createStats(e),stop:createStop(e),swarm:createSwarm(e),version:createVersion(e),bases:n,codecs:i,hashers:a}}new Proxy({},{get(e,r){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${r}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),requireUrlSource();const index=Object.freeze(Object.defineProperty({__proto__:null,CID:CID$1,create:create,multiaddr:multiaddr$1},Symbol.toStringTag,{value:"Module"}));export{requireScheduler as a,index as i,requireDijkstra as r};
