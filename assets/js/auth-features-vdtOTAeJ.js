import{r as e,j as r}from"./react-vendor-CQugEivN.js";import{I as s}from"./crypto-utils-BTk8JiGR.js";import{S as i}from"./utils-CW0mjxCA.js";const o=({onAuthSuccess:o,onAuthError:a,onCreateId:n,onImportId:t})=>{const[d,m]=e.useState(""),[u,l]=e.useState(""),[c,p]=e.useState(!1),[b,N]=e.useState(null);return r.jsxDEV("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[r.jsxDEV("div",{className:"text-center mb-6",children:[r.jsxDEV("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Welcome Back"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:87,columnNumber:9},void 0),r.jsxDEV("p",{className:"text-gray-600",children:"Sign in to your identity"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:88,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:86,columnNumber:7},void 0),r.jsxDEV("form",{onSubmit:e=>{return r=function*(){if(e.preventDefault(),d.trim()&&u.trim()){p(!0),N(null);try{const e=i.getInstance(),n=yield e.getIdentities();for(const i of n)try{if((yield s.authenticateIdentity(i.encryptedData,u,d)).pnName===d){const r=yield s.decryptIdentity(i.publicKey,u);if(r)return yield e.updateNickname(i.id,i.nickname),void(null==o||o(r))}}catch(r){continue}N(new Error("Invalid username or passcode.")),null==a||a(new Error("Authentication failed"))}catch(r){N(r instanceof Error?r:new Error("Authentication failed")),null==a||a(r instanceof Error?r:new Error("Authentication failed"))}finally{p(!1)}}else N(new Error("Please enter both username and passcode."))},new Promise((s,i)=>{var o=s=>{try{n(r.next(s))}catch(e){i(e)}},a=s=>{try{n(r.throw(s))}catch(e){i(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,a);n((r=r.apply(null,null)).next())});var r},className:"space-y-4",children:[r.jsxDEV("div",{children:[r.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:93,columnNumber:11},void 0),r.jsxDEV("input",{type:"text",id:"username",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your username",required:!0},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:92,columnNumber:9},void 0),r.jsxDEV("div",{children:[r.jsxDEV("label",{htmlFor:"passcode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Passcode"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:108,columnNumber:11},void 0),r.jsxDEV("input",{type:"password",id:"passcode",value:u,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your passcode",required:!0},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:111,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:107,columnNumber:9},void 0),b&&r.jsxDEV("div",{className:"text-red-500 text-sm",children:b.message},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:123,columnNumber:11},void 0),r.jsxDEV("button",{type:"submit",disabled:c,className:"w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Signing in...":"Sign In"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:128,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:91,columnNumber:7},void 0),r.jsxDEV("div",{className:"mt-6 text-center",children:[r.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"Don't have an identity?"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:138,columnNumber:9},void 0),r.jsxDEV("div",{className:"space-y-2",children:[r.jsxDEV("button",{onClick:n,className:"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"Create New Identity"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:140,columnNumber:11},void 0),r.jsxDEV("button",{onClick:t,className:"w-full bg-gray-500 text-white py-2 px-4 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Import Identity"},void 0,!1,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:146,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:139,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:137,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/gamit/pages/par-Noir/apps/id-dashboard/src/components/UnifiedAuth.tsx",lineNumber:85,columnNumber:5},void 0)};export{o as U};
