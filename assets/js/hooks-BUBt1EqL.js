var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&l(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&l(e,a,t[a]);return e},i=(e,n)=>t(e,a(n)),c=(e,t,a)=>new Promise((n,r)=>{var s=e=>{try{o(a.next(e))}catch(t){r(t)}},l=e=>{try{o(a.throw(e))}catch(t){r(t)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,l);o((a=a.apply(e,t)).next())});import{r as d}from"./react-vendor-CQugEivN.js";const u={},m=function(e,t,a){let n=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));n=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in u)return;u[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,r&&n.setAttribute("nonce",r),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},p=()=>{const[e,t]=d.useState({isInstallable:!1,isInstalled:!1,isOnline:navigator.onLine,isInstalling:!1,deferredPrompt:null,serviceWorkerRegistration:null,storageStats:null}),a=d.useCallback(()=>{const e=window.matchMedia("(display-mode: standalone)").matches,a=!0===window.navigator.standalone;t(t=>i(o({},t),{isInstalled:e||a}))},[]),n=d.useCallback(e=>{e.preventDefault(),t(t=>i(o({},t),{deferredPrompt:e,isInstallable:!0}))},[]),r=d.useCallback(()=>{t(e=>i(o({},e),{isInstalled:!0,isInstallable:!1,deferredPrompt:null}))},[]),s=d.useCallback(()=>{t(e=>i(o({},e),{isOnline:!0}))},[]),l=d.useCallback(()=>{t(e=>i(o({},e),{isOnline:!1}))},[]),u=d.useCallback(()=>c(null,null,function*(){if(e.deferredPrompt){t(e=>i(o({},e),{isInstalling:!0}));try{yield e.deferredPrompt.prompt();const{outcome:a}=yield e.deferredPrompt.userChoice;"accepted"===a&&t(e=>i(o({},e),{isInstalled:!0,isInstallable:!1,deferredPrompt:null}))}catch(a){alert("Install failed. Please try again or install manually from your browser menu.")}finally{t(e=>i(o({},e),{isInstalling:!1}))}}else{try{const t=new Event("beforeinstallprompt");return window.dispatchEvent(t),void setTimeout(()=>c(null,null,function*(){if(e.deferredPrompt)try{yield e.deferredPrompt.prompt(),yield e.deferredPrompt.userChoice}catch(a){alert("Install failed. Please try the manual installation methods.")}else alert("Please install manually:\n\nChrome: Look for ðŸ“± icon in address bar\nSafari: Share â†’ Add to Home Screen\nFirefox: â‹® menu â†’ Install App")}),100)}catch(a){}alert("Please install manually:\n\nChrome: Look for ðŸ“± icon in address bar\nSafari: Share â†’ Add to Home Screen\nFirefox: â‹® menu â†’ Install App")}}),[e.deferredPrompt]),p=d.useCallback(()=>c(null,null,function*(){if("serviceWorker"in navigator&&e.serviceWorkerRegistration)try{yield e.serviceWorkerRegistration.update()}catch(t){}}),[e.serviceWorkerRegistration]),f=d.useCallback(()=>c(null,null,function*(){if("caches"in window)try{const e=yield caches.keys();yield Promise.all(e.map(e=>caches.delete(e)))}catch(e){}}),[]),v=d.useCallback(()=>c(null,null,function*(){try{const{secureStorage:e}=yield m(()=>c(null,null,function*(){const{secureStorage:e}=yield import("./storage-utils-D16TCNXA.js").then(e=>e.l);return{secureStorage:e}}),[]);return yield e.exportData()}catch(e){throw e}}),[]),y=d.useCallback(e=>c(null,null,function*(){try{const{secureStorage:t}=yield m(()=>c(null,null,function*(){const{secureStorage:e}=yield import("./storage-utils-D16TCNXA.js").then(e=>e.l);return{secureStorage:e}}),[]);yield t.importData(e)}catch(t){throw t}}),[]),g=d.useCallback(()=>c(null,null,function*(){try{const{secureStorage:e}=yield m(()=>c(null,null,function*(){const{secureStorage:e}=yield import("./storage-utils-D16TCNXA.js").then(e=>e.l);return{secureStorage:e}}),[]),a=yield e.getStorageStats();t(e=>i(o({},e),{storageStats:a}))}catch(e){}}),[]);return d.useEffect(()=>(a(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{t(t=>i(o({},t),{serviceWorkerRegistration:e})),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&confirm("A new version is available. Reload to update?")&&window.location.reload()})})}).catch(()=>{}),window.addEventListener("beforeinstallprompt",n),window.addEventListener("appinstalled",r),window.addEventListener("online",s),window.addEventListener("offline",l),g(),()=>{window.removeEventListener("beforeinstallprompt",n),window.removeEventListener("appinstalled",r),window.removeEventListener("online",s),window.removeEventListener("offline",l)}),[a,n,r,s,l,g]),d.useEffect(()=>{const e=e=>{e.data&&"SYNC_IDENTITY_DATA"===e.data.type||e.data&&e.data.type};return"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",e),()=>{"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",e)}},[]),[e,{install:u,checkForUpdates:p,clearCache:f,exportData:v,importData:y,getStorageStats:g}]},f=()=>{const[e,t]=d.useState(!1),[a,n]=d.useState([]),[r,s]=d.useState([]),[l,o]=d.useState([]),[i,u]=d.useState([]),[m,p]=d.useState(null),f=d.useCallback(()=>c(null,null,function*(){t(!1),p(null)}),[]),v=d.useCallback(()=>{t(!1)},[]),y=d.useCallback(e=>{const t={id:`alert-${Date.now()}`,type:e.data.type,severity:e.data.severity,message:e.data.message,timestamp:e.timestamp,details:e.data.details};n(e=>{const a=[t,...e.slice(0,49)];return e.length>50&&e.splice(50),a})},[]),g=d.useCallback(e=>{const t={sessionId:e.data.sessionId,deviceName:e.data.deviceName,status:e.data.status,timestamp:e.timestamp,ipAddress:e.data.ipAddress,location:e.data.location};s(e=>{const a=[t,...e.slice(0,19)];return e.length>20&&e.splice(20),a})},[]),h=d.useCallback(e=>{const t={toolId:e.data.toolId,toolName:e.data.toolName,action:e.data.action,timestamp:e.timestamp,dataPoints:e.data.dataPoints||[]};o(e=>{const a=[t,...e.slice(0,19)];return e.length>20&&e.splice(20),a})},[]),w=d.useCallback(e=>{const t={requestId:e.data.requestId,status:e.data.status,timestamp:e.timestamp,custodianName:e.data.custodianName};u(e=>{const a=[t,...e.slice(0,19)];return e.length>20&&e.splice(20),a})},[]);return d.useEffect(()=>(f(),()=>{v()}),[f,v,y,g,h,w]),d.useEffect(()=>{const e=[],t=setInterval(()=>{const e=new Date(Date.now()-864e5);n(t=>t.filter(t=>new Date(t.timestamp)>e)),s(t=>t.filter(t=>new Date(t.timestamp)>e)),o(t=>t.filter(t=>new Date(t.timestamp)>e)),u(t=>t.filter(t=>new Date(t.timestamp)>e))},36e5);return e.push(t),()=>{e.forEach(e=>clearInterval(e))}},[]),{isConnected:e,connectionError:m,securityAlerts:a,sessionUpdates:r,toolAccessUpdates:l,recoveryStatusUpdates:i,connect:f,disconnect:v,clearAlerts:()=>n([]),clearSessionUpdates:()=>s([]),clearToolAccessUpdates:()=>o([]),clearRecoveryStatusUpdates:()=>u([])}};export{m as _,p as a,f as u};
